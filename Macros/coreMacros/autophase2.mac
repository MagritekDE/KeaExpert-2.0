procedure(autophase2,v,left,right)

   vsub = submatrix(v,left,right)

   s = matrix(360)
   for(p = 0 to 359)
      vph = vsub*exp(-i*p/180*pi)
      s[p] = sum(real(vph))   
   next(p)
   
   (val,xm) = max(s)

endproc(xm)