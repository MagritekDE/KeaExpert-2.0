
pr "\n ************ constant op cmatrix tests **************\n"
a = {1, 2, 3 ; 4, 5, 6 ; 7, 8, 10}
b = {1, 1, 1}'
c = 0
d = {1+1i,2+2i,3+3i}

mem = memory()
for(n = 0 to 1000)
   c = c + (2*a != [2*1, 2*2, 2*3 ; 2*4, 2*5, 2*6 ; 2*7, 2*8, 2*10]+i0)
   c = c + (a*2 != [2*1, 2*2, 2*3 ; 2*4, 2*5, 2*6 ; 2*7, 2*8, 2*10]+i0)
   c = c + (a/4 != [1/4, 2/4, 3/4 ; 4/4, 5/4, 6/4 ; 7/4, 8/4, 10/4]+i0)
   c = c + (a+1 != [1+1, 2+1, 3+1 ; 4+1, 5+1, 6+1 ; 7+1, 8+1, 10+1]+i0)
   c = c + (a-5 != [1-5, 2-5, 3-5 ; 4-5, 5-5, 6-5 ; 7-5, 8-5, 10-5]+i0)
   c = c + (a^2 != [1^2, 2^2, 3^2 ; 4^2, 5^2, 6^2 ; 7^2, 8^2, 10^2]+i0)
next(n)
pr "\nAll tests passed - Memory used = $memory()-mem$\n"
pr time()

pr "\n ************ cmatrix op cmatrix tests **************\n"
a = {1, 2, 3 ; 4, 5, 6 ; 7, 8, 10}
b = {1, 1, 1}'
c = 0
d = {1+1i,2+2i,3+3i}

mem = memory()
for(n = 0 to 1000)
   c = c + (a.*a != [1*1, 2*2, 3*3 ; 4*4, 5*5, 6*6 ; 7*7, 8*8, 10*10]+i0)
   c = c + (a*a != [30,36,45;66,81,102;109,134,169]+i0)
   c = c + (1/a != [1/1, 1/2, 1/3 ; 1/4, 1/5, 1/6 ; 1/7, 1/8, 1/10]+i0)
   c = c + (a*b != [6,15,25]'+i0)
   c = c + (b'*a != [12,15,19]+i0)
   c = c + (b*b' != [1,1,1;1,1,1;1,1,1]+i0)
   c = c + (b'*b != 3+i0)
   c = c + (trac(a) != 1+5+10)
   c = c + (diag(d) != {1+1i,0,0;0,2+2i,0;0,0,3+3i})
next(n)
pr "\nAll tests passed - Memory used = $memory()-mem$\n"
pr time()

pr "\n ************ cmatrix op vector tests **************\n"


a = matrix(4,4)+1
b = [1,2,3,4]
   
d = matrix(4,4)+0.5
e = [1,2,3,4]

mem = memory()
c = 0
for(n = 1 to nloops)

   c = c + (a+b != [2,3,4,5;2,3,4,5;2,3,4,5;2,3,4,5])
   c = c + (a+b' != [2,2,2,2;3,3,3,3;4,4,4,4;5,5,5,5])
   c = c + (a-b != [0,-1,-2,-3;0,-1,-2,-3;0,-1,-2,-3;0,-1,-2,-3])
   c = c + (a-b' != [0,0,0,0;-1,-1,-1,-1;-2,-2,-2,-2;-3,-3,-3,-3])
   c = c + (a.*b != [1,2,3,4;1,2,3,4;1,2,3,4;1,2,3,4])
   c = c + (a.*b' != [1,1,1,1;2,2,2,2;3,3,3,3;4,4,4,4])
   c = c + (a/b != [1,1/2,1/3,1/4;1,1/2,1/3,1/4;1,1/2,1/3,1/4;1,1/2,1/3,1/4])
   c = c + (a/b' != [1,1,1,1;1/2,1/2,1/2,1/2;1/3,1/3,1/3,1/3;1/4,1/4,1/4,1/4])
  
   c = c + (d^e != [1/2,1/4,1/8,1/16;1/2,1/4,1/8,1/16;1/2,1/4,1/8,1/16;1/2,1/4,1/8,1/16])
   c = c + (d^e' != [1/2,1/2,1/2,1/2;1/4,1/4,1/4,1/4;1/8,1/8,1/8,1/8;1/16,1/16,1/16,1/16])

   if(c > 0)
      break
   endif

next(n)
pr "\nAll tests passed - Memory used = $memory()-mem$\n"
pr time()
