<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 11 (filtered)">
<title> Using the Text Editor to write macros ®</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
@page Section1
	{size:21.0cm 842.0pt;
	margin:72.0pt 89.85pt 72.0pt 89.85pt;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=EN-GB link=blue vlink=purple>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ><a
href="Control%20Statements.htm"><span style='font-family:Wingdings;text-decoration:
none'>ß</span>Control Statements</a> | <a
href="Other%20Text%20Editor%20Menus.htm">Other Text Editor menus<span
style='font-family:Wingdings;text-decoration:none'>à</span></a></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='background:#FF6600'><b><span lang=EN-NZ
style='font-size:20.0pt'>Accessing Macros from Prospa</span></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>It is often not
convenient to have to modify parameters in a macro if it is to be used
frequently. There are two other possibilities. The first relies on predefined
dialog boxes that prompt the user for certain information. Two are provided</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>txt = </span><span style='font-size:
10.0pt;font-family:"Courier New";color:teal'>gettext</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Enter
text&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>name = </span><span style='font-size:
10.0pt;font-family:"Courier New";color:green'>getfilename</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Load&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Select
file&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;text files&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>,</span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;txt&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>The first is a macro, while the second is a
built-in command.</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>In these dialogs the first argument is a
prompt to the user. In the </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>getfilename</span><span lang=EN-NZ> dialog the third
and fourth arguments define the type of file to be displayed. </span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>To define more complex user interfaces view
the help file: GUI help.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name="user_defined_menus"></a><span style='font-size:
14.0pt'>User defined menus</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>To allow rapid
access to certain macros you can define folders that have contents which will
be accessible from menus in the main Prospa window. Define these folders by
opening the Preferences dialog in the main File menu. </span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=464 height=244 src="Accessing%20Macros%20from%20Prospa_files/image002.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>In the Menus tab are a list of menu names
and the corresponding folders which provide the source of macro names for each
of the menus.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>To add a new
menu name press the Add name button. A new entry will appear which can then be
modified as required:</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=284 valign=top style='width:213.05pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img border=0
  width=112 height=120
  src="Accessing%20Macros%20from%20Prospa_files/image004.jpg"></p>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>After
  pressing Add name button</span></p>
  </td>
  <td width=284 valign=top style='width:213.05pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img border=0
  width=112 height=120
  src="Accessing%20Macros%20from%20Prospa_files/image006.jpg"></p>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>After
  modifying the menu name</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>Next press the Add folder button. The
following dialog will appear (with different folders of course):</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=453 height=287 src="Accessing%20Macros%20from%20Prospa_files/image008.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>From this window
move into the directory you would like to add and then press the Set Directory
button. The selected folder will then appear in the Preferences folder as a
path relative to the Prospa application (</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>appdir</span><span lang=EN-NZ> is a
hidden global variable).</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=464 height=244 src="Accessing%20Macros%20from%20Prospa_files/image010.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Once you have
added all menus you can reorder them by selecting a name with the mouse and
then pressing the Up or Dn (down) buttons. Note that the two sides (name &amp;
folders) move independently.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>When you are
satisfied with the menu names and contents press the Save button to update the
main menu and save your preferences.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>All files in the
menu folders with extension .mac will then be displayed in the pull-down menus.
Selecting these will run the macros. Selecting them while holding down the
shift key will cause their contents to be displayed in the text editor.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name="macro_serach_path"></a><span style='font-size:14.0pt'>Macro
search path</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>When you run a
macro from the command line interface, or from within a macro there is a well
defined search procedure which the program uses to find the macro. This search
procedure is determined by the information stored in the Macros tab of the
preferences folder:</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=464 height=244 src="Accessing%20Macros%20from%20Prospa_files/image012.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Each line in the
above editor specifies a directory to search. The directories are searched in
the order they are listed. However before this is done, the folder the calling
macro is in is searched, any subfolders below this are searched and then the
current working directory is searched. </span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>If you have your
own macros you should <i>not</i> store them in the application folder (as
specified in the above window), since they could be overwritten by a subsequent
Prospa release. Rather you should define your own macro folder and add this to the
search path list. e.g.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=464 height=244 src="Accessing%20Macros%20from%20Prospa_files/image014.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>This path has
been added by pressing the Add ... button and then selecting the desired folder
with the absolute path entered. (Remember to enter the folder before pressing
the Set directory button).</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=426 height=297 src="Accessing%20Macros%20from%20Prospa_files/image016.jpg"></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>The final step is to press the Save button
so that next time you run Prospa it will remember the new path.</span></p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
