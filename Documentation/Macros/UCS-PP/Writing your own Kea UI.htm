<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:56.8pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Calibri","sans-serif";}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-NZ>

<div class=WordSection1>

<h1 style='page-break-after:auto;background:#FF6600'><a name="_Toc317500301"><span
style='font-size:20.0pt;font-family:"Times New Roman","serif";color:windowtext'>Writing
your own Kea user interface</span></a></h1>

<h1><span lang=EN-GB>&nbsp;</span></h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The interface supplied with the
Kea provides an environment which hides most of the details of developing the
graphical user interface macro from the pulse program designer. New pulse
programs and their associated user interface can be designed quickly and
reliably. Only the execution and processing procedure (execpp) will require
some significant programming effort.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>However in some circumstances
pulse program designers may wish to design their own user interface. For
example you may want to hide the majority of the pulse program parameters from
the end-user or replace the multiwindowed and general Prospa interface with
something more specific to your application. (Something Magritek has done for
its Rock Core Analyser product).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>There are two approaches to achieving
this goal. The first is to use the backdoor procedure which is part of each
standard pulse program macro. If supplied with a parameter list this will run
the pulse program without displaying the normal user interface. This is the
method used in the <i>BatchProcess</i> macro (see section 15) and the Rock Core
Analyser software. The advantage with this approach is that the core pulse
program can be modified and recompiled without major impacts on the macro
calling the backdoor procedure. Also there is very little work required to add
the pulse program code to your user interface. A very simple example is listed
below. This runs the 1Pulse macro from a very simple user interface which just
allow you to set the number of scans and data points.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=189
height=160 id="Picture 1"
src="Writing%20your%20own%20Kea%20UI_files/image001.png"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'>######################################</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Generate the
1Pulse example GUI</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:#AA0000'>######################################</span></p>

<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>procedure</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(1PulseExample)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   n = </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:teal'>:windowdefinition</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:6.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'> </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:teal'>:loadParameters</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>showwindow</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(n)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>endproc</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Define the
window interface</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>procedure</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(windowdefinition)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   n = </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>window</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;1Pulse
example&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>, -1, -1, 189, 134, </span><span lang=EN-US style='font-size:8.0pt;
font-family:"Courier New";color:gray'>&quot;resizable&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>      </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'>#
Define all controls with basic parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>button</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(1,
25, 91, 54, 29, </span><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:gray'>&quot;Run&quot;</span><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>,</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:teal'>:runExp</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>())</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>statictext</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(2,
47, 51, </span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;center&quot;</span><span lang=EN-US style='font-size:8.0pt;
font-family:"Courier New";color:black'>, </span><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Number
of&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>statictext</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(3,
47, 64, </span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;center&quot;</span><span lang=EN-US style='font-size:8.0pt;
font-family:"Courier New";color:black'>, </span><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;scans&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>textbox</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(4,
94, 52, 62)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>button</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(5,
101, 91, 54, 29, </span><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:gray'>&quot;Close&quot;</span><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>         </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:teal'>:saveParameters</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>();</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:green'>          closewindow</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(0))</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>statictext</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(6,
48, 20, </span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;center&quot;</span><span lang=EN-US style='font-size:8.0pt;
font-family:"Courier New";color:black'>, </span><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Number
of&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>statictext</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(7,
48, 33, </span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;center&quot;</span><span lang=EN-US style='font-size:8.0pt;
font-family:"Courier New";color:black'>, </span><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;complex
points&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>textbox</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(8,
95, 21, 62)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>     </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'>#
Set other control parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>setpar</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(n,4,</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;valueID&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>,</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;nrScans&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>       </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>setpar</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(n,8,</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;valueID&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>,</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;nrPnts&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>endproc</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(n)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Called when the run button is pressed</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>procedure</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(runExp)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Cache macros</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:teal'>keaCtrl:initCache</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>getmacropath</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(),</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>getmacroname</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>())</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Define
parameters for experiment</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   guipar = [</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;90Amplitude
= -12&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>             </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;accumulate
= \&quot;yes\&quot;&quot;</span><span lang=EN-US style='font-size:8.0pt;
font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>             </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>.... </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'>#
Many parameters removed for clarity</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>             </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;usePhaseCycle
= \&quot;yes\&quot;&quot;</span><span lang=EN-US style='font-size:8.0pt;
font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Update list
from GUI</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   lst = </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>getctrlvalues</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(0)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   guipar = </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>mergelists</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(lst,guipar)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Run the macro
via the backdoor</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:teal'>1Pulse:backdoor</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(guipar)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:blue'>endproc</span><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:black'>()</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>In this case the guipar list has
been generated using the <i>MakeBackDoor</i> macro found in the Kea-Utilities
macro folder and the user interface using the <i>Designer</i> macro found in
the GUI macro folder. This whole process took no more than 15 minutes. The only
addition required to make this a practical macro would be load and save
parameter procedures:</p>

<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Read the GUI
parameters from the preferences folder</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>procedure</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(loadParameters)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>cd</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(prefdir)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>mkdir</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Other
Macros&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>cd</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Other
Macros&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:blue'>if</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>isfile</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;1PulseExample.par&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>))</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>     lst = </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>load</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;1PulseExample.par&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>     </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>setctrlvalues</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(0,lst)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:blue'>endif</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:blue'>endproc</span><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:black'>()</span></p>

<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Save the GUI
parameters to the preferences folder</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>procedure</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(saveParameters)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>cd</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(prefdir)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>mkdir</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Other
Macros&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>cd</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Other
Macros&quot;</span><span lang=EN-US style='font-size:8.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   lst = </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>getctrlvalues</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(0)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>   </span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:green'>save</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;1PulseExample.par&quot;</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>,lst)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:blue'>endproc</span><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:8.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>loadParameters can be called after the call to windowdefinition
while saveParameters can be called before the call to closewindow.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The second approach is the more
difficult one and that is to replace the standard or backdoor interfaces with
your own and call the pulse program file directly. This is beyond the scope of
this manual.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-left:92.15pt;text-indent:-92.15pt'><span
lang=EN-GB>&nbsp;&nbsp;</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0cm 0cm 0cm'>

<p class=MsoNormal style='border:none;padding:0cm'>&nbsp;</p>

</div>

<p class=MsoNormal style='text-align:justify'><i>&nbsp;Correct for Prospa
version 3.12,  1-August-2012</i></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
