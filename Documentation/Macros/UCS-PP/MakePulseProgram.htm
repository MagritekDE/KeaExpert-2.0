<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<title>acquire</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	background:#FF6600;
	font-size:20.0pt;
	font-family:"Times New Roman","serif";}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
p.msolistparagraphcxspfirst, li.msolistparagraphcxspfirst, div.msolistparagraphcxspfirst
	{mso-style-name:msolistparagraphcxspfirst;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.msolistparagraphcxspmiddle, li.msolistparagraphcxspmiddle, div.msolistparagraphcxspmiddle
	{mso-style-name:msolistparagraphcxspmiddle;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.msolistparagraphcxsplast, li.msolistparagraphcxsplast, div.msolistparagraphcxsplast
	{mso-style-name:msolistparagraphcxsplast;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.msochpdefault, li.msochpdefault, div.msochpdefault
	{mso-style-name:msochpdefault;
	margin-right:0cm;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
.MsoChpDefault
	{font-size:10.0pt;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-NZ link=blue vlink=purple>

<div class=WordSection1>

<h1>MakePulseProgram</h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This macro allows the semi-automatic
generation of pulse programs and user interface macros for the Kea system. The
user need only write a short script to define the pulse sequence itself and
also specify the layout of the pulse-sequence control group in the GUI macro.
Several predefined tabs can then be selected for inclusion into the final macro
interface.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The macro can be invoked by
selecting it from the Kea-PP menu or by double clicking on a pulse program GUI
interface while both the control and shift keys are pressed.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal><b>&nbsp;</b></p>

<p class=MsoNormal align=center style='text-align:center'><img width=549
height=236 src="MakePulseProgram_files/image001.png"
alt="Description: C:\Program Files (x86)\Prospa Releases\Prospa 3.1 Release\Documentation\Macros\Kea-PP\MakePulseProgram_files\image001.png"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><i><span
style='font-size:10.0pt'>The Kea compiler interface</span></i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The steps involved in generating a new pulse sequence are
given below:</p>

<p class=MsoNormal>&nbsp;</p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal>Enter the output directory where your GUI macro will be
     stored (this will probably be a directory accessible from the main Prospa
     menu). You can use the button inside the red square to search for the
     directory.</li>
</ol>

<p class=MsoNormal style='text-indent:3.0pt'><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=2 type=1>
 <li class=MsoNormal>Enter the preferred name for the pulse program macro (this
     will appear in the menu and will be used for naming all other files used
     by the compiler). It should not include spaces. You can choose an existing
     pulse program by using the button in the green square. This name can be
     chosen from a directory other than the Output directory.</li>
</ol>

<p class=MsoNormal style='text-indent:3.0pt'><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=3 type=1>
 <li class=MsoNormal>Enter a suitable title. This will appear in the resultant
     GUI macro window. This may have spaces.</li>
</ol>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=4 type=1>
 <li class=MsoNormal>Select the type of RF amplifier the pulse program will
     use. The first option in the box “PP Files to generate”, will generate pulse
     programs for both internal or external amplifiers or, by selected the
     second option, a special configuration can be generated (e.g. with an
     internal and external RF amplifier being used in the same pulse program).</li>
</ol>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=5 type=1>
 <li class=MsoNormal>Checking the Wobble option will leave the directional
     coupler state in the duplexer unchanged at the end of the pulse sequence –
     normally this option would only be used when compiling the Wobble macro.</li>
</ol>

<p class=MsoNormal style='text-indent:3.0pt'><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=6 type=1>
 <li class=MsoNormal>Write a new pulse program macro. This is done by copying
     and modifying an existing macro. Pressing the “Edit pulse program” button
     opens this macro (in the above case called T1-IR-Add_pp.mac), or if none
     exists it uses one of the existing pulse sequences as a template (this may
     be in another directory).</li>
</ol>

<p class=MsoNormal style='text-indent:3.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><img
width=306 height=147 src="MakePulseProgram_files/image002.png"
alt="Description: C:\Program Files (x86)\Prospa Releases\Prospa 3.1 Release\Documentation\Macros\Kea-PP\MakePulseProgram_files\image002.png"></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:3.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=7 type=1>
 <li class=MsoNormal>Press the OK button and then select one of the existing
     macros (e.g. SpinEcho.mac). This will cause a copy to be made of this
     (GUI) macro and its associated pulse sequence macro and parameter set but
     with the new macro name replacing the old one. (Note that it is difficult
     to do this manually as the pulse program name is embedded within several
     of the files to be copied).</li>
</ol>

<p class=MsoNormal style='text-indent:3.0pt'><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=8 type=1>
 <li class=MsoNormal>When you have completed modifying the pulse program macro
     press the “Generate pulse-program” button&nbsp; to compile the pulse
     program statements (producing T1-IR-Add_int.p&nbsp; and T1-IR-Add_ext.p in
     the above case) and build the basic GUI interface (this will be called
     T1-IR-Add.mac in this example). Note that before modifying a GUI macro the
     compiler always makes a backup copy – the same name and location but with
     a .bak extension. So if anything goes wrong you can always restore your
     original version (as long as you compile only once!). </li>
</ol>

<p class=MsoNormal>&nbsp;</p>

<ol style='margin-top:0cm' start=9 type=1>
 <li class=MsoNormal>Press “Edit final macro” button to view the GUI macro and
     make any necessary modifications.</li>
</ol>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=10 type=1>
 <li class=MsoNormal>Press “View assembler file” in case you have problems and
     need to see the DSP code directly.</li>
</ol>

<p class=MsoListParagraph><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc317500281"></a><a name="_Toc315512107"></a><a
name="_Toc315518706"></a><b><span style='font-size:13.0pt;font-family:"Cambria","serif";
color:#4F81BD'>Errors</span></b></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:3.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal>In the unlikely event that an error occurs during the
compilation step you can view the log file (temp.lst) which is presented
automatically. If an error does occur please contact Magritek as it indicates a
bug in the compiler code.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Other errors (e.g. invalid commands in the pulse program or
missing commas in pulse program lists), will give rise to pop-up error messages
or an error which is visible in the CLI. After such an error always check the
main Windows menu to close any partially complete pulse program windows.
Failure to do this may result in odd errors appearing when trying to run
existing pulse program macros.</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:42.55pt;text-indent:-42.55pt'><a name="_Toc317500280"></a><a
name="_Toc315512106"></a><a name="_Toc315518705"></a>Short cuts</h2>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>If you want to edit an existing pulse
program you can skip some of these steps:</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal><span lang=EN-GB>Use the directory selection control (…)
     inside the blue rectangle in the above figure to select the GUI macro of
     the pulse program you wish to select. This will automatically update the
     output directory and GUI title fields.</span></li>
</ol>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<ol style='margin-top:0cm' start=2 type=1>
 <li class=MsoNormal><span lang=EN-GB>If the GUI is already visible then the
     MakePulseProgram interface can be displayed with the relevant fields
     filled in, </span>if you double click on the GUI window while the keyboard
     control and shift keys are pressed.</li>
</ol>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:13.0pt;font-family:"Cambria","serif";
color:#4F81BD'>Changes made during the compile step</span></b></p>

<p class=MsoNormal><b><span lang=EN-GB style='font-size:13.0pt'>&nbsp;</span></b></p>

<p class=MsoNormal><span lang=EN-US>In the following <i>name</i> refers to the
name of the new pulse program</span></p>

<p class=MsoNormal><b><span lang=EN-GB style='font-size:13.0pt'>&nbsp;</span></b></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal><span lang=EN-US>The<i> name_int.p</i> and <i>name _exp.p</i>
     or <i>name.p</i> files are rewritten using the latest code found in
     the&nbsp; kea2PPRun DLL.</span></li>
 <li class=MsoNormal><span lang=EN-US>The <i>name.mac</i> file has the
     following procedures updated:</span></li>
</ol>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-9.0pt'><span
lang=EN-US style='font-family:Symbol'>·</span><span lang=EN-US
style='font-size:7.0pt'>&nbsp;&nbsp; </span><i><span lang=EN-US>name ...</span></i><span
lang=EN-US> this is the first procedure in name.mac</span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-9.0pt'><span
lang=EN-US style='font-family:Symbol'>·</span><span lang=EN-US
style='font-size:7.0pt'>&nbsp;&nbsp; </span><i><span lang=EN-US>getseqpar ...</span></i><span
lang=EN-US> this stores the relationships list as copied from the name_pp
macro.</span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-9.0pt'><span
lang=EN-US style='font-family:Symbol'>·</span><span lang=EN-US
style='font-size:7.0pt'>&nbsp;&nbsp; </span><i><span lang=EN-US>backdoor ...</span></i><span
lang=EN-US> the latest backdoor procedure is added.</span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-9.0pt'><span
lang=EN-US style='font-family:Symbol'>·</span><span lang=EN-US
style='font-size:7.0pt'>&nbsp;&nbsp; </span><i><span lang=EN-US>windowdefinition
...</span></i><span lang=EN-US> this defines the graphical user interface. This
is generated from the interface list in the name_pp macro.</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>All other procedures (e.g. execpp) are
untouched.</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><i><span lang=EN-US>Note: </span></i><span lang=EN-US>Because
the procedures mentioned above are modified automatically by the compile
process you should <i>not</i> modify these manually if you expect to recompile
at some future date.</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:92.15pt;text-indent:-92.15pt'><span
lang=EN-GB>&nbsp;&nbsp;&nbsp;</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0cm 0cm 0cm'>

<p class=MsoNormal style='border:none;padding:0cm'>&nbsp;</p>

</div>

<p class=MsoNormal style='text-align:justify'><i>&nbsp;Correct for Prospa
version 3.12,  1-August-2012</i></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

</div>

</body>

</html>
