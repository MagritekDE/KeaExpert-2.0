<html xmlns:ns0="http://schemas.microsoft.com/office/2004/12/omml">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<title>acquire</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	background:#FF6600;
	font-size:20.0pt;
	font-family:"Times New Roman","serif";}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
.MsoChpDefault
	{font-size:10.0pt;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=EN-NZ link=blue vlink=purple>

<div class=WordSection1>

<h1>Kea pulse-program file organisation</h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Each Kea pulse-program is a
collection of several files. For the purposes of this discussion assume the
pulse program is called <i>T1-IR-Add</i>. First there is the pulse-program
execution macro (also called the GUI macro in these help files). This includes
the user interface definition and the main pulse-program execution procedure
(execpp). This pulse-program would be called T1-IR-Add.mac. In the same
directory there will be a folder called T1-IR-Add. Inside this folder are
several files. Most important is the pulse-program definition macro – in this
case T1-IR-Add_pp.mac. This is used when generating the pulse-program binary
files and the user interface.  There is also a default parameter file in this
directory called T1-IR-AddDefault.par. This is used the first time the experiment
is run. When the pulse-program definition macro is compiled two assembly files
are produced; T1-IR-Add_int.asm and T1-IR-Add_ext.asm. These contain the source
code for the pulse-program for the internal and external RF amplifier cases. When
assembled these files produce T1-IR-Add_int.p and T1-IR-Add_ext.p. These are
binary files which are sent via Prospa to the spectrometer computer. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>To summarize:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>T1-IR-Add.mac ............ pulse program execution
macro</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>T1-IR-Add ................ folder</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
style='font-size:10.0pt;font-family:"Courier New"'>T1-IR-Add_pp.mac ......
pulse program definition macro</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
style='font-size:10.0pt;font-family:"Courier New"'>T1-IR-AddDefault.par .. pulse
program default parameter file</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>T1-IR-Add_int.asm
..... pulse program source code for internal amplifier</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>T1-IR-Add_ext.asm
..... pulse program source code for external amplifier</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>T1-IR-Add_int.p
....... pulse program binary code for internal amplifier</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>T1-IR-Add_ext.p .......
pulse program binary code for external amplifier</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>Of these files
the only ones you need to write are T1-IR-Add_pp.mac, T1-IR-AddDefault.par and
parts of T1-IR-Add.mac.</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The location of
these files within the Prospa install folder is shown below. Of course these
files could be in any folder within the Windows file system.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=557
height=389 id="Picture 2" src="File%20organisation_files/image001.png"
alt="Description: file structure"></p>

<p class=MsoNormal align=center style='text-align:center'><i><span
style='font-size:10.0pt'>The location of output files for the Kea compile macro</span></i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>When you start a pulse-program
experiment from a menu you are running the pulse-program execution macro (in
this case T1-IR-Add.mac). This in turn uses the default parameter files (once)
and one of the binary files; which one depends on the RF amplifier location
setting. Once an experiment has been run once the parameter file is then stored
in the user preference folder. </p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc317500284"></a><a name="_Toc315518709"></a><a
name="_Toc315512110"><span lang=EN-US>Where to store Kea macros</span></a></h2>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The supplied
macros are stored in the &lt;appdir&gt;\Macros folder. (Type  <i>pr appdir </i>in
the Prospa CLI to show the appdir path). However if you don’t have
Administrator privileges you won’t be able to create new directories in this
folder. In this case make a folder in your own file space e.g. </span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>C:\Users\UserName\Prospa\MyMacros</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>Add this path to
the Menus list in the Prospa preferences dialog (see Prospa manual). All your
own pulse program macros can then be stored in this location.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc317500285"></a><a name="_Toc315518710"></a><a
name="_Toc315512111"><span lang=EN-US>Parameter file location</span></a></h2>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The default
parameter file is only used the first time the experiment is run. New parameter
files for each macro are stored in the user preferences folder:</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&lt;prefdir&gt;\Kea
Parameters\Experiment\&lt;experiment_folder&gt;\&lt;experiment_name&gt;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-GB>prefdir is a
Prospa global variable and for a Windows 7 system is:</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US
style='font-size:10.0pt;font-family:"Courier New";color:black'>C:\Users\UserName\Application
Data\Prospa\Preferences V3.2</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>Or within
Windows (this is an alias to the above path):</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US
style='font-size:10.0pt;font-family:"Courier New";color:black'>C:\Users\UserName\AppData\Roaming\Prospa\Preferences
V3.2</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-GB>(This will be a
hidden folder).</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;So, for example, if the experiment
1Pulse in the folder Kea-NMR is run then the path will be:</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&lt;prefdir&gt;\Kea
Parameters\Experiment\Kea-NMR\1Pulse</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>The file storing the parameters is called
(in this case)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>1PulseLastExp.par</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>and lists all
the GUI parameters for this experiment. A copy of this file (called <i>acqu.par</i>)
is also stored in the experiment output folder so there should be little need
to view these files directly.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:92.15pt;text-indent:-92.15pt'><span
lang=EN-GB>&nbsp;&nbsp;&nbsp;</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0cm 0cm 0cm'>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>&nbsp;</span></p>

</div>

<p class=MsoNormal style='text-align:justify'><i><span lang=EN-US>&nbsp;Correct
for Prospa version 3.2,  16-October-2013</span></i></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

</div>

</body>

</html>
