<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Aptos;}
@font-face
	{font-family:"Aptos Display";}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Liberation Sans";}
@font-face
	{font-family:"Microsoft YaHei";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:Marlett;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;}
@font-face
	{font-family:"Bahnschrift Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiLight";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Bahnschrift;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiBold";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift Light SemiCondensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiLight SemiConde";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiCondensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiBold SemiConden";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift Light Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiLight Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiBold Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Candara;
	panose-1:2 14 5 2 3 3 3 2 2 4;}
@font-face
	{font-family:"Candara Light";
	panose-1:2 14 5 2 3 3 3 2 2 4;}
@font-face
	{font-family:"Comic Sans MS";
	panose-1:3 15 7 2 3 3 2 2 2 4;}
@font-face
	{font-family:Constantia;
	panose-1:2 3 6 2 5 3 6 3 3 3;}
@font-face
	{font-family:Corbel;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"Corbel Light";
	panose-1:2 11 3 3 2 2 4 2 2 4;}
@font-face
	{font-family:Ebrima;
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Franklin Gothic Medium";
	panose-1:2 11 6 3 2 1 2 2 2 4;}
@font-face
	{font-family:Gabriola;
	panose-1:4 4 6 5 5 16 2 2 13 2;}
@font-face
	{font-family:Gadugi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;}
@font-face
	{font-family:"Ink Free";
	panose-1:3 8 4 2 0 5 0 0 0 0;}
@font-face
	{font-family:"Javanese Text";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Leelawadee UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Leelawadee UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Lucida Sans Unicode";
	panose-1:2 11 6 2 3 5 4 2 2 4;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"\@Malgun Gothic";}
@font-face
	{font-family:"Malgun Gothic Semilight";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Malgun Gothic Semilight";}
@font-face
	{font-family:"Microsoft Himalaya";
	panose-1:1 1 1 0 1 1 1 1 1 1;}
@font-face
	{font-family:"Microsoft JhengHei";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei";}
@font-face
	{font-family:"Microsoft JhengHei UI";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei UI";}
@font-face
	{font-family:"Microsoft JhengHei Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei Light";}
@font-face
	{font-family:"Microsoft JhengHei UI Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei UI Light";}
@font-face
	{font-family:"Microsoft New Tai Lue";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft PhagsPa";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft Sans Serif";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Microsoft Tai Le";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Microsoft YaHei";}
@font-face
	{font-family:"Microsoft YaHei UI";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@Microsoft YaHei UI";}
@font-face
	{font-family:"Microsoft YaHei Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Microsoft YaHei Light";}
@font-face
	{font-family:"Microsoft YaHei UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Microsoft YaHei UI Light";}
@font-face
	{font-family:"Microsoft Yi Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:MingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU-ExtB";}
@font-face
	{font-family:PMingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@PMingLiU-ExtB";}
@font-face
	{font-family:MingLiU_HKSCS-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU_HKSCS-ExtB";}
@font-face
	{font-family:MingLiU_MSCS-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU_MSCS-ExtB";}
@font-face
	{font-family:"Mongolian Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"MS UI Gothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"\@MS UI Gothic";}
@font-face
	{font-family:"MS PGothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"\@MS PGothic";}
@font-face
	{font-family:"MV Boli";
	panose-1:2 0 5 0 3 2 0 9 0 0;}
@font-face
	{font-family:"Myanmar Text";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala Text";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala Text Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Sans Serif Collection";
	panose-1:2 11 5 2 4 5 4 2 2 4;}
@font-face
	{font-family:"Segoe Fluent Icons";
	panose-1:5 10 1 2 1 1 1 1 1 1;}
@font-face
	{font-family:"Segoe MDL2 Assets";
	panose-1:5 10 1 2 1 1 1 1 1 1;}
@font-face
	{font-family:"Segoe Print";
	panose-1:2 0 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe Script";
	panose-1:3 11 5 4 2 0 0 0 0 3;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Black";
	panose-1:2 11 10 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Historic";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Semibold";
	panose-1:2 11 7 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Symbol";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Variable Small Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Small Semilig";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Small";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Small Semibol";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text Semiligh";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display Semil";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display Semib";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:NSimSun;
	panose-1:2 1 6 9 3 1 1 1 1 1;}
@font-face
	{font-family:"\@NSimSun";}
@font-face
	{font-family:SimSun-ExtB;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun-ExtB";}
@font-face
	{font-family:"Sitka Small";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Small Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Text";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Text Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Subheading";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Subheading Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Heading";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Heading Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Display";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Display Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Banner";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Banner Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;}
@font-face
	{font-family:"\@Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic UI";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI";}
@font-face
	{font-family:"Yu Gothic UI Semibold";
	panose-1:2 11 7 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Semibold";}
@font-face
	{font-family:"Yu Gothic Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic Light";}
@font-face
	{font-family:"Yu Gothic UI Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Light";}
@font-face
	{font-family:"Yu Gothic Medium";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic Medium";}
@font-face
	{font-family:"Yu Gothic UI Semilight";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Semilight";}
@font-face
	{font-family:SimSun-ExtG;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun-ExtG";}
@font-face
	{font-family:"Agency FB";
	panose-1:2 11 5 3 2 2 2 2 2 4;}
@font-face
	{font-family:Algerian;
	panose-1:4 2 7 5 4 10 2 6 7 2;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;}
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;}
@font-face
	{font-family:"Arial Rounded MT Bold";
	panose-1:2 15 7 4 3 5 4 3 2 4;}
@font-face
	{font-family:"Baskerville Old Face";
	panose-1:2 2 6 2 8 5 5 2 3 3;}
@font-face
	{font-family:"Bauhaus 93";
	panose-1:4 3 9 5 2 11 2 2 12 2;}
@font-face
	{font-family:"Bell MT";
	panose-1:2 2 5 3 6 3 5 2 3 3;}
@font-face
	{font-family:"Bernard MT Condensed";
	panose-1:2 5 8 6 6 9 5 2 4 4;}
@font-face
	{font-family:"Bodoni MT";
	panose-1:2 7 6 3 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT Black";
	panose-1:2 7 10 3 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT Condensed";
	panose-1:2 7 6 6 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT Poster Compressed";
	panose-1:2 7 7 6 8 6 1 5 2 4;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;}
@font-face
	{font-family:"Bradley Hand ITC";
	panose-1:3 7 4 2 5 3 2 3 2 3;}
@font-face
	{font-family:"Britannic Bold";
	panose-1:2 11 9 3 6 7 3 2 2 4;}
@font-face
	{font-family:"Berlin Sans FB";
	panose-1:2 14 6 2 2 5 2 2 3 6;}
@font-face
	{font-family:"Berlin Sans FB Demi";
	panose-1:2 14 8 2 2 5 2 2 3 6;}
@font-face
	{font-family:Broadway;
	panose-1:4 4 9 5 8 11 2 2 5 2;}
@font-face
	{font-family:"Brush Script MT";
	panose-1:3 6 8 2 4 4 6 7 3 4;}
@font-face
	{font-family:"Bookshelf Symbol 7";
	panose-1:5 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Californian FB";
	panose-1:2 7 4 3 6 8 11 3 2 4;}
@font-face
	{font-family:"Calisto MT";
	panose-1:2 4 6 3 5 5 5 3 3 4;}
@font-face
	{font-family:Castellar;
	panose-1:2 10 4 2 6 4 6 1 3 1;}
@font-face
	{font-family:"Century Schoolbook";
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:Centaur;
	panose-1:2 3 5 4 5 2 5 2 3 4;}
@font-face
	{font-family:Chiller;
	panose-1:4 2 4 4 3 16 7 2 6 2;}
@font-face
	{font-family:"Colonna MT";
	panose-1:4 2 8 5 6 2 2 3 2 3;}
@font-face
	{font-family:"Cooper Black";
	panose-1:2 8 9 4 4 3 11 2 4 4;}
@font-face
	{font-family:"Copperplate Gothic Bold";
	panose-1:2 14 7 5 2 2 6 2 4 4;}
@font-face
	{font-family:"Copperplate Gothic Light";
	panose-1:2 14 5 7 2 2 6 2 4 4;}
@font-face
	{font-family:"Curlz MT";
	panose-1:4 4 4 4 5 7 2 2 2 2;}
@font-face
	{font-family:Dubai;
	panose-1:2 11 5 3 3 4 3 3 2 4;}
@font-face
	{font-family:"Dubai Light";
	panose-1:2 11 3 3 3 4 3 3 2 4;}
@font-face
	{font-family:"Dubai Medium";
	panose-1:2 11 6 3 3 4 3 3 2 4;}
@font-face
	{font-family:Elephant;
	panose-1:2 2 9 4 9 5 5 2 3 3;}
@font-face
	{font-family:"Engravers MT";
	panose-1:2 9 7 7 8 5 5 2 3 4;}
@font-face
	{font-family:"Eras Bold ITC";
	panose-1:2 11 9 7 3 5 4 2 2 4;}
@font-face
	{font-family:"Eras Demi ITC";
	panose-1:2 11 8 5 3 5 4 2 8 4;}
@font-face
	{font-family:"Eras Light ITC";
	panose-1:2 11 4 2 3 5 4 2 8 4;}
@font-face
	{font-family:"Eras Medium ITC";
	panose-1:2 11 6 2 3 5 4 2 8 4;}
@font-face
	{font-family:"Felix Titling";
	panose-1:4 6 5 5 6 2 2 2 10 4;}
@font-face
	{font-family:Forte;
	panose-1:3 6 9 2 4 5 2 7 2 3;}
@font-face
	{font-family:"Franklin Gothic Book";
	panose-1:2 11 5 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi Cond";
	panose-1:2 11 7 6 3 4 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Heavy";
	panose-1:2 11 9 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Medium Cond";
	panose-1:2 11 6 6 3 4 2 2 2 4;}
@font-face
	{font-family:"Freestyle Script";
	panose-1:3 8 4 2 3 2 5 11 4 4;}
@font-face
	{font-family:"French Script MT";
	panose-1:3 2 4 2 4 6 7 4 6 5;}
@font-face
	{font-family:"Footlight MT Light";
	panose-1:2 4 6 2 6 3 10 2 3 4;}
@font-face
	{font-family:Garamond;
	panose-1:2 2 4 4 3 3 1 1 8 3;}
@font-face
	{font-family:Gigi;
	panose-1:4 4 5 4 6 16 7 2 13 2;}
@font-face
	{font-family:"Gill Sans MT";
	panose-1:2 11 5 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans MT Condensed";
	panose-1:2 11 5 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans Ultra Bold Condensed";
	panose-1:2 11 10 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans Ultra Bold";
	panose-1:2 11 10 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Gloucester MT Extra Condensed";
	panose-1:2 3 8 8 2 6 1 1 1 1;}
@font-face
	{font-family:"Gill Sans MT Ext Condensed Bold";
	panose-1:2 11 9 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Century Gothic";
	panose-1:2 11 5 2 2 2 2 2 2 4;}
@font-face
	{font-family:"Goudy Old Style";
	panose-1:2 2 5 2 5 3 5 2 3 3;}
@font-face
	{font-family:"Goudy Stout";
	panose-1:2 2 9 4 7 3 11 2 4 1;}
@font-face
	{font-family:"Harlow Solid Italic";
	panose-1:4 3 6 4 2 15 2 2 13 2;}
@font-face
	{font-family:Harrington;
	panose-1:4 4 5 5 5 10 2 2 7 2;}
@font-face
	{font-family:Haettenschweiler;
	panose-1:2 11 7 6 4 9 2 6 2 4;}
@font-face
	{font-family:"High Tower Text";
	panose-1:2 4 5 2 5 5 6 3 3 3;}
@font-face
	{font-family:"Imprint MT Shadow";
	panose-1:4 2 6 5 6 3 3 3 2 2;}
@font-face
	{font-family:"Informal Roman";
	panose-1:3 6 4 2 3 4 6 11 2 4;}
@font-face
	{font-family:"Blackadder ITC";
	panose-1:4 2 5 5 5 16 7 2 13 2;}
@font-face
	{font-family:"Edwardian Script ITC";
	panose-1:3 3 3 2 4 7 7 13 8 4;}
@font-face
	{font-family:"Kristen ITC";
	panose-1:3 5 5 2 4 2 2 3 2 2;}
@font-face
	{font-family:Jokerman;
	panose-1:4 9 6 5 6 13 6 2 7 2;}
@font-face
	{font-family:"Juice ITC";
	panose-1:4 4 4 3 4 10 2 2 2 2;}
@font-face
	{font-family:"Kunstler Script";
	panose-1:3 3 4 2 2 6 7 13 13 6;}
@font-face
	{font-family:"Wide Latin";
	panose-1:2 10 10 7 5 5 5 2 4 4;}
@font-face
	{font-family:"Lucida Bright";
	panose-1:2 4 6 2 5 5 5 2 3 4;}
@font-face
	{font-family:"Lucida Calligraphy";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Lucida Fax";
	panose-1:2 6 6 2 5 5 5 2 2 4;}
@font-face
	{font-family:"Lucida Handwriting";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Lucida Sans";
	panose-1:2 11 6 2 3 5 4 9 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:Magneto;
	panose-1:4 3 8 5 5 8 2 2 13 2;}
@font-face
	{font-family:"Maiandra GD";
	panose-1:2 14 5 2 3 3 8 2 2 4;}
@font-face
	{font-family:"Matura MT Script Capitals";
	panose-1:3 2 8 2 6 6 2 7 2 2;}
@font-face
	{font-family:Mistral;
	panose-1:3 9 7 2 3 4 7 2 4 3;}
@font-face
	{font-family:"Modern No\. 20";
	panose-1:2 7 7 4 7 5 5 2 3 3;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;}
@font-face
	{font-family:"MT Extra";
	panose-1:5 5 1 2 1 2 5 2 2 2;}
@font-face
	{font-family:"Niagara Engraved";
	panose-1:4 2 5 2 7 7 3 3 2 2;}
@font-face
	{font-family:"Niagara Solid";
	panose-1:4 2 5 2 7 7 2 2 2 2;}
@font-face
	{font-family:"OCR A Extended";
	panose-1:2 1 5 9 2 1 2 1 3 3;}
@font-face
	{font-family:"Old English Text MT";
	panose-1:3 4 9 2 4 5 8 3 8 6;}
@font-face
	{font-family:Onyx;
	panose-1:4 5 6 2 8 7 2 2 2 3;}
@font-face
	{font-family:"MS Outlook";
	panose-1:5 1 1 0 1 0 0 0 0 0;}
@font-face
	{font-family:"Palace Script MT";
	panose-1:3 3 3 2 2 6 7 12 11 5;}
@font-face
	{font-family:Papyrus;
	panose-1:3 7 5 2 6 5 2 3 2 5;}
@font-face
	{font-family:Parchment;
	panose-1:3 4 6 2 4 7 8 4 8 4;}
@font-face
	{font-family:Perpetua;
	panose-1:2 2 5 2 6 4 1 2 3 3;}
@font-face
	{font-family:"Perpetua Titling MT";
	panose-1:2 2 5 2 6 5 5 2 8 4;}
@font-face
	{font-family:Playbill;
	panose-1:4 5 6 3 10 6 2 2 2 2;}
@font-face
	{font-family:"Poor Richard";
	panose-1:2 8 5 2 5 5 5 2 7 2;}
@font-face
	{font-family:Pristina;
	panose-1:3 6 4 2 4 4 6 8 2 4;}
@font-face
	{font-family:"Rage Italic";
	panose-1:3 7 5 2 4 5 7 7 3 4;}
@font-face
	{font-family:Ravie;
	panose-1:4 4 8 5 5 8 9 2 6 2;}
@font-face
	{font-family:"MS Reference Sans Serif";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"MS Reference Specialty";
	panose-1:5 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Rockwell Condensed";
	panose-1:2 6 6 3 5 4 5 2 1 4;}
@font-face
	{font-family:Rockwell;
	panose-1:2 6 6 3 2 2 5 2 4 3;}
@font-face
	{font-family:"Rockwell Extra Bold";
	panose-1:2 6 9 3 4 5 5 2 4 3;}
@font-face
	{font-family:"Script MT Bold";
	panose-1:3 4 6 2 4 6 7 8 9 4;}
@font-face
	{font-family:"Showcard Gothic";
	panose-1:4 2 9 4 2 1 2 2 6 4;}
@font-face
	{font-family:"Snap ITC";
	panose-1:4 4 10 7 6 10 2 2 2 2;}
@font-face
	{font-family:Stencil;
	panose-1:4 4 9 5 13 8 2 2 4 4;}
@font-face
	{font-family:"Tw Cen MT";
	panose-1:2 11 6 2 2 1 4 2 6 3;}
@font-face
	{font-family:"Tw Cen MT Condensed";
	panose-1:2 11 6 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Tw Cen MT Condensed Extra Bold";
	panose-1:2 11 8 3 2 2 2 2 2 4;}
@font-face
	{font-family:"Tempus Sans ITC";
	panose-1:4 2 4 4 3 13 7 2 2 2;}
@font-face
	{font-family:"Viner Hand ITC";
	panose-1:3 7 5 2 3 5 2 2 2 3;}
@font-face
	{font-family:Vivaldi;
	panose-1:3 2 6 2 5 5 6 9 8 4;}
@font-face
	{font-family:"Vladimir Script";
	panose-1:3 5 4 2 4 4 7 7 3 5;}
@font-face
	{font-family:"Wingdings 2";
	panose-1:5 2 1 2 1 5 7 7 7 7;}
@font-face
	{font-family:"Wingdings 3";
	panose-1:5 4 1 2 1 8 7 7 7 7;}
@font-face
	{font-family:"Cascadia Code ExtraLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code Light";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code SemiLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code SemiBold";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono ExtraLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono Light";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono SemiLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono SemiBold";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:Abadi;}
@font-face
	{font-family:"Abadi Extra Light";}
@font-face
	{font-family:Abel;}
@font-face
	{font-family:"Abril Fatface";}
@font-face
	{font-family:"ADLaM Display";}
@font-face
	{font-family:Aharoni;}
@font-face
	{font-family:"Al Fresco";}
@font-face
	{font-family:"Alasassy Caps";}
@font-face
	{font-family:Aldhabi;}
@font-face
	{font-family:Alef;}
@font-face
	{font-family:Aleo;}
@font-face
	{font-family:"Aleo Light";}
@font-face
	{font-family:"Amasis MT Pro";}
@font-face
	{font-family:"Amasis MT Pro Black";}
@font-face
	{font-family:"Amasis MT Pro Light";}
@font-face
	{font-family:"Amasis MT Pro Medium";}
@font-face
	{font-family:"Amatic SC";}
@font-face
	{font-family:AngsanaUPC;}
@font-face
	{font-family:Anton;}
@font-face
	{font-family:Aparajita;}
@font-face
	{font-family:"Aptos Black";}
@font-face
	{font-family:"Aptos ExtraBold";}
@font-face
	{font-family:"Aptos Light";}
@font-face
	{font-family:"Aptos Mono";}
@font-face
	{font-family:"Aptos Narrow";}
@font-face
	{font-family:"Aptos SemiBold";}
@font-face
	{font-family:"Aptos Serif";}
@font-face
	{font-family:"Arabic Typesetting";}
@font-face
	{font-family:"Aref Ruqaa";}
@font-face
	{font-family:"Arial Nova";}
@font-face
	{font-family:"Arial Nova Cond";}
@font-face
	{font-family:"Arial Nova Cond Light";}
@font-face
	{font-family:"Arial Nova Light";}
@font-face
	{font-family:Assistant;}
@font-face
	{font-family:"Assistant ExtraBold";}
@font-face
	{font-family:"Assistant ExtraLight";}
@font-face
	{font-family:"Assistant Light";}
@font-face
	{font-family:"Assistant SemiBold";}
@font-face
	{font-family:Athiti;}
@font-face
	{font-family:"Athiti ExtraLight";}
@font-face
	{font-family:"Athiti Light";}
@font-face
	{font-family:"Athiti Medium";}
@font-face
	{font-family:"Athiti SemiBold";}
@font-face
	{font-family:"Avenir Next LT Pro";}
@font-face
	{font-family:"Avenir Next LT Pro Demi";}
@font-face
	{font-family:"Avenir Next LT Pro Light";}
@font-face
	{font-family:"Baguet Script";}
@font-face
	{font-family:Barlow;}
@font-face
	{font-family:"Barlow Black";}
@font-face
	{font-family:"Barlow Condensed";}
@font-face
	{font-family:"Barlow Condensed Black";}
@font-face
	{font-family:"Barlow Condensed ExtraBold";}
@font-face
	{font-family:"Barlow Condensed ExtraLight";}
@font-face
	{font-family:"Barlow Condensed Light";}
@font-face
	{font-family:"Barlow Condensed Medium";}
@font-face
	{font-family:"Barlow Condensed SemiBold";}
@font-face
	{font-family:"Barlow Condensed Thin";}
@font-face
	{font-family:"Barlow ExtraBold";}
@font-face
	{font-family:"Barlow ExtraLight";}
@font-face
	{font-family:"Barlow Light";}
@font-face
	{font-family:"Barlow Medium";}
@font-face
	{font-family:"Barlow Semi Condensed";}
@font-face
	{font-family:"Barlow Semi Condensed Black";}
@font-face
	{font-family:"Barlow Semi Condensed ExLight";}
@font-face
	{font-family:"Barlow Semi Condensed ExtraBold";}
@font-face
	{font-family:"Barlow Semi Condensed Light";}
@font-face
	{font-family:"Barlow Semi Condensed Medium";}
@font-face
	{font-family:"Barlow Semi Condensed SemiBold";}
@font-face
	{font-family:"Barlow Semi Condensed Thin";}
@font-face
	{font-family:"Barlow SemiBold";}
@font-face
	{font-family:"Barlow Thin";}
@font-face
	{font-family:BatangChe;}
@font-face
	{font-family:"Bebas Neue";}
@font-face
	{font-family:Bembo;}
@font-face
	{font-family:Bierstadt;}
@font-face
	{font-family:"Bierstadt Display";}
@font-face
	{font-family:Biome;}
@font-face
	{font-family:"Biome Light";}
@font-face
	{font-family:"Boucherie Block";}
@font-face
	{font-family:"Boucherie Sans";}
@font-face
	{font-family:"Browallia New";}
@font-face
	{font-family:BrowalliaUPC;}
@font-face
	{font-family:"Buxton Sketch";}
@font-face
	{font-family:"Caveat Brush";}
@font-face
	{font-family:Cavolini;}
@font-face
	{font-family:"Chamberi Super Display";}
@font-face
	{font-family:Charmonman;}
@font-face
	{font-family:"Chilgok Gwon Anja";}
@font-face
	{font-family:"Chilgok Kim Yeongbun";}
@font-face
	{font-family:"Chilgok Lee Jonghui";}
@font-face
	{font-family:"Chilgok Lee Wonsun";}
@font-face
	{font-family:Chonburi;}
@font-face
	{font-family:"Cochocib Script Latin Pro";}
@font-face
	{font-family:"Concert One";}
@font-face
	{font-family:Congenial;}
@font-face
	{font-family:"Congenial Black";}
@font-face
	{font-family:"Congenial Light";}
@font-face
	{font-family:"Congenial SemiBold";}
@font-face
	{font-family:"Congenial UltraLight";}
@font-face
	{font-family:Convection;}
@font-face
	{font-family:"Convection Condensed";}
@font-face
	{font-family:"Convection Extra Bold";}
@font-face
	{font-family:"Convection Symbol";}
@font-face
	{font-family:"Convection UI";}
@font-face
	{font-family:CordiaUPC;}
@font-face
	{font-family:Dante;}
@font-face
	{font-family:DaunPenh;}
@font-face
	{font-family:David;}
@font-face
	{font-family:Daytona;}
@font-face
	{font-family:"Daytona Condensed";}
@font-face
	{font-family:"Daytona Condensed Light";}
@font-face
	{font-family:"Daytona Light";}
@font-face
	{font-family:"DengXian Light";}
@font-face
	{font-family:"Didact Gothic";}
@font-face
	{font-family:DilleniaUPC;}
@font-face
	{font-family:"DM Mono";}
@font-face
	{font-family:"DM Mono Light";}
@font-face
	{font-family:"DM Mono Medium";}
@font-face
	{font-family:"DM Sans";}
@font-face
	{font-family:"DM Sans Medium";}
@font-face
	{font-family:"DM Serif Display";}
@font-face
	{font-family:"DM Serif Text";}
@font-face
	{font-family:DokChampa;}
@font-face
	{font-family:Dosis;}
@font-face
	{font-family:"Dosis ExtraBold";}
@font-face
	{font-family:"Dosis ExtraLight";}
@font-face
	{font-family:"Dosis Light";}
@font-face
	{font-family:"Dosis Medium";}
@font-face
	{font-family:"Dosis SemiBold";}
@font-face
	{font-family:DotumChe;}
@font-face
	{font-family:"Dreaming Outloud Pro";}
@font-face
	{font-family:"Dreaming Outloud Script Pro";}
@font-face
	{font-family:"EB Garamond";}
@font-face
	{font-family:"EB Garamond ExtraBold";}
@font-face
	{font-family:"EB Garamond Medium";}
@font-face
	{font-family:"EB Garamond SemiBold";}
@font-face
	{font-family:"Elephant Pro";}
@font-face
	{font-family:EucrosiaUPC;}
@font-face
	{font-family:Euphemia;}
@font-face
	{font-family:Fahkwang;}
@font-face
	{font-family:"Fahkwang ExtraLight";}
@font-face
	{font-family:"Fahkwang Light";}
@font-face
	{font-family:"Fahkwang Medium";}
@font-face
	{font-family:"Fahkwang SemiBold";}
@font-face
	{font-family:"Fairwater Script";}
@font-face
	{font-family:"Fairwater Script Light";}
@font-face
	{font-family:FangSong;}
@font-face
	{font-family:"Fave Script Bold Pro";}
@font-face
	{font-family:"Fira Code";}
@font-face
	{font-family:"Fira Code Light";}
@font-face
	{font-family:"Fira Code Medium";}
@font-face
	{font-family:"Fira Code Retina";}
@font-face
	{font-family:"Fira Mono";}
@font-face
	{font-family:"Fira Mono Medium";}
@font-face
	{font-family:"Fira Sans";}
@font-face
	{font-family:"Fira Sans Black";}
@font-face
	{font-family:"Fira Sans Condensed";}
@font-face
	{font-family:"Fira Sans Condensed Black";}
@font-face
	{font-family:"Fira Sans Condensed ExtraBold";}
@font-face
	{font-family:"Fira Sans Condensed ExtraLight";}
@font-face
	{font-family:"Fira Sans Condensed Light";}
@font-face
	{font-family:"Fira Sans Condensed Medium";}
@font-face
	{font-family:"Fira Sans Condensed SemiBold";}
@font-face
	{font-family:"Fira Sans Condensed Thin";}
@font-face
	{font-family:"Fira Sans Extra Condensed";}
@font-face
	{font-family:"Fira Sans Extra Condensed Black";}
@font-face
	{font-family:"Fira Sans Extra Condensed Light";}
@font-face
	{font-family:"Fira Sans Extra Condensed Thin";}
@font-face
	{font-family:"Fira Sans ExtraBold";}
@font-face
	{font-family:"Fira Sans ExtraLight";}
@font-face
	{font-family:"Fira Sans Light";}
@font-face
	{font-family:"Fira Sans Medium";}
@font-face
	{font-family:"Fira Sans SemiBold";}
@font-face
	{font-family:"Fira Sans Thin";}
@font-face
	{font-family:"Fjalla One";}
@font-face
	{font-family:"Forte Forward";}
@font-face
	{font-family:"Frank Ruhl Libre";}
@font-face
	{font-family:"Frank Ruhl Libre Black";}
@font-face
	{font-family:"Frank Ruhl Libre Light";}
@font-face
	{font-family:"Frank Ruhl Libre Medium";}
@font-face
	{font-family:FrankRuehl;}
@font-face
	{font-family:"Fredoka One";}
@font-face
	{font-family:FreesiaUPC;}
@font-face
	{font-family:Gabriela;}
@font-face
	{font-family:Gaegu;}
@font-face
	{font-family:"Gaegu Light";}
@font-face
	{font-family:"Georgia Pro";}
@font-face
	{font-family:"Georgia Pro Black";}
@font-face
	{font-family:"Georgia Pro Cond";}
@font-face
	{font-family:"Georgia Pro Cond Black";}
@font-face
	{font-family:"Georgia Pro Cond Light";}
@font-face
	{font-family:"Georgia Pro Cond Semibold";}
@font-face
	{font-family:"Georgia Pro Light";}
@font-face
	{font-family:"Georgia Pro Semibold";}
@font-face
	{font-family:"Gill Sans Nova";}
@font-face
	{font-family:"Gill Sans Nova Cond";}
@font-face
	{font-family:"Gill Sans Nova Cond Lt";}
@font-face
	{font-family:"Gill Sans Nova Cond Ultra Bold";}
@font-face
	{font-family:"Gill Sans Nova Cond XBd";}
@font-face
	{font-family:"Gill Sans Nova Light";}
@font-face
	{font-family:"Gill Sans Nova Ultra Bold";}
@font-face
	{font-family:Gisha;}
@font-face
	{font-family:"Goudy Type";}
@font-face
	{font-family:Grandview;}
@font-face
	{font-family:"Grandview Display";}
@font-face
	{font-family:Grotesque;}
@font-face
	{font-family:"Grotesque Light";}
@font-face
	{font-family:GulimChe;}
@font-face
	{font-family:Gungsuh;}
@font-face
	{font-family:GungsuhChe;}
@font-face
	{font-family:"Hadassah Friedlaender";}
@font-face
	{font-family:"Hammersmith One";}
@font-face
	{font-family:Heebo;}
@font-face
	{font-family:"Heebo Black";}
@font-face
	{font-family:"Heebo ExtraBold";}
@font-face
	{font-family:"Heebo Light";}
@font-face
	{font-family:"Heebo Medium";}
@font-face
	{font-family:"Heebo Thin";}
@font-face
	{font-family:HGGothicE;}
@font-face
	{font-family:HGMaruGothicMPRO;}
@font-face
	{font-family:HGMinchoE;}
@font-face
	{font-family:HGPGothicE;}
@font-face
	{font-family:HGPMinchoE;}
@font-face
	{font-family:HGPSoeiKakugothicUB;}
@font-face
	{font-family:HGSGothicE;}
@font-face
	{font-family:HGSMinchoE;}
@font-face
	{font-family:HGSoeiKakugothicUB;}
@font-face
	{font-family:HGSSoeiKakugothicUB;}
@font-face
	{font-family:Hind;}
@font-face
	{font-family:"Hind Colombo";}
@font-face
	{font-family:"Hind Colombo Light";}
@font-face
	{font-family:"Hind Colombo Medium";}
@font-face
	{font-family:"Hind Colombo SemiBold";}
@font-face
	{font-family:"Hind Guntur";}
@font-face
	{font-family:"Hind Guntur Light";}
@font-face
	{font-family:"Hind Guntur Medium";}
@font-face
	{font-family:"Hind Guntur SemiBold";}
@font-face
	{font-family:"Hind Jalandhar";}
@font-face
	{font-family:"Hind Jalandhar Light";}
@font-face
	{font-family:"Hind Jalandhar Medium";}
@font-face
	{font-family:"Hind Jalandhar SemiBold";}
@font-face
	{font-family:"Hind Kochi";}
@font-face
	{font-family:"Hind Kochi Light";}
@font-face
	{font-family:"Hind Kochi Medium";}
@font-face
	{font-family:"Hind Kochi SemiBold";}
@font-face
	{font-family:"Hind Light";}
@font-face
	{font-family:"Hind Madurai";}
@font-face
	{font-family:"Hind Madurai Light";}
@font-face
	{font-family:"Hind Madurai Medium";}
@font-face
	{font-family:"Hind Madurai SemiBold";}
@font-face
	{font-family:"Hind Medium";}
@font-face
	{font-family:"Hind Mysuru";}
@font-face
	{font-family:"Hind Mysuru Light";}
@font-face
	{font-family:"Hind Mysuru Medium";}
@font-face
	{font-family:"Hind Mysuru SemiBold";}
@font-face
	{font-family:"Hind SemiBold";}
@font-face
	{font-family:"Hind Siliguri";}
@font-face
	{font-family:"Hind Siliguri Light";}
@font-face
	{font-family:"Hind Siliguri Medium";}
@font-face
	{font-family:"Hind Siliguri SemiBold";}
@font-face
	{font-family:"Hind Vadodara";}
@font-face
	{font-family:"Hind Vadodara Light";}
@font-face
	{font-family:"Hind Vadodara Medium";}
@font-face
	{font-family:"Hind Vadodara SemiBold";}
@font-face
	{font-family:"IBM Plex Mono";}
@font-face
	{font-family:"IBM Plex Mono ExtraLight";}
@font-face
	{font-family:"IBM Plex Mono Light";}
@font-face
	{font-family:"IBM Plex Mono Medium";}
@font-face
	{font-family:"IBM Plex Mono SemiBold";}
@font-face
	{font-family:"IBM Plex Mono Thin";}
@font-face
	{font-family:"IBM Plex Sans";}
@font-face
	{font-family:"IBM Plex Sans Condensed";}
@font-face
	{font-family:"IBM Plex Sans Condensed Light";}
@font-face
	{font-family:"IBM Plex Sans Condensed Medium";}
@font-face
	{font-family:"IBM Plex Sans Condensed Thin";}
@font-face
	{font-family:"IBM Plex Sans ExtraLight";}
@font-face
	{font-family:"IBM Plex Sans Light";}
@font-face
	{font-family:"IBM Plex Sans Medium";}
@font-face
	{font-family:"IBM Plex Sans SemiBold";}
@font-face
	{font-family:"IBM Plex Sans Thin";}
@font-face
	{font-family:"IBM Plex Serif";}
@font-face
	{font-family:"IBM Plex Serif ExtraLight";}
@font-face
	{font-family:"IBM Plex Serif Light";}
@font-face
	{font-family:"IBM Plex Serif Medium";}
@font-face
	{font-family:"IBM Plex Serif SemiBold";}
@font-face
	{font-family:"IBM Plex Serif Thin";}
@font-face
	{font-family:Inconsolata;}
@font-face
	{font-family:"Inconsolata Black";}
@font-face
	{font-family:"Inconsolata Bold";}
@font-face
	{font-family:"Inconsolata Condensed";}
@font-face
	{font-family:"Inconsolata Condensed Black";}
@font-face
	{font-family:"Inconsolata Condensed Bold";}
@font-face
	{font-family:"Inconsolata Condensed ExtraBold";}
@font-face
	{font-family:"Inconsolata Condensed Light";}
@font-face
	{font-family:"Inconsolata Condensed Medium";}
@font-face
	{font-family:"Inconsolata Condensed SemiBold";}
@font-face
	{font-family:"Inconsolata Expanded";}
@font-face
	{font-family:"Inconsolata Expanded Black";}
@font-face
	{font-family:"Inconsolata Expanded Bold";}
@font-face
	{font-family:"Inconsolata Expanded ExtraBold";}
@font-face
	{font-family:"Inconsolata Expanded ExtraLight";}
@font-face
	{font-family:"Inconsolata Expanded Light";}
@font-face
	{font-family:"Inconsolata Expanded Medium";}
@font-face
	{font-family:"Inconsolata Expanded SemiBold";}
@font-face
	{font-family:"Inconsolata ExtraBold";}
@font-face
	{font-family:"Inconsolata ExtraCondensed";}
@font-face
	{font-family:"Inconsolata ExtraCondensed Bold";}
@font-face
	{font-family:"Inconsolata ExtraExpanded";}
@font-face
	{font-family:"Inconsolata ExtraExpanded Black";}
@font-face
	{font-family:"Inconsolata ExtraExpanded Bold";}
@font-face
	{font-family:"Inconsolata ExtraExpanded Light";}
@font-face
	{font-family:"Inconsolata ExtraLight";}
@font-face
	{font-family:"Inconsolata Light";}
@font-face
	{font-family:"Inconsolata Medium";}
@font-face
	{font-family:"Inconsolata SemiBold";}
@font-face
	{font-family:"Inconsolata SemiCondensed";}
@font-face
	{font-family:"Inconsolata SemiCondensed Black";}
@font-face
	{font-family:"Inconsolata SemiCondensed Bold";}
@font-face
	{font-family:"Inconsolata SemiCondensed Light";}
@font-face
	{font-family:"Inconsolata SemiExpanded";}
@font-face
	{font-family:"Inconsolata SemiExpanded Black";}
@font-face
	{font-family:"Inconsolata SemiExpanded Bold";}
@font-face
	{font-family:"Inconsolata SemiExpanded Light";}
@font-face
	{font-family:"Inconsolata SemiExpanded Medium";}
@font-face
	{font-family:"Inconsolata UltraCondensed";}
@font-face
	{font-family:"Inconsolata UltraCondensed Bold";}
@font-face
	{font-family:"Inconsolata UltraExpanded";}
@font-face
	{font-family:"Inconsolata UltraExpanded Black";}
@font-face
	{font-family:"Inconsolata UltraExpanded Bold";}
@font-face
	{font-family:"Inconsolata UltraExpanded Light";}
@font-face
	{font-family:IrisUPC;}
@font-face
	{font-family:"Iskoola Pota";}
@font-face
	{font-family:Italianno;}
@font-face
	{font-family:JasmineUPC;}
@font-face
	{font-family:"Josefin Sans";}
@font-face
	{font-family:"Josefin Sans Bold";}
@font-face
	{font-family:"Josefin Sans Light";}
@font-face
	{font-family:"Josefin Sans SemiBold";}
@font-face
	{font-family:"Josefin Sans Thin";}
@font-face
	{font-family:"Josefin Slab";}
@font-face
	{font-family:"Josefin Slab Light";}
@font-face
	{font-family:"Josefin Slab SemiBold";}
@font-face
	{font-family:"Josefin Slab Thin";}
@font-face
	{font-family:Jumble;}
@font-face
	{font-family:KaiTi;}
@font-face
	{font-family:Kalinga;}
@font-face
	{font-family:Karla;}
@font-face
	{font-family:"Karla ExtraBold";}
@font-face
	{font-family:"Karla ExtraLight";}
@font-face
	{font-family:"Karla Light";}
@font-face
	{font-family:"Karla Medium";}
@font-face
	{font-family:"Karla Tamil Inclined";}
@font-face
	{font-family:"Karla Tamil Upright";}
@font-face
	{font-family:Kartika;}
@font-face
	{font-family:Kermit;}
@font-face
	{font-family:"Khmer UI";}
@font-face
	{font-family:Kigelia;}
@font-face
	{font-family:"Kigelia Arabic";}
@font-face
	{font-family:"Kigelia Arabic Light";}
@font-face
	{font-family:"Kigelia Light";}
@font-face
	{font-family:"Klee One";}
@font-face
	{font-family:"Klee One SemiBold";}
@font-face
	{font-family:KodchiangUPC;}
@font-face
	{font-family:Kokila;}
@font-face
	{font-family:Krub;}
@font-face
	{font-family:"Krub ExtraLight";}
@font-face
	{font-family:"Krub Light";}
@font-face
	{font-family:"Krub Medium";}
@font-face
	{font-family:"Krub SemiBold";}
@font-face
	{font-family:Lalezar;}
@font-face
	{font-family:"Lao UI";}
@font-face
	{font-family:Lato;}
@font-face
	{font-family:"Lato Black";}
@font-face
	{font-family:"Lato ExtraBold";}
@font-face
	{font-family:"Lato ExtraLight";}
@font-face
	{font-family:"Lato Light";}
@font-face
	{font-family:"Lato Medium";}
@font-face
	{font-family:"Lato SemiBold";}
@font-face
	{font-family:"Lato Thin";}
@font-face
	{font-family:Leelawadee;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Levenim MT";}
@font-face
	{font-family:"Libre Barcode 128";}
@font-face
	{font-family:"Libre Barcode 128 Text";}
@font-face
	{font-family:"Libre Barcode 39";}
@font-face
	{font-family:"Libre Barcode 39 Extended";}
@font-face
	{font-family:"Libre Barcode 39 Extended Text";}
@font-face
	{font-family:"Libre Barcode 39 Text";}
@font-face
	{font-family:"Libre Barcode EAN13 Text";}
@font-face
	{font-family:"Libre Baskerville";}
@font-face
	{font-family:"Libre Franklin";}
@font-face
	{font-family:"Libre Franklin Black";}
@font-face
	{font-family:"Libre Franklin ExtraBold";}
@font-face
	{font-family:"Libre Franklin ExtraLight";}
@font-face
	{font-family:"Libre Franklin Light";}
@font-face
	{font-family:"Libre Franklin Medium";}
@font-face
	{font-family:"Libre Franklin SemiBold";}
@font-face
	{font-family:"Libre Franklin Thin";}
@font-face
	{font-family:Ligconsolata;}
@font-face
	{font-family:LilyUPC;}
@font-face
	{font-family:Livvic;}
@font-face
	{font-family:"Livvic Black";}
@font-face
	{font-family:"Livvic ExtraLight";}
@font-face
	{font-family:"Livvic Light";}
@font-face
	{font-family:"Livvic Medium";}
@font-face
	{font-family:"Livvic SemiBold";}
@font-face
	{font-family:"Livvic Thin";}
@font-face
	{font-family:Lobster;}
@font-face
	{font-family:"Lobster Two";}
@font-face
	{font-family:Lora;}
@font-face
	{font-family:"Lora Medium";}
@font-face
	{font-family:"Mangal Pro";}
@font-face
	{font-family:Meddon;}
@font-face
	{font-family:Meiryo;}
@font-face
	{font-family:"Meiryo UI";}
@font-face
	{font-family:Merriweather;}
@font-face
	{font-family:"Merriweather Black";}
@font-face
	{font-family:"Merriweather Light";}
@font-face
	{font-family:"Merriweather Sans";}
@font-face
	{font-family:"Merriweather Sans ExtraBold";}
@font-face
	{font-family:"Merriweather Sans Light";}
@font-face
	{font-family:"Microsoft GothicNeo";}
@font-face
	{font-family:"Microsoft GothicNeo Light";}
@font-face
	{font-family:"Microsoft Uighur";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:MingLiU_HKSCS;}
@font-face
	{font-family:MingLiU_MSCS;}
@font-face
	{font-family:Miriam;}
@font-face
	{font-family:"Miriam Fixed";}
@font-face
	{font-family:"Miriam Libre";}
@font-face
	{font-family:Mitr;}
@font-face
	{font-family:"Mitr ExtraLight";}
@font-face
	{font-family:"Mitr Light";}
@font-face
	{font-family:"Mitr Medium";}
@font-face
	{font-family:"Mitr SemiBold";}
@font-face
	{font-family:"Modern Love";}
@font-face
	{font-family:"Modern Love Caps";}
@font-face
	{font-family:"Modern Love Grunge";}
@font-face
	{font-family:Montserrat;}
@font-face
	{font-family:"Montserrat Black";}
@font-face
	{font-family:"Montserrat ExtraBold";}
@font-face
	{font-family:"Montserrat ExtraLight";}
@font-face
	{font-family:"Montserrat Light";}
@font-face
	{font-family:"Montserrat Medium";}
@font-face
	{font-family:"Montserrat SemiBold";}
@font-face
	{font-family:"Montserrat Thin";}
@font-face
	{font-family:MoolBoran;}
@font-face
	{font-family:"Mr Gabe";}
@font-face
	{font-family:"MS PMincho";}
@font-face
	{font-family:"Mystical Woods Rough Script";}
@font-face
	{font-family:"Mystical Woods Smooth Script";}
@font-face
	{font-family:"Nanum Brush Script";}
@font-face
	{font-family:"Nanum Pen";}
@font-face
	{font-family:NanumGothic;}
@font-face
	{font-family:NanumGothicCoding;}
@font-face
	{font-family:NanumGothicExtraBold;}
@font-face
	{font-family:NanumMyeongjo;}
@font-face
	{font-family:NanumMyeongjoExtraBold;}
@font-face
	{font-family:Narkisim;}
@font-face
	{font-family:"Neue Haas Grotesk Text Pro";}
@font-face
	{font-family:"News Gothic MT";}
@font-face
	{font-family:Nina;}
@font-face
	{font-family:"Nordique Inline";}
@font-face
	{font-family:"Noto Music";}
@font-face
	{font-family:"Noto Nastaliq Urdu";}
@font-face
	{font-family:"Noto Sans";}
@font-face
	{font-family:"Noto Sans AnatoHiero";}
@font-face
	{font-family:"Noto Sans Avestan";}
@font-face
	{font-family:"Noto Sans Bassa Vah";}
@font-face
	{font-family:"Noto Sans Batak";}
@font-face
	{font-family:"Noto Sans Bhaiksuki";}
@font-face
	{font-family:"Noto Sans Brahmi";}
@font-face
	{font-family:"Noto Sans Buginese";}
@font-face
	{font-family:"Noto Sans Buhid";}
@font-face
	{font-family:"Noto Sans Carian";}
@font-face
	{font-family:"Noto Sans CaucAlban";}
@font-face
	{font-family:"Noto Sans Chakma";}
@font-face
	{font-family:"Noto Sans Coptic";}
@font-face
	{font-family:"Noto Sans Cuneiform";}
@font-face
	{font-family:"Noto Sans Cypriot";}
@font-face
	{font-family:"Noto Sans Deseret";}
@font-face
	{font-family:"Noto Sans Devanagari";}
@font-face
	{font-family:"Noto Sans Devanagari Black";}
@font-face
	{font-family:"Noto Sans Devanagari ExtraBold";}
@font-face
	{font-family:"Noto Sans Devanagari ExtraLight";}
@font-face
	{font-family:"Noto Sans Devanagari Light";}
@font-face
	{font-family:"Noto Sans Devanagari Medium";}
@font-face
	{font-family:"Noto Sans Devanagari SemiBold";}
@font-face
	{font-family:"Noto Sans Devanagari Thin";}
@font-face
	{font-family:"Noto Sans Devanagari UI";}
@font-face
	{font-family:"Noto Sans Devanagari UI Black";}
@font-face
	{font-family:"Noto Sans Devanagari UI Light";}
@font-face
	{font-family:"Noto Sans Devanagari UI Medium";}
@font-face
	{font-family:"Noto Sans Devanagari UI Thin";}
@font-face
	{font-family:"Noto Sans Duployan";}
@font-face
	{font-family:"Noto Sans EgyptHiero";}
@font-face
	{font-family:"Noto Sans Elbasan";}
@font-face
	{font-family:"Noto Sans Elymaic";}
@font-face
	{font-family:"Noto Sans Glagolitic";}
@font-face
	{font-family:"Noto Sans Gothic";}
@font-face
	{font-family:"Noto Sans Grantha";}
@font-face
	{font-family:"Noto Sans Gujarati";}
@font-face
	{font-family:"Noto Sans Gujarati Black";}
@font-face
	{font-family:"Noto Sans Gujarati ExtraBold";}
@font-face
	{font-family:"Noto Sans Gujarati ExtraLight";}
@font-face
	{font-family:"Noto Sans Gujarati Light";}
@font-face
	{font-family:"Noto Sans Gujarati Medium";}
@font-face
	{font-family:"Noto Sans Gujarati SemiBold";}
@font-face
	{font-family:"Noto Sans Gujarati Thin";}
@font-face
	{font-family:"Noto Sans Gujarati UI";}
@font-face
	{font-family:"Noto Sans Gujarati UI Black";}
@font-face
	{font-family:"Noto Sans Gujarati UI ExtraBold";}
@font-face
	{font-family:"Noto Sans Gujarati UI Light";}
@font-face
	{font-family:"Noto Sans Gujarati UI Medium";}
@font-face
	{font-family:"Noto Sans Gujarati UI SemiBold";}
@font-face
	{font-family:"Noto Sans Gujarati UI Thin";}
@font-face
	{font-family:"Noto Sans Gunjala Gondi";}
@font-face
	{font-family:"Noto Sans Hanunoo";}
@font-face
	{font-family:"Noto Sans Hatran";}
@font-face
	{font-family:"Noto Sans ImpAramaic";}
@font-face
	{font-family:"Noto Sans Indic Siyaq Numbers";}
@font-face
	{font-family:"Noto Sans InsPahlavi";}
@font-face
	{font-family:"Noto Sans InsParthi";}
@font-face
	{font-family:"Noto Sans Javanese";}
@font-face
	{font-family:"Noto Sans Kaithi";}
@font-face
	{font-family:"Noto Sans Kharoshthi";}
@font-face
	{font-family:"Noto Sans Khojki";}
@font-face
	{font-family:"Noto Sans Khudawadi";}
@font-face
	{font-family:"Noto Sans Lepcha";}
@font-face
	{font-family:"Noto Sans Limbu";}
@font-face
	{font-family:"Noto Sans Linear A";}
@font-face
	{font-family:"Noto Sans Linear B";}
@font-face
	{font-family:"Noto Sans Lycian";}
@font-face
	{font-family:"Noto Sans Lydian";}
@font-face
	{font-family:"Noto Sans Mahajani";}
@font-face
	{font-family:"Noto Sans Mandaic";}
@font-face
	{font-family:"Noto Sans Manichaean";}
@font-face
	{font-family:"Noto Sans Marchen";}
@font-face
	{font-family:"Noto Sans Masaram Gondi";}
@font-face
	{font-family:"Noto Sans Math";}
@font-face
	{font-family:"Noto Sans Mayan Numerals";}
@font-face
	{font-family:"Noto Sans Mende Kikakui";}
@font-face
	{font-family:"Noto Sans Meroitic";}
@font-face
	{font-family:"Noto Sans Miao";}
@font-face
	{font-family:"Noto Sans Modi";}
@font-face
	{font-family:"Noto Sans Mongolian";}
@font-face
	{font-family:"Noto Sans Mro";}
@font-face
	{font-family:"Noto Sans Multani";}
@font-face
	{font-family:"Noto Sans Myanmar";}
@font-face
	{font-family:"Noto Sans Myanmar Blk";}
@font-face
	{font-family:"Noto Sans Myanmar ExtBd";}
@font-face
	{font-family:"Noto Sans Myanmar ExtLt";}
@font-face
	{font-family:"Noto Sans Myanmar Light";}
@font-face
	{font-family:"Noto Sans Myanmar Med";}
@font-face
	{font-family:"Noto Sans Myanmar SemBd";}
@font-face
	{font-family:"Noto Sans Myanmar Thin";}
@font-face
	{font-family:"Noto Sans Myanmar UI";}
@font-face
	{font-family:"Noto Sans Myanmar UI Black";}
@font-face
	{font-family:"Noto Sans Myanmar UI ExtraBold";}
@font-face
	{font-family:"Noto Sans Myanmar UI ExtraLight";}
@font-face
	{font-family:"Noto Sans Myanmar UI Light";}
@font-face
	{font-family:"Noto Sans Myanmar UI Medium";}
@font-face
	{font-family:"Noto Sans Myanmar UI SemiBold";}
@font-face
	{font-family:"Noto Sans Myanmar UI Thin";}
@font-face
	{font-family:"Noto Sans Nabataean";}
@font-face
	{font-family:"Noto Sans Newa";}
@font-face
	{font-family:"Noto Sans NewTaiLue";}
@font-face
	{font-family:"Noto Sans NKo";}
@font-face
	{font-family:"Noto Sans Nushu";}
@font-face
	{font-family:"Noto Sans Ogham";}
@font-face
	{font-family:"Noto Sans Old Italic";}
@font-face
	{font-family:"Noto Sans Old Permic";}
@font-face
	{font-family:"Noto Sans Old Turkic";}
@font-face
	{font-family:"Noto Sans OldHung";}
@font-face
	{font-family:"Noto Sans OldNorArab";}
@font-face
	{font-family:"Noto Sans OldPersian";}
@font-face
	{font-family:"Noto Sans OldSogdian";}
@font-face
	{font-family:"Noto Sans OldSouArab";}
@font-face
	{font-family:"Noto Sans Oriya";}
@font-face
	{font-family:"Noto Sans Oriya Blk";}
@font-face
	{font-family:"Noto Sans Oriya Thin";}
@font-face
	{font-family:"Noto Sans Oriya UI";}
@font-face
	{font-family:"Noto Sans Oriya UI Blk";}
@font-face
	{font-family:"Noto Sans Oriya UI Thin";}
@font-face
	{font-family:"Noto Sans Osage";}
@font-face
	{font-family:"Noto Sans Osmanya";}
@font-face
	{font-family:"Noto Sans Pahawh Hmong";}
@font-face
	{font-family:"Noto Sans Palmyrene";}
@font-face
	{font-family:"Noto Sans PauCinHau";}
@font-face
	{font-family:"Noto Sans PhagsPa";}
@font-face
	{font-family:"Noto Sans Phoenician";}
@font-face
	{font-family:"Noto Sans PsaPahlavi";}
@font-face
	{font-family:"Noto Sans Rejang";}
@font-face
	{font-family:"Noto Sans Runic";}
@font-face
	{font-family:"Noto Sans Samaritan";}
@font-face
	{font-family:"Noto Sans Saurashtra";}
@font-face
	{font-family:"Noto Sans Sharada";}
@font-face
	{font-family:"Noto Sans Shavian";}
@font-face
	{font-family:"Noto Sans Siddham";}
@font-face
	{font-family:"Noto Sans Sogdian";}
@font-face
	{font-family:"Noto Sans Soyombo";}
@font-face
	{font-family:"Noto Sans Syloti Nagri";}
@font-face
	{font-family:"Noto Sans Symbols2";}
@font-face
	{font-family:"Noto Sans Syriac";}
@font-face
	{font-family:"Noto Sans Syriac Black";}
@font-face
	{font-family:"Noto Sans Syriac Thin";}
@font-face
	{font-family:"Noto Sans Tagalog";}
@font-face
	{font-family:"Noto Sans Tagbanwa";}
@font-face
	{font-family:"Noto Sans Tai Le";}
@font-face
	{font-family:"Noto Sans Tai Viet";}
@font-face
	{font-family:"Noto Sans Takri";}
@font-face
	{font-family:"Noto Sans Tamil Supplement";}
@font-face
	{font-family:"Noto Sans Thai Looped Black";}
@font-face
	{font-family:"Noto Sans Thai Looped Bold";}
@font-face
	{font-family:"Noto Sans Thai Looped ExtLight";}
@font-face
	{font-family:"Noto Sans Thai Looped Extrabold";}
@font-face
	{font-family:"Noto Sans Thai Looped Light";}
@font-face
	{font-family:"Noto Sans Thai Looped Medium";}
@font-face
	{font-family:"Noto Sans Thai Looped Regular";}
@font-face
	{font-family:"Noto Sans Thai Looped Semibold";}
@font-face
	{font-family:"Noto Sans Thai Looped Thin";}
@font-face
	{font-family:"Noto Sans Tifinagh";}
@font-face
	{font-family:"Noto Sans Tirhuta";}
@font-face
	{font-family:"Noto Sans Ugaritic";}
@font-face
	{font-family:"Noto Sans Vai";}
@font-face
	{font-family:"Noto Sans Wancho";}
@font-face
	{font-family:"Noto Sans WarangCiti";}
@font-face
	{font-family:"Noto Sans Yi";}
@font-face
	{font-family:"Noto Sans Zanabazar";}
@font-face
	{font-family:"Noto Serif";}
@font-face
	{font-family:"Noto Serif Ahom";}
@font-face
	{font-family:"Noto Serif Balinese";}
@font-face
	{font-family:"Noto Serif Dogra";}
@font-face
	{font-family:"Noto Serif Grantha";}
@font-face
	{font-family:"Noto Serif Myanmar";}
@font-face
	{font-family:"Noto Serif Myanmar Blk";}
@font-face
	{font-family:"Noto Serif Myanmar ExtBd";}
@font-face
	{font-family:"Noto Serif Myanmar ExtLt";}
@font-face
	{font-family:"Noto Serif Myanmar Light";}
@font-face
	{font-family:"Noto Serif Myanmar Med";}
@font-face
	{font-family:"Noto Serif Myanmar SemBd";}
@font-face
	{font-family:"Noto Serif Myanmar Thin";}
@font-face
	{font-family:"Noto Serif Tangut";}
@font-face
	{font-family:"Noto Traditional Nushu";}
@font-face
	{font-family:Nunito;}
@font-face
	{font-family:"Nunito Black";}
@font-face
	{font-family:"Nunito ExtraBold";}
@font-face
	{font-family:"Nunito ExtraLight";}
@font-face
	{font-family:"Nunito Light";}
@font-face
	{font-family:"Nunito Sans";}
@font-face
	{font-family:"Nunito Sans Black";}
@font-face
	{font-family:"Nunito Sans ExtraBold";}
@font-face
	{font-family:"Nunito Sans ExtraLight";}
@font-face
	{font-family:"Nunito Sans Light";}
@font-face
	{font-family:"Nunito Sans SemiBold";}
@font-face
	{font-family:"Nunito SemiBold";}
@font-face
	{font-family:Nyala;}
@font-face
	{font-family:OCRB;}
@font-face
	{font-family:"Open Sans";}
@font-face
	{font-family:"Open Sans ExtraBold";}
@font-face
	{font-family:"Open Sans Light";}
@font-face
	{font-family:"Open Sans SemiBold";}
@font-face
	{font-family:Oranienbaum;}
@font-face
	{font-family:Oswald;}
@font-face
	{font-family:"Oswald ExtraLight";}
@font-face
	{font-family:"Oswald Light";}
@font-face
	{font-family:"Oswald Medium";}
@font-face
	{font-family:"Oswald SemiBold";}
@font-face
	{font-family:Oxygen;}
@font-face
	{font-family:"Oxygen Light";}
@font-face
	{font-family:"Oxygen Mono";}
@font-face
	{font-family:Pacifico;}
@font-face
	{font-family:Palanquin;}
@font-face
	{font-family:"Palanquin ExtraLight";}
@font-face
	{font-family:"Palanquin Light";}
@font-face
	{font-family:"Palanquin Medium";}
@font-face
	{font-family:"Palanquin SemiBold";}
@font-face
	{font-family:"Palanquin Thin";}
@font-face
	{font-family:"Patrick Hand";}
@font-face
	{font-family:"Patrick Hand SC";}
@font-face
	{font-family:"Petit Formal Script";}
@font-face
	{font-family:"Plantagenet Cherokee";}
@font-face
	{font-family:"Playfair Display";}
@font-face
	{font-family:"Playfair Display Black";}
@font-face
	{font-family:"Playfair Display SC";}
@font-face
	{font-family:"Playfair Display SC Black";}
@font-face
	{font-family:"Poiret One";}
@font-face
	{font-family:Poppins;}
@font-face
	{font-family:"Poppins Black";}
@font-face
	{font-family:"Poppins ExtraBold";}
@font-face
	{font-family:"Poppins ExtraLight";}
@font-face
	{font-family:"Poppins Light";}
@font-face
	{font-family:"Poppins Medium";}
@font-face
	{font-family:"Poppins SemiBold";}
@font-face
	{font-family:"Poppins Thin";}
@font-face
	{font-family:Posterama;}
@font-face
	{font-family:Pridi;}
@font-face
	{font-family:"Pridi ExtraLight";}
@font-face
	{font-family:"Pridi Light";}
@font-face
	{font-family:"Pridi Medium";}
@font-face
	{font-family:"Pridi SemiBold";}
@font-face
	{font-family:Prompt;}
@font-face
	{font-family:"Prompt Black";}
@font-face
	{font-family:"Prompt ExtraBold";}
@font-face
	{font-family:"Prompt ExtraLight";}
@font-face
	{font-family:"Prompt Light";}
@font-face
	{font-family:"Prompt Medium";}
@font-face
	{font-family:"Prompt SemiBold";}
@font-face
	{font-family:"Prompt Thin";}
@font-face
	{font-family:"PT Mono";}
@font-face
	{font-family:"PT Sans";}
@font-face
	{font-family:"PT Sans Caption";}
@font-face
	{font-family:"PT Sans Narrow";}
@font-face
	{font-family:"PT Serif";}
@font-face
	{font-family:"PT Serif Caption";}
@font-face
	{font-family:Quattrocento;}
@font-face
	{font-family:"Quattrocento Sans";}
@font-face
	{font-family:Questrial;}
@font-face
	{font-family:"Quire Sans";}
@font-face
	{font-family:"Quire Sans Light";}
@font-face
	{font-family:"Quire Sans Pro Light";}
@font-face
	{font-family:Raleway;}
@font-face
	{font-family:"Raleway Black";}
@font-face
	{font-family:"Raleway ExtraBold";}
@font-face
	{font-family:"Raleway ExtraLight";}
@font-face
	{font-family:"Raleway Light";}
@font-face
	{font-family:"Raleway Medium";}
@font-face
	{font-family:"Raleway SemiBold";}
@font-face
	{font-family:"Raleway Thin";}
@font-face
	{font-family:"Rastanty Cortez";}
@font-face
	{font-family:"Reem Kufi";}
@font-face
	{font-family:Roboto;}
@font-face
	{font-family:"Roboto Black";}
@font-face
	{font-family:"Roboto Condensed";}
@font-face
	{font-family:"Roboto Condensed Light";}
@font-face
	{font-family:"Roboto Condensed Medium";}
@font-face
	{font-family:"Roboto Light";}
@font-face
	{font-family:"Roboto Medium";}
@font-face
	{font-family:"Roboto Mono";}
@font-face
	{font-family:"Roboto Mono Light";}
@font-face
	{font-family:"Roboto Mono Medium";}
@font-face
	{font-family:"Roboto Mono Thin";}
@font-face
	{font-family:"Roboto Serif 20pt";}
@font-face
	{font-family:"Roboto Serif 20pt Black";}
@font-face
	{font-family:"Roboto Serif 20pt ExtraBold";}
@font-face
	{font-family:"Roboto Serif 20pt ExtraLight";}
@font-face
	{font-family:"Roboto Serif 20pt Light";}
@font-face
	{font-family:"Roboto Serif 20pt Medium";}
@font-face
	{font-family:"Roboto Serif 20pt SemiBold";}
@font-face
	{font-family:"Roboto Serif 20pt Thin";}
@font-face
	{font-family:"Roboto Slab";}
@font-face
	{font-family:"Roboto Slab Black";}
@font-face
	{font-family:"Roboto Slab ExtraBold";}
@font-face
	{font-family:"Roboto Slab ExtraLight";}
@font-face
	{font-family:"Roboto Slab Light";}
@font-face
	{font-family:"Roboto Slab Medium";}
@font-face
	{font-family:"Roboto Slab SemiBold";}
@font-face
	{font-family:"Roboto Slab Thin";}
@font-face
	{font-family:"Roboto Thin";}
@font-face
	{font-family:"Rockwell Light";}
@font-face
	{font-family:"Rockwell Nova";}
@font-face
	{font-family:"Rockwell Nova Cond";}
@font-face
	{font-family:"Rockwell Nova Cond Light";}
@font-face
	{font-family:"Rockwell Nova Extra Bold";}
@font-face
	{font-family:"Rockwell Nova Light";}
@font-face
	{font-family:Rod;}
@font-face
	{font-family:"Sabon Next LT";}
@font-face
	{font-family:Sacramento;}
@font-face
	{font-family:Sagona;}
@font-face
	{font-family:"Sagona Book";}
@font-face
	{font-family:"Sagona ExtraLight";}
@font-face
	{font-family:"Sakkal Majalla";}
@font-face
	{font-family:"Sanskrit Text";}
@font-face
	{font-family:Seaford;}
@font-face
	{font-family:"Seaford Display";}
@font-face
	{font-family:"Secular One";}
@font-face
	{font-family:"Segoe Marker";}
@font-face
	{font-family:"Segoe Pro";}
@font-face
	{font-family:"Segoe Pro Black";}
@font-face
	{font-family:"Segoe Pro Cond";}
@font-face
	{font-family:"Segoe Pro Display";}
@font-face
	{font-family:"Segoe Pro Display Light";}
@font-face
	{font-family:"Segoe Pro Display Semibold";}
@font-face
	{font-family:"Segoe Pro Display SemiLight";}
@font-face
	{font-family:"Segoe Pro Light";}
@font-face
	{font-family:"Segoe Pro Semibold";}
@font-face
	{font-family:"Segoe Pro SemiLight";}
@font-face
	{font-family:"Segoe Sans Display";}
@font-face
	{font-family:"Segoe Sans Display Black";}
@font-face
	{font-family:"Segoe Sans Display Extrabold";}
@font-face
	{font-family:"Segoe Sans Display Hairline";}
@font-face
	{font-family:"Segoe Sans Display Light";}
@font-face
	{font-family:"Segoe Sans Display Semibold";}
@font-face
	{font-family:"Segoe Sans Display Semilight";}
@font-face
	{font-family:"Segoe Sans Display Thin";}
@font-face
	{font-family:"Segoe Sans Small";}
@font-face
	{font-family:"Segoe Sans Small Black";}
@font-face
	{font-family:"Segoe Sans Small Extrabold";}
@font-face
	{font-family:"Segoe Sans Small Hairline";}
@font-face
	{font-family:"Segoe Sans Small Light";}
@font-face
	{font-family:"Segoe Sans Small Semibold";}
@font-face
	{font-family:"Segoe Sans Small Semilight";}
@font-face
	{font-family:"Segoe Sans Small Thin";}
@font-face
	{font-family:"Segoe Sans Text";}
@font-face
	{font-family:"Segoe Sans Text Black";}
@font-face
	{font-family:"Segoe Sans Text Extrabold";}
@font-face
	{font-family:"Segoe Sans Text Hairline";}
@font-face
	{font-family:"Segoe Sans Text Light";}
@font-face
	{font-family:"Segoe Sans Text Semibold";}
@font-face
	{font-family:"Segoe Sans Text Semilight";}
@font-face
	{font-family:"Segoe Sans Text Thin";}
@font-face
	{font-family:"Segoe Serif Banner";}
@font-face
	{font-family:"Segoe Serif Banner Light";}
@font-face
	{font-family:"Segoe Serif Banner Semibold";}
@font-face
	{font-family:"Segoe Serif Banner Semilight";}
@font-face
	{font-family:"Segoe Serif Display";}
@font-face
	{font-family:"Segoe Serif Display Light";}
@font-face
	{font-family:"Segoe Serif Display Semibold";}
@font-face
	{font-family:"Segoe Serif Display Semilight";}
@font-face
	{font-family:"Segoe Serif Text";}
@font-face
	{font-family:"Segoe Serif Text Light";}
@font-face
	{font-family:"Segoe Serif Text Semibold";}
@font-face
	{font-family:"Segoe Serif Text Semilight";}
@font-face
	{font-family:"Segoe UI Emoji L";}
@font-face
	{font-family:"Segoe UI Variable Display Black";}
@font-face
	{font-family:"Segoe UI Variable Display Thin";}
@font-face
	{font-family:"Segoe UI Variable Small Black";}
@font-face
	{font-family:"Segoe UI Variable Small Thin";}
@font-face
	{font-family:"Segoe UI Variable Text Black";}
@font-face
	{font-family:"Segoe UI Variable Text Hairline";}
@font-face
	{font-family:"Segoe UI Variable Text Thin";}
@font-face
	{font-family:"Segoe Xbox Symbol";}
@font-face
	{font-family:Selawik;}
@font-face
	{font-family:"Selawik Light";}
@font-face
	{font-family:"Selawik Semibold";}
@font-face
	{font-family:"Shadows Into Light Two";}
@font-face
	{font-family:"Shonar Bangla";}
@font-face
	{font-family:"Simplified Arabic";}
@font-face
	{font-family:"Simplified Arabic Fixed";}
@font-face
	{font-family:Skeena;}
@font-face
	{font-family:"Skeena Display";}
@font-face
	{font-family:"Source Code Pro";}
@font-face
	{font-family:"Source Code Pro Black";}
@font-face
	{font-family:"Source Code Pro ExtraLight";}
@font-face
	{font-family:"Source Code Pro Light";}
@font-face
	{font-family:"Source Code Pro Medium";}
@font-face
	{font-family:"Source Code Pro Semibold";}
@font-face
	{font-family:"Source Sans Pro";}
@font-face
	{font-family:"Source Sans Pro Black";}
@font-face
	{font-family:"Source Sans Pro ExtraLight";}
@font-face
	{font-family:"Source Sans Pro Light";}
@font-face
	{font-family:"Source Sans Pro SemiBold";}
@font-face
	{font-family:"Source Serif Pro";}
@font-face
	{font-family:"Source Serif Pro Black";}
@font-face
	{font-family:"Source Serif Pro ExtraLight";}
@font-face
	{font-family:"Source Serif Pro Light";}
@font-face
	{font-family:"Source Serif Pro SemiBold";}
@font-face
	{font-family:"Speak Pro";}
@font-face
	{font-family:"Speak Pro Light";}
@font-face
	{font-family:Staatliches;}
@font-face
	{font-family:STCaiyun;}
@font-face
	{font-family:STFangsong;}
@font-face
	{font-family:STHupo;}
@font-face
	{font-family:STKaiti;}
@font-face
	{font-family:STXihei;}
@font-face
	{font-family:STXingkai;}
@font-face
	{font-family:STXinwei;}
@font-face
	{font-family:STZhongsong;}
@font-face
	{font-family:"Suez One";}
@font-face
	{font-family:Tenorite;}
@font-face
	{font-family:"Tenorite Display";}
@font-face
	{font-family:"TH SarabunPSK";}
@font-face
	{font-family:"The Hand";}
@font-face
	{font-family:"The Hand Black";}
@font-face
	{font-family:"The Hand Extrablack";}
@font-face
	{font-family:"The Hand Light";}
@font-face
	{font-family:"The Serif Hand";}
@font-face
	{font-family:"The Serif Hand Black";}
@font-face
	{font-family:"The Serif Hand Extrablack";}
@font-face
	{font-family:"The Serif Hand Light";}
@font-face
	{font-family:"Tisa Offc Serif Pro";}
@font-face
	{font-family:"Tisa Offc Serif Pro Thin";}
@font-face
	{font-family:"Titillium Web";}
@font-face
	{font-family:"Titillium Web Black";}
@font-face
	{font-family:"Titillium Web ExtraLight";}
@font-face
	{font-family:"Titillium Web Light";}
@font-face
	{font-family:"Titillium Web SemiBold";}
@font-face
	{font-family:"Trade Gothic Inline";}
@font-face
	{font-family:"Trade Gothic Next";}
@font-face
	{font-family:"Trade Gothic Next Cond";}
@font-face
	{font-family:"Trade Gothic Next Heavy";}
@font-face
	{font-family:"Trade Gothic Next HvyCd";}
@font-face
	{font-family:"Trade Gothic Next Light";}
@font-face
	{font-family:"Trade Gothic Next Rounded";}
@font-face
	{font-family:"Traditional Arabic";}
@font-face
	{font-family:Trirong;}
@font-face
	{font-family:"Trirong Black";}
@font-face
	{font-family:"Trirong ExtraBold";}
@font-face
	{font-family:"Trirong ExtraLight";}
@font-face
	{font-family:"Trirong Light";}
@font-face
	{font-family:"Trirong Medium";}
@font-face
	{font-family:"Trirong SemiBold";}
@font-face
	{font-family:"Trirong Thin";}
@font-face
	{font-family:Ubuntu;}
@font-face
	{font-family:"Ubuntu Condensed";}
@font-face
	{font-family:"Ubuntu Light";}
@font-face
	{font-family:"Ubuntu Medium";}
@font-face
	{font-family:"Ubuntu Mono";}
@font-face
	{font-family:"UD Digi Kyokasho N-B";}
@font-face
	{font-family:"UD Digi Kyokasho N-R";}
@font-face
	{font-family:"UD Digi Kyokasho NK-B";}
@font-face
	{font-family:"UD Digi Kyokasho NK-R";}
@font-face
	{font-family:"UD Digi Kyokasho NP-B";}
@font-face
	{font-family:"UD Digi Kyokasho NP-R";}
@font-face
	{font-family:Univers;}
@font-face
	{font-family:"Univers Condensed";}
@font-face
	{font-family:"Univers Condensed Light";}
@font-face
	{font-family:"Univers Light";}
@font-face
	{font-family:"Urdu Typesetting";}
@font-face
	{font-family:Utsaah;}
@font-face
	{font-family:Vani;}
@font-face
	{font-family:"Varela Round";}
@font-face
	{font-family:"Verdana Pro";}
@font-face
	{font-family:"Verdana Pro Black";}
@font-face
	{font-family:"Verdana Pro Cond";}
@font-face
	{font-family:"Verdana Pro Cond Black";}
@font-face
	{font-family:"Verdana Pro Cond Light";}
@font-face
	{font-family:"Verdana Pro Cond Semibold";}
@font-face
	{font-family:"Verdana Pro Light";}
@font-face
	{font-family:"Verdana Pro Semibold";}
@font-face
	{font-family:Vijaya;}
@font-face
	{font-family:"Walbaum Display";}
@font-face
	{font-family:"Walbaum Display Heavy";}
@font-face
	{font-family:"Walbaum Display Light";}
@font-face
	{font-family:"Walbaum Display SemiBold";}
@font-face
	{font-family:"Walbaum Heading";}
@font-face
	{font-family:"Walbaum Text";}
@font-face
	{font-family:Wandohope;}
@font-face
	{font-family:"Work Sans";}
@font-face
	{font-family:"Work Sans Black";}
@font-face
	{font-family:"Work Sans ExtraBold";}
@font-face
	{font-family:"Work Sans ExtraLight";}
@font-face
	{font-family:"Work Sans Light";}
@font-face
	{font-family:"Work Sans Medium";}
@font-face
	{font-family:"Work Sans SemiBold";}
@font-face
	{font-family:"Work Sans Thin";}
@font-face
	{font-family:Yesteryear;}
@font-face
	{font-family:"Yu Mincho";}
@font-face
	{font-family:"Yu Mincho Demibold";}
@font-face
	{font-family:"Yu Mincho Light";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-indent:0cm;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;
	color:#4F81BD;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:0cm;
	margin-right:14.2pt;
	margin-bottom:0cm;
	margin-left:0cm;
	text-indent:0cm;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri",sans-serif;
	color:#4F81BD;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin:0cm;
	text-indent:0cm;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri",sans-serif;
	color:#4F81BD;
	font-weight:normal;}
h4
	{mso-style-link:"Heading 4 Char";
	margin:0cm;
	text-indent:0cm;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri",sans-serif;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-indent:0cm;
	font-size:13.0pt;
	font-family:"Calibri",sans-serif;
	font-style:italic;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-indent:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin:0cm;
	text-indent:0cm;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;
	color:#4F81BD;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"Heading 8 Char";
	margin:0cm;
	text-indent:0cm;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:#4F81BD;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"Heading 9 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-indent:0cm;
	font-size:14.0pt;
	font-family:"Calibri",sans-serif;
	color:#4F81BD;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:12.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:48.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:11.9pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-link:"Footnote Text Char";
	margin:0cm;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin:0cm;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin:0cm;
	text-align:center;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	font-style:italic;}
span.MsoFootnoteReference
	{vertical-align:super;}
span.MsoEndnoteReference
	{vertical-align:super;}
p.MsoEndnoteText, li.MsoEndnoteText, div.MsoEndnoteText
	{mso-style-link:"Endnote Text Char";
	margin:0cm;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin:0cm;
	text-align:center;
	font-size:18.0pt;
	font-family:"Cambria",serif;
	color:#4F81BD;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin:0cm;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri",sans-serif;
	color:#4F81BD;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri",sans-serif;
	color:#4F81BD;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri",sans-serif;
	color:#4F81BD;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri",sans-serif;
	color:#4F81BD;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Arial",sans-serif;
	font-weight:bold;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-weight:bold;
	font-style:italic;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-weight:bold;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Arial",sans-serif;
	color:#4F81BD;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-link:"Heading 8";
	font-family:"Arial",sans-serif;
	color:#4F81BD;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-link:"Heading 9";
	font-family:"Calibri",sans-serif;
	color:#4F81BD;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma",sans-serif;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Cambria",serif;
	color:#4F81BD;}
span.EndnoteTextChar
	{mso-style-name:"Endnote Text Char";
	mso-style-link:"Endnote Text";}
span.FootnoteTextChar
	{mso-style-name:"Footnote Text Char";
	mso-style-link:"Footnote Text";}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-NZ link=blue vlink=purple style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:18.0pt;color:#4F81BD'>KeaExpert – Pulse Programming Guide</span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:18.0pt;color:#4F81BD'>Version 2.02 (FX3) August 2025</span><span
style='font-size:18.0pt;color:#4F81BD'> </span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-family:"Cambria",serif;color:#4F81BD'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoTocHeading>Table of Contents</p>

<p class=MsoToc1><a href="#_Toc183531979">1<span style='color:windowtext;
text-decoration:none'>      </span>Introduction<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc1><a href="#_Toc183531980">2<span style='color:windowtext;
text-decoration:none'>      </span>File organisation<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoToc1><a href="#_Toc183531981">3<span style='color:windowtext;
text-decoration:none'>      </span>The Proton experiment examined<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc183531982">3.1<span style='color:windowtext;
text-decoration:none'>       </span>The Pulse Program Macro<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></p>

<p class=MsoToc2><a href="#_Toc183531983">3.2<span style='color:windowtext;
text-decoration:none'>       </span>The interface description<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>9</span></a></p>

<p class=MsoToc2><a href="#_Toc183531984">3.3<span style='color:windowtext;
text-decoration:none'>       </span>The relationships list<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></p>

<p class=MsoToc2><a href="#_Toc183531985">3.4<span style='color:windowtext;
text-decoration:none'>       </span>Understanding the various frequencies
defined in an Expert<span style='color:windowtext;display:none;text-decoration:
none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></p>

<p class=MsoToc2><a href="#_Toc183531986">3.5<span style='color:windowtext;
text-decoration:none'>       </span>The group list<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></p>

<p class=MsoToc2><a href="#_Toc183531987">3.6<span style='color:windowtext;
text-decoration:none'>       </span>The variable list<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc183531988">3.7<span style='color:windowtext;
text-decoration:none'>       </span>The pulse program<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc183531989">3.8<span style='color:windowtext;
text-decoration:none'>       </span>The phase cycle matrix<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></p>

<p class=MsoToc2><a href="#_Toc183531990">3.9<span style='color:windowtext;
text-decoration:none'>       </span>The returned variables<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></p>

<p class=MsoToc2><a href="#_Toc183531991">3.10<span style='color:windowtext;
text-decoration:none'>     </span>How parameters are initialised in the user
interface<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></p>

<p class=MsoToc1><a href="#_Toc183531992">4<span style='color:windowtext;
text-decoration:none'>      </span>Writing a new pulse program<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>19</span></a></p>

<p class=MsoToc1><a href="#_Toc183531993">5<span style='color:windowtext;
text-decoration:none'>      </span>The Experiment Control Macro<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>20</span></a></p>

<p class=MsoToc2><a href="#_Toc183531994">5.1<span style='color:windowtext;
text-decoration:none'>       </span>The execpp (execute pulse program)
procedure arguments<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc183531995">5.2<span style='color:windowtext;
text-decoration:none'>       </span>The execpp procedure in detail<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>23</span></a></p>

<p class=MsoToc2><a href="#_Toc183531996">5.3<span style='color:windowtext;
text-decoration:none'>       </span>Modifying the execpp procedure to vary the
pulse duration<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>25</span></a></p>

<p class=MsoToc7><a href="#_Toc183531997">Appendix A<span style='color:windowtext;
text-decoration:none'>    </span>Pulse program commands<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>32</span></a></p>

<p class=MsoToc8><a href="#_Toc183531998"><span lang=EN-GB>A.1</span><span
style='color:windowtext;text-decoration:none'>       </span><span lang=EN-GB>Acquire
NMR data</span><span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>32</span></a></p>

<p class=MsoToc8><a href="#_Toc183531999"><span lang=EN-GB>A.2</span><span
style='color:windowtext;text-decoration:none'>       </span><span lang=EN-GB>Clear
the spectrometer data memory</span><span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>33</span></a></p>

<p class=MsoToc8><a href="#_Toc183532000"><span lang=EN-GB>A.3</span><span
style='color:windowtext;text-decoration:none'>       </span><span lang=EN-GB>Delay
for a specified time</span><span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>34</span></a></p>

<p class=MsoToc8><a href="#_Toc183532001"><span lang=EN-GB>A.4</span><span
style='color:windowtext;text-decoration:none'>       </span><span lang=EN-GB>Frequency
modifications</span><span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>34</span></a></p>

<p class=MsoToc8><a href="#_Toc183532002"><span lang=EN-GB>A.5</span><span
style='color:windowtext;text-decoration:none'>       </span><span lang=EN-GB>Looping</span><span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>35</span></a></p>

<p class=MsoToc8><a href="#_Toc183532003"><span lang=EN-GB>A.6</span><span
style='color:windowtext;text-decoration:none'>       </span><span lang=EN-GB>RF
pulse production</span><span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>36</span></a></p>

<p class=MsoToc8><a href="#_Toc183532004">A.7<span style='color:windowtext;
text-decoration:none'>       </span>Shim and gradient commands<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>39</span></a></p>

<p class=MsoToc8><a href="#_Toc183532005">A.8<span style='color:windowtext;
text-decoration:none'>       </span>Table commands<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>40</span></a></p>

<p class=MsoToc7><a href="#_Toc183532006">Appendix B<span style='color:windowtext;
text-decoration:none'>    </span>Available control groups<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>40</span></a></p>

<p class=MsoToc8><a href="#_Toc183532007">B.1<span style='color:windowtext;
text-decoration:none'>       </span>Acquisition<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>41</span></a></p>

<p class=MsoToc8><a href="#_Toc183532008">B.2<span style='color:windowtext;
text-decoration:none'>       </span>AcquisitionBW<span style='color:windowtext;
display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>41</span></a></p>

<p class=MsoToc8><a href="#_Toc183532009">B.3<span style='color:windowtext;
text-decoration:none'>       </span>AcquisitionBW2D<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>42</span></a></p>

<p class=MsoToc8><a href="#_Toc183532010">B.4<span style='color:windowtext;
text-decoration:none'>       </span>AcquisitionFIR<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>42</span></a></p>

<p class=MsoToc8><a href="#_Toc183532011">B.5<span style='color:windowtext;
text-decoration:none'>       </span>Display_Std<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>43</span></a></p>

<p class=MsoToc8><a href="#_Toc183532012">B.6<span style='color:windowtext;
text-decoration:none'>       </span>Display_2D<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>43</span></a></p>

<p class=MsoToc8><a href="#_Toc183532013">B.7<span style='color:windowtext;
text-decoration:none'>       </span>Display_Hz<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>43</span></a></p>

<p class=MsoToc8><a href="#_Toc183532014">B.8<span style='color:windowtext;
text-decoration:none'>       </span>File_Settings<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>44</span></a></p>

<p class=MsoToc8><a href="#_Toc183532015">B.9<span style='color:windowtext;
text-decoration:none'>       </span>Jres_processing<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>44</span></a></p>

<p class=MsoToc8><a href="#_Toc183532016">B.10<span style='color:windowtext;
text-decoration:none'>     </span>Processing_std<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>44</span></a></p>

<p class=MsoToc8><a href="#_Toc183532017">B.11<span style='color:windowtext;
text-decoration:none'>     </span>Processing2d_std<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>44</span></a></p>

<p class=MsoToc8><a href="#_Toc183532018">B.12<span style='color:windowtext;
text-decoration:none'>     </span>Processing_autophase<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>45</span></a></p>

<p class=MsoToc8><a href="#_Toc183532019">B.13<span style='color:windowtext;
text-decoration:none'>     </span>Processing_filter_autophase<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>45</span></a></p>

<p class=MsoToc8><a href="#_Toc183532020">B.14<span style='color:windowtext;
text-decoration:none'>     </span>ProcessingBW<span style='color:windowtext;
display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>45</span></a></p>

<p class=MsoToc7><a href="#_Toc183532021">Appendix C<span style='color:windowtext;
text-decoration:none'>    </span>Procedures to change pulse program values<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>46</span></a></p>

<p class=MsoToc7><a href="#_Toc183532022">Appendix D<span style='color:windowtext;
text-decoration:none'>    </span>Acquisition Explained<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>46</span></a></p>

<p class=MsoToc7><a href="#_Toc183532023">Appendix E<span style='color:windowtext;
text-decoration:none'>    </span>Using Tables<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>47</span></a></p>

<p class=MsoToc7><a href="#_Toc183532024">Appendix F<span style='color:windowtext;
text-decoration:none'>    </span>Programming multi-X spectrometers<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>49</span></a></p>

<p class=MsoToc7><a href="#_Toc183532025">Appendix G<span style='color:windowtext;
text-decoration:none'>    </span>The pulse program event-table format<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>50</span></a></p>

<p class=MsoToc7><a href="#_Toc183532026">Appendix H<span style='color:windowtext;
text-decoration:none'>    </span>Repetition or inter-experiment time?<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></p>

<p class=MsoToc7><a href="#_Toc183532027">Appendix I<span style='color:windowtext;
text-decoration:none'>    </span>Spectrometer factory parameters<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>53</span></a></p>

<p class=MsoToc7><a href="#_Toc183532028">Appendix J<span style='color:windowtext;
text-decoration:none'>    </span>The SpinsolveExpert classes<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>55</span></a></p>

<p class=MsoToc7><a href="#_Toc183532029">Appendix K<span style='color:windowtext;
text-decoration:none'>    </span>Pulse program limits<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>56</span></a></p>

<p class=MsoToc7><a href="#_Toc183532030">Appendix L<span style='color:windowtext;
text-decoration:none'>    </span>Exporting to MNova<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>56</span></a></p>

<p class=MsoToc7><a href="#_Toc183532031">Appendix M<span style='color:windowtext;
text-decoration:none'>    </span>An introduction to Prospa programming<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>57</span></a></p>

<p class=MsoToc8><a href="#_Toc183532032">M.1<span style='color:windowtext;
text-decoration:none'>      </span>Data types<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>58</span></a></p>

<p class=MsoToc8><a href="#_Toc183532033">M.2<span style='color:windowtext;
text-decoration:none'>      </span>Variables<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>58</span></a></p>

<p class=MsoToc8><a href="#_Toc183532034">M.3<span style='color:windowtext;
text-decoration:none'>      </span>Control statements<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>59</span></a></p>

<p class=MsoToc8><a href="#_Toc183532035">M.4<span style='color:windowtext;
text-decoration:none'>      </span>Procedures<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>59</span></a></p>

<p class=MsoToc8><a href="#_Toc183532036">M.5<span style='color:windowtext;
text-decoration:none'>      </span>Commands<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>60</span></a></p>

<p class=MsoToc8><a href="#_Toc183532037">M.6<span style='color:windowtext;
text-decoration:none'>      </span>Debugging<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>61</span></a></p>

<p class=MsoToc8><a href="#_Toc183532038">M.7<span style='color:windowtext;
text-decoration:none'>      </span>Expressions<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>61</span></a></p>

<p class=MsoToc8><a href="#_Toc183532039">M.8<span style='color:windowtext;
text-decoration:none'>      </span>Matrices and vectors<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>61</span></a></p>

<p class=MsoToc8><a href="#_Toc183532040">M.9<span style='color:windowtext;
text-decoration:none'>      </span>User interface objects<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>62</span></a></p>

<p class=MsoToc8><a href="#_Toc183532041">M.10<span style='color:windowtext;
text-decoration:none'>      </span>Using the Prospa text editor<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>63</span></a></p>

<p class=MsoToc8><a href="#_Toc183532042">M.11<span style='color:windowtext;
text-decoration:none'>      </span>Additional help<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>63</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569296"></a><a
name="_Toc183531979">1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Introduction</a></h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This manual will help you to
understand and write pulse programs for the SpinsolveExpert application.  This
version targets version 2.02 which can drive either legacy DSP based Spinsolves
or those with the newer FX3 processors. The software interface is the same for
both systems however there are some subtle differences which may be important.
This documentation is for FX3 based systems.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The NMR pulse program controls a
series of electronic modules in the spectrometer in such a way as to generate
the desired NMR signal.  At a minimum, this means producing radio frequency
(RF) pulses of a specific amplitude, phase, frequency and duration at precise
times, and then after a certain delay the NMR signal is captured and returned
to the computer for processing and display. In addition, there may be control
of digital (TTL) levels and magnetic field gradients or shims. If good quality
data is to be collected, all of these functions must be applied at very
specific times, with high precision and stability.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The Spinsolve spectrometers during
and since 2023 use a FX3 CPU from Cypress to provide an interface between the
controlling PC and the spectrometer pulse sequencer which resides on an FPGA
(field programmable gate array) in the transceiver module. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal>The action of the pulse sequence is quite simple:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>Perform
an action</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>Wait
a certain time</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>Perform
next action</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>Wait
a certain time</span></p>

<p class=MsoNormal>…</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The high-level language used to
represent this sequence is called the <i>pulse program</i>. A simple example is
the SpinEcho experiment</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal><span lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>pulse(a90,
p1, d90)</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>delay(d1)</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>pulse(a180,
p2, d180)</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>delay(d2)</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>acquire('overwrite',
nrPnts)</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>Here you can see
commands for generating RF pulses, adding a delay and acquiring the data. The
parameters such as a90, d90, d1 and d2 etc must all be calculated independently
of the sequence to function as expected. </span>Much of the complexity of
coding a sequence correctly comes from determining these parameter values.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The code for translating the high-level
language used for pulse programming down to the machine code require by the
FPGA is stored in the file called fx3PPRun.dll (a dynamic linked library),
which is stored in the Expert/Prospa DLLs folder. The DLL includes translation
information for some 50 commands used for controlling the spectrometer. However,
of these, only a handful are commonly used. These are:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>acquire ..  collect NMR data</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>delay ....  wait a certain
number of microseconds.</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>pulse ....  generate an RF
pulse (or pulses) of specific amplitude, phase, duration and optionally frequency.</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>loop .....  repeat a section
of code a number of times.</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>endloop ..  define the end
of the looped region</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>shim16 ...  set the current
in one of the spectrometer shims.</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>txon .....  switch on the RF</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-70.9pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>txoff ....  switch off the
RF</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>A more comprehensive list may be
found in Appendix A. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>All pulse programs must be
surrounded by two other commands initpp and endpp</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>initpp</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>…</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>endpp</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>You can see more complete information about each command by
typing: </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&gt; help command_name</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>at the command line (CLI) prompt
or by pressing F1 when the insertion point is on the command name (this is
valid for all Prospa commands).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>When a pulse program is generated
on the PC, each of these commands will produce a block of <i>event table code</i>
which will be stitched together by the endpp command. The initpp command has an
argument which specifies some additional parameters required for the pulse
sequence generation (such as the default NMR frequencies and the digital filter
parameters).</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The event table is a list of
events or commands which will be executed on the spectrometer at specific
times. The format of each command is:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>event_duration, event_command,
event_parameters</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that we specify a duration
for each event rather than a specific time. This more closely matches the way
the pulse program is defined at a higher level and makes it easier to insert
new events without changing all the other times. Some pulse program commands
such as <i>delay</i> result in a single event, while others such as <i>pulse</i>
produce several.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that the event parameters
are stored with the event command rather than separately as was the case with
the older DSP based spectrometers.  </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>We will not be concerned here
about the details of the event table but rather how to construct the
higher-level pulse programming language. For those interested in the format of
the table (sometimes useful for debugging problems) please see <span
style='color:#C00000'>Appendix XX</span>.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The parameters for each pulse program command can be of two
kinds:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraph style='text-align:justify;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Fixed – this means the command will always use this parameter
value e.g. </p>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-left:54.0pt;text-align:justify;text-indent:
18.0pt'>pulse(1, 16383, 0, 10). </p>

<p class=MsoNormal style='margin-left:54.0pt;text-align:justify;text-indent:
18.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt;text-align:justify'>This will
produce a full power pulse on channel 1 with phase 0 for 10 µs using the
currently defined transmitter frequency. In this case you may need to know the
conversion algorithm for the argument value to convert from user to digital
units.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraph style='text-align:justify;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Variable – in this case the parameters are variable names which
will later be given the desired values e.g. pulse(1, a1, p1, d1). The names of
these variables are important – the first letter corresponds to the type of the
parameter according to this table</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-size:10.0pt;
font-family:"Courier New"'>aXXX ... An RF pulse amplitude in dB.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-size:10.0pt;
font-family:"Courier New"'>pNNN ... A phase in degrees/90</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-size:10.0pt;
font-family:"Courier New"'>dXXX ... A delay in microseconds</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-size:10.0pt;
font-family:"Courier New"'>fXXX ... A frequency in MHz.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-size:10.0pt;
font-family:"Courier New"'>nXXX ... An integer number</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-size:10.0pt;
font-family:"Courier New"'>tXXX ... A table of numbers</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:35.45pt;text-align:justify;text-indent:
.55pt'>Here XXX can be any valid Prospa variable name or an integer and NNN is
an integer starting from 1. The phase numbers should be sequential (i.e. p1,
p2, p3).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The use of special first
characters means the system automatically knows how to convert from user units
(e.g. dB for RF amplitude) to system units (in this case a 14 bit integer).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Before a pulse program can be
run, the compiled event table with parameters is sent to the spectrometer and
stored in the FPGA memory.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569297"></a><a
name="_Toc183531980">2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>File organisation</a></h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Experiments are typically grouped
together, first based on the nucleus and then on the experiment name. Several
files are required to run an experiment on the Spectrometer. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=457
height=261 src="Pulse%20Programming%20Guide%20(FX3)_files/image001.png"></p>

<p class=MsoNormal style='text-align:justify'>All of these files are stored in
an experiment folder – ‘Proton’ in this case. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Each of these files has a
particular purpose (for other experiments the name ‘Proton’ will be replaced by
the experiment name):</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:120.5pt;text-align:justify;text-indent:
-120.5pt'>Proton.mac .................   the experiment control macro. This
contains the code to start the experiment, collect and display the data and it also
includes loops to accumulate scans or change parameters if it is a
multidimensional experiment.</p>

<p class=MsoNormal style='margin-left:120.5pt;text-indent:-120.5pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:120.5pt;text-align:justify;text-indent:
-120.5pt'>Proton_interface.mac .. this defines the experiment user-interface as
it will appear in the SpinsolveExpert application. It defines which parameters
are visible, how the plot layout is organised and what post processing options
are available. Part of this is automatically generated.</p>

<p class=MsoNormal style='margin-left:120.5pt;text-indent:-120.5pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:120.5pt;text-align:justify;text-indent:
-120.5pt'>Proton_pp.mac ...........   this defines the pulse program and
parameters which are visible to the end user. It includes a table which defines
the relationship between the user parameters and pulse program parameters. It
also defines the phase cycling matrix for the experiment. This macro is only
executed during the compilation phase.</p>

<p class=MsoNormal style='margin-left:120.5pt;text-indent:-120.5pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:120.5pt;text-align:justify;text-indent:
-120.5pt'>Proton.asm .................   this file is only used by DSP based
spectrometers and is ignored by the FX3 system.</p>

<p class=MsoNormal style='margin-left:120.5pt;text-indent:-120.5pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:120.5pt;text-align:justify;text-indent:
-120.5pt'>Proton.p ......................   this file is only used by DSP based
spectrometers and is ignored by the FX3 system.</p>

<p class=MsoNormal style='margin-left:120.5pt;text-indent:-120.5pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:120.5pt;text-align:justify;text-indent:
-120.5pt'>ProtonDefault.par ........  this contains most of the parameters used
in the experiment, with sensible values which should allow the experiment to
run ‘out of the box’. Notice that some the parameters here such as B1
frequency, pulse lengths and powers, so called common or factory parameters,
may be overwritten after the file is loaded into Expert since they depend on
the particular Spectrometer you are using. This latter information is read from
a FLASH memory block stored on the spectrometer FX3 flash memory.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Other files or folders which may be present</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>Proton_importStdData.mac
..... this file is used to import data collected using the Magritek standard
software. It includes code to add missing parameters, transform and display the
data. This will add a small button to the dividers in the parameter list.</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>ProtonParHelp.mac
……………….  A help file for the parameter list which will be displayed in the
Expert CLI. <span style='color:#C00000'>To activate this</span>, you need to
set the flag self-showParHelp = 1 in the init procedure of the file
seParam.mac.</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>parameterVisibility.mac
…………  Defines which parameters will be displayed if the option ‘Show user
defined parameter entries’ is selected from the Experiment menu.</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>MNova
…………………………………..  A folder containing information for importing an Expert data
set into MNova. Apart from the logo, all files should have the same basename;
e.g. Proton.qs, Proton.mnova, Proton.mnp. Please refer to the MNova <span
style='color:#C00000'>section xxx </span>for more details.</p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-155.95pt'>&nbsp;</p>

<h1 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569298"></a><a
name="_Toc183531981">3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The Proton experiment examined</a></h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>To understand how experiment are
written and executed we will now look at the most basic experiment, ‘Proton’,
in more detail.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>To view the various experiment
files, select the experiment from the appropriate menu (e.g. 1H) holding down
the shift key at the same time. Alternatively, if the experiment is visible in
the history or batch lists press the enter key or select the option ‘Edit
current pulse program’ from the history list contextual menu. Finally, you can
also access the pulse program editor from the options in the ‘Experiment’
menu.  Either with the option ‘Edit current protocol (Ctrl-Shift-P), or if you
choose the option ‘Open pulse program editor’ then it will open with a blank
interface. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=457
height=226 id="Picture 3"
src="Pulse%20Programming%20Guide%20(FX3)_files/image002.png"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Then you can select the pulse
program to load from the File-&gt;Open Pulse Program menu option (Ctrl+O).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=467
height=366 id="Picture 27"
src="Pulse%20Programming%20Guide%20(FX3)_files/image003.png"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>With the Proton folder selected,
press the OK button or press Enter. By default, this will open the Experiment
control macro ‘Proton.mac’.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=602
height=397 src="Pulse%20Programming%20Guide%20(FX3)_files/image004.jpg"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This method is useful if the
experiment will not load correctly, perhaps due to a bug in a file, when
selecting from the menu.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The other important macros
associated with the experiment are accessible from the different tabs above the
editor. The name of the currently displayed file is visible in the title bar.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Two important file locations are
given; the folder the pulse program files are in (Pulse program base name) and
the parent directory (Output directory).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=549
height=115 src="Pulse%20Programming%20Guide%20(FX3)_files/image005.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The Lock mode check box is used
when compiling lock associated pulse programs (which for most users will be
never), while the user interface (U.I.) version should be set to 5.</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569299"></a><a
name="_Toc183531982">3.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The Pulse Program Macro</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>We will start by looking at the pulse-program macro. Click
on the pulse program tab:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=601
height=547 src="Pulse%20Programming%20Guide%20(FX3)_files/image006.jpg"
alt="A screenshot of a computer program&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This macro contains the procedure
<i>pulse</i>_<i>program</i>. It has three arguments, ‘dir’ which a data
structure containing important parameters for initialising the sequence (the
name is a hangover from the DSP based system which passed a directory to the
initpp command), and ‘mode’ which is the particular pulsing mode. The third
parameter ‘pars’ is the list of pulse program parameters. The ‘mode’ argument will
always be ‘1’, standing for channel 1 (the proton channel). ‘mode’ is a
carry-over from the Kea spectrometer which could have internal or external RF
amplifiers. For Spinsolve applications you won’t need to use ‘mode’ and you should
explicitly specify which channel you wish to access. However, for backward
compatibility this line should not be modified.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The procedure is broken into
several parts; the interface description, the relationships list and optional
group interface, the variables list, the pulse program and the phase cycling
matrix. We will look at each of these in turn.</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569300"></a><a
name="_Toc183531983">3.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=Heading2Char>The interface description</span></a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The interface is described by a
Prospa 2D list<a href="#_ftn1" name="_ftnref1" title=""><span
class=MsoFootnoteReference><span class=MsoFootnoteReference><span
style='font-size:12.0pt;font-family:"Calibri",sans-serif'>[1]</span></span></span></a>,
each row of which describes one user interface element and label. Note that the
last symbol on each row (except in the very last row) must be a semicolon. As
an example, the first two rows in Proton are shown below:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>  interface = [</span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;nucleus&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,    </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Nucleus&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,              </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;tb&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,    </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;readonly_string&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>               </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;b1Freq1H&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,   </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;B1 Frequency
(MHz)&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,   </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;tb&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,    </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;freq&quot;</span><span style='font-size:8.0pt;font-family:
"Courier New";color:black'>;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>These define the nucleus and the
B1 NMR frequency for protons. These generate the first two entries in the
Expert Proton parameters user interface.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=299
height=86 id="Picture 9"
src="Pulse%20Programming%20Guide%20(FX3)_files/image007.png"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>For each parameter, the interface
list entries are; variable name, interface label, type of user interface
element (or control) and some special information about the entered data (data
type). The abbreviations in column 3 are defined below. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>tb ......  a <b>t</b>ext
entry (<b>b</b>ox) field</span></p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>tm ......  a <b>t</b>ext <b>m</b>enu
(a text entry field with a pull down menu)</span></p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>cb ......  a <b>c</b>heck <b>b</b>ox</span></p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>rb ......  <b>r</b>adio <b>b</b>uttons
</span></p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>bt ......  a standard <b>b</b>u<b>t</b>ton</span></p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>dv ......  a line with a label
to <b>d</b>i<b>v</b>ide controls into groups</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that 3 letter symbols are
sometimes used, but they are only relevant in V3 interface (e.g. ‘w’ makes the
control wider, however all Expert text entry fields are already wide). However
in some cases you can append ‘_wide’ to the tb or tm to make and extra wide
interface (see ArrayExperiment in scripts menu)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The data type field can take a number of different
parameters and formats:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>array  ..........  <span
style='color:#C00000'>the input should be a two-element array e.g [2,10] </span>  </span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>double  .........  a general
double precision floating point number.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>float ...........  a general
single precision floating point number.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>freq ............  we expect
the entry to be a frequency in MHz. This makes it double precision and it must
fall within a certain range of values as define in the Spinsolve preferences
file (5-110 MHz).</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>integer .........  a general
positive integer number [1 ... 1e8].</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>ldelay ..........  a long
delay. For use with the wait command. This can range from 2 µs</span><span
style='font-size:9.0pt;font-family:"Courier New"'> </span><span
style='font-size:10.0pt;font-family:"Courier New"'>to 167 seconds. Units
default to microseconds.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>ldelayms ........  a long
delay<a name="_Ref25936464"></a><a href="#_ftn2" name="_ftnref2" title=""><span
class=MsoFootnoteReference><span class=MsoFootnoteReference><span
style='font-size:10.0pt;font-family:"Courier New"'>[2]</span></span></span></a>.
For use with the wait command. This can range from 2 µs to 167 seconds. Units
default to milliseconds.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>other ...........  the same
as float.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>pulseamp ........  a pulse
amplitude in dB. This number can range from -85 (no power) to 0 (maximum
power). Note that this is a logarithmic scale with a step size of 6 dB; very closely
corresponding to twice the amplitude or quadruple the power.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>pulselength .....  a pulse
length in µs. This can range from 0.5 to 1000 µs.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>readonly_string .  a string
which cannot be changed by the end user.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>reptime .........  a
repetition time or inter-experiment time in milliseconds. This cannot be less
than 1 ms.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>sdelay ..........  a short
delay</span><span
class=MsoFootnoteReference>2</span><span style='font-size:10.0pt;font-family:
"Courier New"'> – for use with the delay command. This can range from 2 µs to
327.67 ms. Units default to microseconds.</span></p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-4.0cm'><span
style='font-size:10.0pt;font-family:"Courier New"'>string ..........  a text
string.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Some special global values may be
used to populate some menus:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>&quot;integer,$$gData-&gt;rxGainMenu$$&quot;</span> 
returns the receiver gain menu list.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>&quot;integer,$$gData-&gt;nrPntsMenu$$&quot;</span>
returns the number of points menu list.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>&quot;float,$$gData-&gt;dwellTimeMenu$$&quot;</span>
returns the allowable dwell-time menu list</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>If used in text-boxes, the
generic numeric types <span style='font-size:10.0pt;font-family:"Courier New"'>integer</span>,
<span style='font-size:10.0pt;font-family:"Courier New"'>float</span> and <span
style='font-size:10.0pt;font-family:"Courier New"'>double</span> can also have
an allowable range value by using a two element array e.g.<span
style='font-size:10.0pt;font-family:"Courier New"'> float, [1,100]</span> which
means only numbers between 1 and 100 inclusive are acceptable.  Alternatively,
if the control is a text menu, then the array is interpreted as the various
menu options e.g.<span style='font-size:10.0pt;font-family:"Courier New"'>
float, [1,2,3,4,5,6,7,8,9]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Some control types require additional information in the
data type field:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>checkboxes ..... the data
type should always be a string and the two options (unchecked and checked) are
separated by a comma e.g.</span> <span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;no,yes&quot;</span> </p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>radiobuttons ... the data
type should always be a string and the various options are separated by a comma
e.g. </span><span style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;18,opt1,opt2,opt3,Option1,Option2,
Option3&quot;</span><span style='font-size:10.0pt;font-family:"Courier New"'>.
This will generate 3 radio buttons with variables names </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>optX</span><span
style='font-size:10.0pt;font-family:"Courier New"'> and labels </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>OptionX</span><span
style='font-size:10.0pt;font-family:"Courier New"'>. The first number is the
vertical spacing in pixels between the buttons.</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>textmenus ...... if the
allowable menu options are strings then you should supply a Prospa list e.g.</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'> [\&quot;xy\&quot;,\&quot;yx\&quot;,\&quot;xz\&quot;,\&quot;zx\&quot;,\&quot;yz\&quot;,\&quot;zy\&quot;]</span><span
style='font-size:10.0pt;font-family:"Courier New"'>. Note that because the data
type is a string, the menu sub-strings must have their quotes escaped with a
backslash. As mentioned above numerical arrays can be supplied if the options
are all numbers.</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>buttons ....... the type in
this case is a string which contains the callback procedure name for that
button. e.g. </span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;zeroShims&quot;. </span><span style='font-size:10.0pt;
font-family:"Courier New"'>The callback procedure must in the Experiment-Control
macro.</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&nbsp;</span></p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc183531984"></a><a
name="_Toc32569301">3.3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The relationships </a>list</h2>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>As noted previously, the
variables used in the pulse program description must conform to strict naming
conventions. Also, they are typically not the same as the variables we wish to
expose to the end user. For this reason, we define a relationships list which expresses
each pulse program parameter in terms of the user interface parameters. In the
case of the Proton experiment these relationships are quite simple</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><img width=610 height=130
id="Picture 8" src="Pulse%20Programming%20Guide%20(FX3)_files/image008.jpg"></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>Note that the relationship list
is <a name="_Hlk155881244">expressed </a>as a list of strings, since these must
be stored for later evaluation.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Each entry in the list defines a
pulse program variable. Note that it can also define other variables which are
used throughout the software. In this case O1 is the offset frequency, totPnts the
total number of points collected (which for CPMG experiments may be more than
the nrPnts, the number of points collected per echo), and similarly the totTime
is the total acquisition time, which might be longer than the individual
acquisition time; acqTime (also the case for the CPMG). Please see below for a
list of global pulse program parameters and their meanings.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The<a name="_Hlk155881531">
relationships </a>list also shows an example of a procedure call to update a parameter,
in this case the acquisition delay so as to avoid first order phase
corrections. This procedure depends on several other parameters such as the
pulse length and dwelltime. Note that when calling a procedure from the
relationship list, we need to include the file name in addition to the
procedure name. i.e:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>file_name:procedure_name(arguments)</span></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This is because the relationship
list is evaluated in a number of different locations in the software and needs
to know where to find the procedure. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>If filenames include a hyphen,
then you should quote them to prevent this being interpreted as a numerical
operation e.g.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;acqShift =
\&quot;PGSTE-Li_pp:getAcqShift\&quot;(dwellTime)&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>As mentioned above some
parameters used here and in other relationships lists are defined or used elsewhere
in the Expert code. These include:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>acqTime ............  the ideal duration of the data acquisition
(dwellTime * nrPnts) in milliseconds.</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>dwellTime .......... the sampling interval in microseconds.</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>nrPnts ................ the number of points to collect during the
acquire command.</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>pgo .....................        the pulse gate overhead delay. This is
defined in the Spinsolve preferences dialog and defaults to 5 µs. It is the
time between the start of an RF pulse command and when the pulse actually
appears.</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>rxLat .................. receiver latency. A time shift required to
align the collected data with the ideal start of the sampling interval. (In
microseconds).</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>wvPPMOffsetX … the standard PPM frequency offset for the nucleus X.
(e.g. 4.74 for the water peak).</p>

<p class=MsoNormal style='margin-left:3.0cm;text-align:justify;text-indent:
-3.0cm'>x/y/zshim .......... the shim values found for the linear gradients.
These are updated after a shim experiment is performed. These are required when
crusher gradients are applied.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Other following parameters can always
be defined here and will be used elsewhere:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The following variables should be
defined in the user interface list. They are used for converting from Hz to PPM
when generating plot axes, for post processing and when exporting data to
MNova. Note that some of these may be present in parameter groups and need not
be additionally added (e.g. bandwidth and bandwidthPPM). </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>Nucleus …………..… the name of the nucleus e.g. 1H or 13C. For 2D
experiments this should have two parts f2-f1 e.g. 13C-1H. </p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>b1FreqX …………….  The frequencies off all nuclei targeted in the
experiment. X is the nucleus e.g. 1H, 13C etc. </p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>centerFreqPPM …  the offset in PPM which defines the centre frequency
of a 1D spectrum. This value will be added to the appropriate b1Freq value.</p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>centerFreqXPPM .  when multiple centre frequencies are defined they
should use this format, where X is the nucleus e.g. 1H, 13 C etc.</p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>offFreqX ……………  The offset of the transmit frequency in Hz for
nucleus X.</p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>bandwidth …….....  The bandwidth of the data acquisition (in kHz)
Equal to 1000/dwellTime. </p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>bandwidth2 ….…..  The bandwidth of the second dimension in a 2D
experiment (in kHz). (Actually f1!)</p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>bandwidthPPM .... the bandwidth in PPM (as an alternative to kHz.</p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>bandwidthXPPM .  The bandwidth in the X (f1/f2) dimension
(alternative to kHz variables)</p>

<p class=MsoNormal style='margin-left:92.15pt;text-align:justify;text-indent:
-92.15pt'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The following items should always
be included in the relationships list. They define the operating frequencies of
the transmit and receive channels as well as the total acquisition duration and
size. Older versions of pulse programs used the b1FreqX and O1 parameters for
this purpose, but these options should now be avoided as their interpretation
is a bit ambiguous when multiple nuclei are targeted.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-left:70.9pt;text-align:justify;text-indent:
-70.9pt'>freqCh1 .......   the transmit frequency of channel 1 – this is the
proton and fluorine channel. Units: MHz.</p>

<p class=MsoNormal style='margin-left:70.9pt;text-align:justify;text-indent:
-70.9pt'>freqCh2 ……..   the transmit frequency of channel 2 – this is the X
channel. If this is not defined it will default to freqCh1.  Units: MHz.</p>

<p class=MsoNormal style='margin-left:70.9pt;text-align:justify;text-indent:
-70.9pt'>freqRx ………..  the receive frequency. If not defined this will default
to freqCh1.  Units: MHz. (Note that this value should not be multiplied by 10
as required in some other places).</p>

<p class=MsoNormal style='margin-left:70.9pt;text-align:justify;text-indent:
-70.9pt'>totTime …….    The total duration of the data collection. Normally
equal to acqTime, but some experiments such as CPMG collect data in blocks
which will result in longer times (e.g. totTime = acqTime*nrEchoes).</p>

<p class=MsoNormal style='margin-left:70.9pt;text-align:justify;text-indent:
-70.9pt'>totPnts ………   The total number of data points collected. Normally
equal to nrPnts  but some experiments such as CPMG collect data in blocks which
will result in longer times (e.g. totPnts = nrPnts*nrEchoes).</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<h2 style='margin-left:0cm;text-align:justify;text-indent:0cm'><a
name="_Toc183531985">3.4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Understanding the various frequencies defined in an Expert</a> </h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>There are a number of frequencies define in the previous
parameter list and it is important to understand the meaning of these to enable
effective design of experiment.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The frequencies b1FreqX defined
for each nucleus are calculated during the lock and calibrate experiment in the
following way. First the resonant frequency of a significant proton peak is
found e.g. the water peak at 4.74 ppm. This is stored in the parameter b1Freq1H
(in MHz). From this frequency we determine the frequency at 0 ppm. This becomes
b1Freq1HZero. Then for all other supported nuclei we calculate b1FreqX
according to the formula:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>b1FreqX = b1Freq1HZero * gyroX/gyro1H * (1 + ppmOffsetX/1e6)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Where gyroX is the resonant
frequency of nucleus X if gyro1H = 100 MHz. So b1FreqX is the resonant
frequency of nucleus X at a particular offset ppmOffsetX. This parameter is
globally accessible with the variable wvPPMOffsetX.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>In a typical experiment we define
the transmit and recieve frequency to be in the centre of the spectrum. In this
case we set:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>offFreqX = (centerFreqXPPM – wvPPMOffsetX)*b1FreqX  </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>this is the offset of the centre
of the spectrum from the reference peak used for calibrating this nucleus in
Hertz. From this we can define the transmitter frequency in MHz for channel A
in MHz:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>freqChA = b1FreqX + offset/1e6</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The channel number ‘A’ here can
be 1 or 2 and this depends on whether X = 1H/19F (channel 1) or some other
nucleus (channel 2). In most cases the receive frequency will be the same:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>freqRx = freqChA.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569302"></a><a
name="_Toc183531986">3.5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The group list</a></h2>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>It is possible to define all the
graphical user elements in the interface list and that is the case with the
Proton sequence. However, if you wish to minimise the number of elements in the
list you can define a ‘groups’ list. These are predefined groups of controls
which will be included with a single name. e.g. the Proton interface is
included with the following list (currently commented out):</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   groups = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Pulse_sequence&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Progress&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Acquisition&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>             </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Processing_Std&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Display_Std&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;File_Settings&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Here the first entry <a
name="_Hlk155881872">includes </a>those items defined in the interface list.
The name for the group list in older versions of Expert was ‘tabs’ and refers
to the legacy interface (V3) which grouped controls into tabs. In the case of
the newer Expert interface the controls groups are separated by dividers (dv)
e.g </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>               </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,   </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Acquisition&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;dv&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that the divider control has
no associated variable or data type. It produces the following result in the
user interface:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=250
height=72 id="Picture 10"
src="Pulse%20Programming%20Guide%20(FX3)_files/image009.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal>However, an option in the Spinsolve preference (Display
group help buttons) allows a help button to be added to the divider.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=248
height=74 src="Pulse%20Programming%20Guide%20(FX3)_files/image010.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Pressing the small button on the left side of the divder
will print a description of the controls in this group to the command line
interface.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Control groups are defined in the following folder:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>$appdir$\\Macros\\UCS-PP\\Tabs\\AlternateInterface</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>For example, the Display_Std interface macro looks like this:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(interface_description)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>  interface = [</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;usePPMScale&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Use ppm
scale?&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;cb&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>, </span><span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;string&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>, </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;no,yes&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;dispRangeMinPPM&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Minimum ppm
value&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;tb&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>, </span><span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;float&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>, </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;[-2000,2000]&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;dispRangeMaxPPM&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Maximum ppm
value&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;tb&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>, </span><span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;float&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>, </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;[-2000,2000]&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;dispRange&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Display
range (Hz)&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;tb&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>, </span><span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;float&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>, </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;[0,2e6]&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(interface,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;Display&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that currently, control
group interfaces use 1D lists. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>For a description of the supplied
group lists please see Appendix B. Of course, you can also add your own groups
using the supplied ones as examples.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If you are not going to use groups, then you don’t need to
include this list, but be sure to return list(0) in this case as the first
argument in the procedures endproc command. (See Proton experiment for an
example).</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569303"></a><a
name="_Toc183531987">3.6<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The variable list</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This is a list of the pulse
program variables that you wish to modify during the experiment. For example,
if you are performing an experiment where the RF pulse amplitude is varied you
would include the name of the amplitude variable, e.g.  in the Proton
experiment this might be <span style='font-size:10.0pt;font-family:"Courier New"'>a90Amp</span>.
In this case you would write:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   variables = [</span><span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;a90Amp&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If there are no variables to modify then make a single empty
element i.e.  <span style='font-size:10.0pt;font-family:"Courier New";
color:black'>[</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>]</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569304"></a><a
name="_Toc183531988">3.7<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The pulse program</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This is the core of this file. These commands describe the
pulse program which will be run on the spectrometer.  They must be surrounded
by the initpp and endpp commands.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:#AA0000'># Pulse sequence</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:8.0pt;
font-family:"Courier New";color:#780078'>initpp</span><span style='font-size:
8.0pt;font-family:"Courier New";color:black'>(dir)                      </span><span
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Initialise
the spectrometer </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
8.0pt;font-family:"Courier New";color:#780078'>pulse</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>(1,a90Amp,p1,d90Dur)       
</span><span style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'>#
RF pulse on channel 1 with phase p1 length d90Dur</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
8.0pt;font-family:"Courier New";color:#780078'>delay</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>(dAcqDelay)                
</span><span style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'>#
Pulse - acquire delay</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
8.0pt;font-family:"Courier New";color:#780078'>acquire</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;overwrite&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,nDataPnts)   </span><span
style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'># Acquire FID</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>   parList = </span><span
style='font-size:8.0pt;font-family:"Courier New";color:#780078'>endpp</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>()               
</span><span style='font-size:8.0pt;font-family:"Courier New";color:#AA0000'>#
Combine events and return ordered parameter list</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>These commands are rather special
– unlike other Prospa commands they don’t execute the action immediately, but as
mentioned above, build up the pulse sequence event table which will be executed
later by the spectrometer.  The endpp completes the event table assembly and
returns a list of variable names in the order they appear in the pulse
sequence. In this case</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>parList = [&quot;a90Amp&quot;, &quot;p1&quot;, &quot;d90Dur&quot;,
&quot;dAcqDelay&quot;, &quot;nDataPnts&quot;]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that inside the pulse
program macro, unquoted strings are treated as quoted strings (as they are in
the command line interface). This keeps the pulse sequence description cleaner
and easier to read. To prevent an external global variable from accidentally
replacing an unquoted pulse sequence argument, global and window variables are
not accessible from within this macro.</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569305"></a><a
name="_Toc183531989">3.8<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The phase cycle matrix</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Phase cycling is performed by
replacing the parameters p1, p2 ... with the phases stored in the phaseList 2D
matrix before each scan. Each row of the matrix corresponds to a different
phase variable, while the last row is the acquisition phase. Each column is
applied in a different scan. Column 1 for the first scan, column 2 for the
second and then wrapping around to the start when we run out of columns. The
numbers in the matrix represent multiples of 90 degrees. Fractional numbers can
be used for smaller increments. (e.g. 0.5 == 45 degrees)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>So, in the Proton example,</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   phaseList  = [0,1,2,3;   </span><span
style='font-size:10.0pt;font-family:"Courier New";color:#AA0000'># p1 : Pulse
phase</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>                 0,1,2,3]   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># pA : Acquire phase</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:#AA0000'>&nbsp;</span></p>

<p class=MsoNormal>the phase of the RF pulse steps from 0 to 90 to 180 to 270
as the scans are incremented. The acquisition phase is stepped in the same way.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If phase cycling is disabled in the user interface using the
‘Phase cycle’ check-box then the phases in the first column will be used in all
scans.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569306"></a><a
name="_Toc183531990">3.9<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The returned variables</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The various lists generated in the pulse program need to be
returned to the compiler. This is done with a comma delimited list of parameters
in the endproc command.</p>

<p class=MsoNormal> </p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(parList,group,interface,relationships,variables,dim,phaseList)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>In addition to the lists we have
just discussed, there is also a <b>dim</b> variable which is used in the legacy
interface (V3). This should be replaced by zero if it is not used, however it
must still be included for backward compatibility.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>If the group list is not used
then you can replace this variable with a null list i.e. list(0). So, for
example, in the Proton pulse sequence file, if the group list is not used, the
return parameters would look like this</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(parList,list(0),interface,relationships,variables,0,phaseList)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc183531991">3.10<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>How
parameters are initialised in the user interface</a> </h2>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>It is worth considering how the
user interface parameters are chosen when selecting an experiment from the main
menu. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Once the parameter interface list
has been created it is populated with the default parameter list – the file for
this is displayed in the <i>Default Parameters </i>tab.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Next the program will look for a
procedure called <i>getFactoryBasedParameters</i> in the Pulse program or the
Experiment control file. If it exists, then this procedure will be executed. Typically,
this procedure will contain a command to access the factory parameter settings
from the spectrometer (these are manually accessible using the ‘Open Spinsolve
parameter dialog’ option in the main File menu.) This command looks like this
in the proton experiment:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   specPar = gData-&gt;getXChannelParameters(&quot;1H&quot;)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>gData is the globally accessible
data class used by SpinsolveExpert. The argument to the procedure <i>getXChannelParameters</i>
should be the nucleus of interest. This is important since some spectrometers
support multiple nuclei and the parameters returned may depend on that
selection.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>specPar is then a structure returned with these parameters.
You can add a print statement to see the contents of this structure. Once
loaded this structure is made into local variables with the assignlist command
and then a new parameter list is formed using these values e.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   par = [</span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;rxGain        =
$modelPar-&gt;rxGain$&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>          </span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;pulseLength1H =
$PulseLength_1H$&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>          </span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;90Amplitude1H =
$PowerLevel_1H$&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>          </span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;b1Freq1H      = $Frequency_1H$&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>PulseLength_1H, PowerLevel_1H and
Frequency_1H are all spectrometer parameters, previously stored in specPar. (See
5.3Appendix I<span style='color:#C00000'> </span>for a list of these
variables). These are values which have been calibrated for your spectrometer
in the factory. The rxGain parameter will depend on the spectrometer frequency,
but this is more generic and is stored in the modelPar structure which is
returned from <i>ucsUtilities:getModelBasedParameters</i> procedure called
before the above lines.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that procedures or variables
in classes are accessed using the arrow (-&gt;) notation while procedures in
macros are access using the colon (:) notation.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The parameter list <i>par </i>is
then returned to the calling program and is used to update those parameters
listed on the left of this list.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>If the procedure <i>getFactoryBasedParameter</i>
is not present, then those values stored in the default parameter file will be
used instead (and these will usually be inappropriate for your spectrometer.)</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The final step is to replace the
frequencies <i>b1FreqX</i> with the values found or calculated during the last
lock and calibrate step. These are called <i>common</i> parameters.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:teal'>&nbsp;</span></p>

<p class=MsoNormal>Note that you can always manually change these updated
parameters before the experiment starts (except for the common parameters which
are read only).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569307"></a><a
name="_Toc183531992">4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Writing a new pulse program</a></h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>With this brief overview of the
Proton sequence and how parameters are initialised, we can move on to looking
how a new pulse program might be written. Because of the number and complexity
of the files involved, it doesn’t make sense to write an experiment from
scratch. Rather you should take an existing experiment and modify it. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Start by opening an experiment
which is similar to the one you want to write. For example, let’s write a pulse
duration-sweep experiment to determine the correct 90-degree pulse length. Since
the core experiment here is a simple Pulse and Collect, first open Proton in
the pulse sequence editor and compiler window. Then in the file menu, select
the option “New pulse program from existing file”. Select Proton from the
dialog window which appears and enter the name for the new experiment – in this
case ProtonDurationSweep2:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=523
height=127 src="Pulse%20Programming%20Guide%20(FX3)_files/image011.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that experiment names should
be unique as Expert will simply run the first one it finds with this name.
Since ProtonDurationSweep already exists in the Proton menu we have added a ‘2’
at the end. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Press OK. This will make a copy
of all the Proton files, but with the new name substituted. If you compile this
experiment (press the compile button) it will produce identical results to the
Proton experiment. The new experiment will now also be visible in the Proton
(1H) menu. It is recommended that you choose a different path for your own experiments
to prevent accidental deletion when updating the software. In this case you
will need to add that path to the main menu to access the experiment. This can
be done by dragging and dropping the <i>parent</i> folder of the experiment
onto the Expert main menu or by adding it using the ‘Experiments Menus’ option
in the SpinsolveExpert preferences dialog found in the Files menu. Note that
you must drag and drop the <i>parent</i> directory of ProtonDurationSweep2 onto
the menu bar not the ProtonDurationSweep2 directory itself otherwise you won’t
be able to access the experiment.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>With the experiment loaded into
the user interface it can now be modified.  Since we want to change the pulse
duration, we need to expose the pulse length in the pulse program. To do this,
modify the variable list to include the pulse length: </p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>variables = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;d90Dur&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal>Save the pulse program (Ctrl+S) and recompile (Press the
Compile button or Ctrl+Shift+C)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Before we modify the Experiment
Control Macro to sweep the pulse duration let’s have a look at the structure of
this file.</p>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569308"></a><a
name="_Toc183531993">5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The Experiment Control Macro</a></h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This macro contains several procedures:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The entry procedure (the actual name
will be the same as the experiment) ... this provides the option to add the
experiment to the user interface or if the shift key is pressed, to edit the
experiment. In addition to selecting the experiment from the menu it is also
possible to load an experiment into the user interface by typing the name of this
procedure at the command line in the form of a procedure call e.g. Proton().</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>backdoor ... this allows the
experiment to be run without using the legacy V3 user interface. Instead, a
list of parameters is passed. This is used by all Expert experiments.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>getseqpar ... get the sequence
parameters. This returns the important parameters from the pulse program macro,
which were collected and stored in this procedure when the pulse program was
compiled. This includes the relationships list, the variables list, the list of
pulse program parameters, the pulse program name, and the phase cycling list.</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>execpp ... executes the pulse
program. This contains the commands to send the event table with all relevant
parameters to the spectrometer. It instructs the spectrometer to be execute the
event table and then waits for it to finish. It then reads the collected data,
processing and displaying it. This process is then repeated for the desired
number of scans, phase cycling the RF pulses and accumulating the collected
data as specified in the phase list. When the specified number of scans has
completed the data are saved to the folder specified by the Experiment
base-path, date and time hierarchy and file comment. As a final step the
experimental data is packed into a structure and returned to the calling
program. This information is typically only used by some scripts.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>getPlotInfo ... specifies the
file names associated with the various plots in the user interface. This is
used for saving the data in each plot and also for reloading the last data set
when the experiment is reselected from the history list.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>expectedDuration ... this returns
the expected duration of the experiment in seconds. This needs to be calculated,
which is usually a simple task if a repetition time is specified – more
complicated if an interexperiment time is used. (See 5.3Appendix H).</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>saveProcPar ... saves the
processing parameters when the experiment is complete. This is useful if one
wants to reprocess the raw FID data in the same way at a later date.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>Once an experiment has been
selected from one of the experiment menus and the Run button is pressed, the
following actions will occur <i>before</i> the execpp procedure is called.</p>

<p class=MsoNormal style='margin-right:11.85pt;text-align:justify'>&nbsp;</p>

<p class=MsoListParagraphCxSpFirst style='margin-right:11.85pt;text-align:justify;
text-indent:-18.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>A check is made to see if the system is locked and if the temperature is
within acceptable limits. This does not prevent the experiment from running,
but updates the Status indicators.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The user interface is modified for Run mode. This means the required
plots are displayed and various controls are disabled to prevent unwanted user
interactions while the experiment is running.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>A separate thread is run to control the progress bar based on the value
returned by the expectedDuration procedure in the Experiment Control macro.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Another thread is started to execute the experiment. Runing the progress
bar update and experiment in separate thread allows the user interface view to
be modified and windows resized during the experiment as well as giving a
smoother update to the progress bar.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>In the experiment thread the experimental parameters are read from the
user interface and merged with spectrometer and common parameters. All user
interface parameters are checked for invalid values.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The backdoor procedure is then called. This calls an initialisation
procedure (initAndRunPP). Here the experiment data folder is created and an
acquisition parameter file acqu.par is written based on the chosen experimental
parameters.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The user-defined experimental and pulse sequence parameters are then
combined with fixed spectrometer parameters and system preferences to produce
the required low level list of pulse sequence parameters which will be passed
to the spectrometer processor. For example, this involves converting RF
amplitudes from dB to the 14-bit digital value required by the spectrometer’s
digital synthesiser.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The pulse program’s event table in binary form is sent to the
spectrometer via USB.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The execpp procedure in the Experiment Control macro is the run with the
pulse sequence parameter list as an argument (ppList) along with other lists.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:11.85pt;
margin-bottom:0cm;margin-left:18.0pt;margin-bottom:.0001pt;text-align:justify'>The
execpp procedure then performs the following functions:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:11.85pt;
margin-bottom:0cm;margin-left:18.0pt;margin-bottom:.0001pt;text-align:justify'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>It sends the experiment parameters to the spectrometer (which may change
from scan to scan).</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:11.85pt;text-align:
justify;text-indent:-18.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>It executes the pulse program, collecting and scaling the data.</p>

<p class=MsoListParagraphCxSpLast style='margin-right:11.85pt;text-align:justify;
text-indent:-18.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span> The data is then processed, displayed and saved.</p>

<p class=MsoNormal style='margin-right:11.85pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-right:11.85pt;text-align:justify'>Following
the execution of execpp the interface is enabled and restored to normal
operating mode (which allows menu activation and all plot interactions).</p>

<p class=MsoNormal style='margin-right:11.85pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-right:11.85pt;text-align:justify'>We will now
look at the function of execpp in more detail.</p>

<p class=MsoNormal style='margin-right:11.85pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569309"></a><a
name="_Toc183531994">5.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The execpp (execute pulse program) procedure arguments</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>If the pulse sequence code in the
Pulse Sequence macro defines the experiment, then the execpp procedure in the
Experiment Control macro controls it.  Let’s looks at the Proton experiment
macro.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>First note that you can jump to
different procedures in a macro by using the Procedures menu in the Pulse
program editor and compiler window (or any Prospa editor).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=172
height=159 id="Picture 15"
src="Pulse%20Programming%20Guide%20(FX3)_files/image012.png"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The first line of the procedure lists the passed arguments:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(execpp,guipar,ppList,pcList,pcIndex,varIndex)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>execpp is the procedure name, guipar is the list consisting
of all the parameters defined in the Proton parameter list plus all the
parameters in the relationships list defined in the pulse program macro.  Here
are some of them:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>guipar = {</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       90Amplitude1H = 0</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       a90Amp        = 90Amplitude1H</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       accumulate    = &quot;yes&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       acqTime       = 3276.8</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>      
b1Freq1H      = 61.9303168d</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       bandwidth     = 5</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>      
d90Dur        = pulseLength1H</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>      
...</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       yshim         = -721.995</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       zf            = 1</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>      
zshim         = -1753.47</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>    
}</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>It also includes a number of global variables such as
receiver calibrations and gyromagnetic ratios for the various nuclei, x,y, and
z shim values as well as other information which may be needed in the macro.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>You can list these (or other parameters) yourself by adding
the line</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>pr sortlist(guipar)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>to the execpp code. To see all locally define variables add
the line</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>pr
local</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>On the FX3 based spectrometer the
parameter ppList is not used an may be ignored, however it should be passed to
the various procedures in execpp to allow the experiment to function on a DSP based
spectrometer as well.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>pcList is the phase cycle list, but now scaled to be in
hardware relevant units (90 degrees == 16384)</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>   pcList = </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New"'>       0   16384   32768   49152</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>      
0   16384   32768   49152</span> </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>pcIndex is not used by FX3 spectrometers.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal>varIndex is the position of the variables to modified in the
pp_list parameter defined in the getseqpar procedure. This is not used in the
Proton experiment.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569310"></a><a
name="_Toc183531995">5.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The execpp procedure in detail</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Now we can break down the various
parts of the execpp procedure.  The first step is to extract all the guipar
list parameters and make them local variables. This is done with the assignlist
command:</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Make all gui parameters available</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:green'>assignlist</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(guipar)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>Next, we allocate space for the
collected data. totPnts is the number of complex points in the FID which, in
this case, is also the same as nrPnts,</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Allocate space for output data</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   sumData = </span><span style='font-size:10.0pt;font-family:
"Courier New";color:green'>cmatrix</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>(totPnts)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>We then determine the axes for the time (FID) and frequency
(Spectral) plots</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Calculate suitable time and
frequency axes</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   tAxis =
([0:1:totPnts-1]/totPnts)*totTime*1000 </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># ms</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   fAxis = [-totPnts*zf/2:totPnts*zf/2-1]/(totTime*zf)*1000 </span><span
style='font-size:10.0pt;font-family:"Courier New";color:#AA0000'># Hz</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:#AA0000'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>In addition to <span
style='font-size:10.0pt;font-family:"Courier New";color:black'>totPnts</span>
this also uses <span style='font-size:10.0pt;font-family:"Courier New";
color:black'>totTime</span> (== <span style='font-size:10.0pt;font-family:"Courier New";
color:black'>acqTime</span>) and the zero-fill parameter zf, defined in the
user interface. This last parameter was part of the guipar list.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>If the user wants to apply a time
domain apodization to improve SNR we extract this from the filters macro</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Time domain filter</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>if</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>(filter == </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;yes&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      flt = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>filters:get_filter</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(filterType,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;FTFid&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,tAxis/1e6)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>else</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      flt = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>matrix</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(totPnts)+1</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endif</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>&nbsp;</span></p>

<p class=MsoNormal>If not, then the filter is just a constant vector equal to
1.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>Next, we indicate that we want 2
plot regions, one for the FID and one for the Spectrum. This function returns
plot objects we can use for performing the plot.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Get plot regions</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(prt,prf) = </span><span style='font-size:10.0pt;font-family:"Courier New";
color:teal'>ucsPlot:getPlotReferences</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that these plot regions have
been defined in the User Interface macro, procedure plot_run_layout and were
initialised when the experiment was selected from the menu.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>To simplify the generation of
axes labels and scales which depend on the ppm/Hz setting and frequency
offsets, we call a procedure in the ucsPlot macro to calculate this for us.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Work out frequency axis scale, label
and range</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   (fAxisDisp,fAxisLabel,fRange) = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsPlot:generate1DFrequencyAxis</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(prf, fAxis,
guipar)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>The core elements of a simple
pulse and collect experiment are shown below. First we have the Scan loop:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Accumulate scans</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>for</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(scan = 0 </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>to</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'> nrScans-1)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>The next command combines several
steps – it checks the timing, sends the pulse program event table to the
spectrometer, executes the event table and returns the data. Be aware that some
of the comments and parameters refer to the DSP mode of operation which is
rather different.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>    </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Check timing, update the parameters,
run the sequence and return the data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      (data,pAcq,status) = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsRun:runSequence</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(guipar,ppList,pcList,pcIndex,scan)</span></p>

<p class=MsoNormal style='text-autospace:none'>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'>The collected data is
accumulated, with the acquisition phase cycle being applied.</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>    </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Accumlate the data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      sumData = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsRun:accumulate</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(accumulate,pAcq,sumData,data)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'>The accumulated data is zero
filled and then Fourier transformed:</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>    </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Process data</span></p>

<p class=MsoNormal style='margin-left:35.45pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(phasedTimeData,spectrum,ph0)
= </span><span style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsRun:transformData</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>zerofill</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(datacorr.*flt,zf*totPnts,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;end&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>),fAxis,guipar,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;fid&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'>And finally plotted</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'>    # Plot the data</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsPlot:graphTimeAndFreq</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(prt,prf,tAxis,datacorr,fAxisDisp,spectrum,scan,guipar,
</span><span style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Time
data&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;Spectral data&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>, </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;Time (ms)&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Amplitude
(\G(m)V)&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>, fAxisLabel,</span><span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;Amplitude&quot;</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'>And then we check to see if the
Complete button has been pressed during the experiment</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>    </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Check if complete button pressed</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:blue'>if</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(status == </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;finish&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>         scan = scan+1</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
10.0pt;font-family:"Courier New";color:blue'>exitfor</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:blue'>endif</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>next</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>(scan)</span></p>

<p class=MsoNormal style='text-align:justify'>See the experiment
ProtonLPShowDetails to see an expansion of the runSequence procedure.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The Proton experiment also
includes some commands to minimise first order phase shifts by setting the
acquisition delay carefully and modifying the first few data points to account
for the digital filters. These are not essential for operation and so for simplicity
will not be discussed here.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The next step is to save the data</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Save the data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:teal'>ucsFiles:savePlot</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(prt,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>:getPlotInfo</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt1&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>),guipar,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;noReport&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:teal'>ucsFiles:savePlot</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(prf,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>:getPlotInfo</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt2&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>),guipar,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;simpleReport&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:teal'>ucsFiles:saveMNovaData</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(prt,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,guipar,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;simpleReport&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This saves the FID and spectral
plots in a proprietary Prospa format so we can reload the data later, and also
in a more basic format ‘data.1d’ for use with the 3rd party application Mnova. Note
the references to the local procedure getPlotInfo which returns the filenames
for the FID and spectral files.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Finally, the processing parameters used are saved for future
reference in a proc.par file </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Save the processing parameters</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:teal'>:saveProcPar</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(guipar,ph0,fRange)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>and then the data is packed up
into a structure and returned to the calling procedure. Note the structure
naming here – this should be used for all 1D data sets. For 2D change <span
style='font-size:10.0pt;font-family:"Courier New";color:black'>result-&gt;tAxis</span>
to <span style='font-size:10.0pt;font-family:"Courier New";color:black'>result-&gt;tAxes</span>
and <span style='font-size:10.0pt;font-family:"Courier New";color:black'>result-&gt;fAxis</span>
to <span style='font-size:10.0pt;font-family:"Courier New";color:black'>result-&gt;fAxes</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Pack the data into a structure</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   result = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>struct</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   result-&gt;tAxis = tAxis</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   result-&gt;tData = sumData/scan</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   result-&gt;fAxis = fAxisDisp</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   result-&gt;fData = spectrum/scan</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   result-&gt;par   = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>struct</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(guipar)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   result-&gt;p0    = ph0</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Return result</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:green'>return</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(result)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<h2 style='margin-left:0cm;text-indent:0cm'><a name="_Toc32569311"></a><a
name="_Toc183531996">5.3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Modifying the execpp procedure to vary the pulse duration</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Now we have covered the basic
pulse and collect experiment we will consider how to incorporate changing the
pulse length parameter as discussed earlier in <i>Writing a new pulse program</i>.
There we included a non-empty variable parameter list in the pulse sequence
file:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:72.0pt'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>variables = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;d90Dur&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In the execpp macro this will appear in the varIndex
argument as an array with the single value 2</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:70.9pt'>varIndex = [2]</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This refers to parameter 2 in the parameter list pp_list
returned by the pulse program macro and saved in the getseqpar procedure. (Note
that the index is zero based).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   pp_list = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;a90Amp&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;p1&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;d90Dur&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;dAcqDelay&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;nDataPnts&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To use this parameter, we add an extra for-loop outside the
scan loop. We also add extra 2D storage for each spectrum recorded:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Calculate the pulse length matrix</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>minLength = pulseLength1H</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   maxLength =
minLength+nrLengthSteps*stepNr</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   pulseLengths = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>linspace</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(minLength,
maxLength, nrLengthSteps)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Storage for the fids and spectra</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   fid2d = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>cmatrix</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(totPnts,
nrLengthSteps)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   spectra = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>cmatrix</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(totPnts*zf,
nrLengthSteps)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Vary the pulse duration </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>for</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>(stepNr = 0 </span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'>to</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>
nrLengthSteps-1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'>   # Allocate space for output data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      sumData = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>cmatrix</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(totPnts)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'>   # Accumulate scans</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>      </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>for</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(scan = 0 </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>to</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'> nrScans-1)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>Note that since we have
introduced three new user variables; minLength, lengthStep and nrLengthSteps we
need them to the pulse sequence user interface as well:</p>

<p class=MsoNormal><span style='font-size:8.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>               </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;minPulseLength&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,  </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Min. pulse
length (µs)&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,    </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;tb&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,  </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;pulselength&quot;</span><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>               </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;lengthStep&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,      </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Pulse step
size (µs)&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,      </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;tb&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,  </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;pulselength&quot;</span><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>;</span></p>

<p class=MsoNormal><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>               </span><span style='font-size:8.0pt;font-family:
"Courier New";color:gray'>&quot;nrLengthSteps&quot;</span><span
style='font-size:8.0pt;font-family:"Courier New";color:black'>,   </span><span
style='font-size:8.0pt;font-family:"Courier New";color:gray'>&quot;Nr. of
length steps&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,       </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;tb&quot;</span><span style='font-size:8.0pt;font-family:"Courier New";
color:black'>,  </span><span style='font-size:8.0pt;font-family:"Courier New";
color:gray'>&quot;integer,[1,100]&quot;</span><span style='font-size:8.0pt;
font-family:"Courier New";color:black'>;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Don’t forget to recompile after
making changes to the *_pp.mac file.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The next step is to save each
collected spectrum into the 2D spectra matrix. This is done between the end of
the scan loop and the end of the pulse length loop.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:blue'>next</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(scan)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>     </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Save the FID and Spectrum</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      fid2d[~,stepNr] = sumData</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      spectra[~,stepNr] = spectrum</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>next</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(stepNr)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>The tilda symbol (~) means
replace a row. A colon (as in Matlab) can also be used. Note that the 2D matrix
index order in Prospa is column, row (x,y) not row, column as it is in other
languages. (We considered the x,y order for 2D matrix indexing or the x,y,z
order for 3D matrix indexing more logical than y,x, or y,x,z).</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>We also save the fids to allow
export to MNova for reprocessing there.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>To give some feedback to the user
we can plot the accumulated spectra into an additional plot. To do this we need
to add the extra plot pt3 in the User Interface macro:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(plot_run_layout)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   layout = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt1&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt2&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>; </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt3&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>endproc</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(layout)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(plot_load_layout)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   layout = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt3&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(layout)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>These define the layout of plots when running and reloading
experiments.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>We also need to add a reference to this third plot in the
execpp procedure by changing the number of plots from 2 to 3 and returning
another plot name <span style='font-size:10.0pt;font-family:"Courier New";
color:black'>prs</span>:</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   (prt,prf,prs) = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsPlot:getPlotReferences</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>We can then display the collected data as it is acquired:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
10.0pt;font-family:"Courier New";color:blue'>next</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(scan)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>     </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Save the FID and Spectrum</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      fid2d[~,stepNr] = sumData</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      spectra[~,stepNr] = spectrum</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>StackedPlot</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(prs,  </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>real</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(spectra),
stepNr, fRange, fAxisDisp, </span><span style='font-size:10.0pt;font-family:
"Courier New";color:gray'>&quot;yes&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>, pulseLengths,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;linear&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Frequency
(ppm)&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>, </span><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&quot;Pulse length (\G(m)s)&quot;</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>,</span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;Spectra for different pulse
lengths&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>next</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(stepNr)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The StackedPlot procedure combines a number of 1D FIDs
together in a single plot offsetting each one based on the step number. You can
enter this procedure to see its function using the Ctrl+Double click shortcut.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If the pulse sequence is now recompiled and a sensible pulse
length range added (2 to 21 µs in 1 µs steps), we gain the following result</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=544
height=226 id="Picture 29"
src="Pulse%20Programming%20Guide%20(FX3)_files/image013.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The first thing we notice is that
the amplitude of each spectrum is not changing. That is because we have not
changed the pulse length being sent to the Spectrometer. To do this we need to
modify the parameter before it is sent to the spectrometer. We do this with the
utility procedure ucsRun:setPPDelay:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Vary the pulse duration scans</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>for</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>(stepNr = 0 </span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'>to</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>
nrLengthSteps-1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Modify ppList with the new pulse
length</span></p>

<p class=MsoNormal style='margin-left:35.45pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>ppList = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsRun:setPPDelay</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(ppList,varIndex[0],pulseLengths[stepNr])</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Allocate space for output data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      sumData = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>cmatrix</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(totPnts)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#AA0000'># Accumulate scans</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>      </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>for</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(scan = 0 </span><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>to</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'> nrScans-1)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>If you look in the macro ucsRun you will find a number of
other conversion procedures which you need for updating different parameters.
(See appendix C for a list of these).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>After this change we see the amplitude changing nicely</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=543
height=225 id="Picture 28"
src="Pulse%20Programming%20Guide%20(FX3)_files/image014.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Just one more step is necessary – we need to save this data.
Modify the save commands to save the stacked plot and the raw FID data for
MNova analysis:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:teal'>ucsFiles:savePlot</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(prs,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>:getPlotInfo</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt3&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>),guipar,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;noReport&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>   </span><span style='font-size:10.0pt;font-family:"Courier New";
color:teal'>ucsFiles:saveMNovaData</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>(fid2d,</span><span style='font-size:
10.0pt;font-family:"Courier New";color:gray'>&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,guipar,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;simpleReport&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>and in the getPlotInfo procedure make sure to give this new
plot a file-name:</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   info = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pt3&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pulseDurationSweep.pt1&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>We can also add some post processing tools to the user
interface macro to change the stacked plot view , integrate the data and give
access to MNova.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(processing_controls)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   layout = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;buttonLabel
= \&quot;View\&quot;&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>,      </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;plotName = \&quot;pt3\&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;macroToRun
= \&quot;StackedPlotSetup()\&quot;&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>             </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;buttonLabel
= \&quot;Integ.\&quot;&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>,    </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;plotName = \&quot;pt3\&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;macroToRun
= \&quot;IntegrateRegions()\&quot;&quot;</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>             </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;buttonLabel
= \&quot;MNova\&quot;&quot;</span><span style='font-size:10.0pt;font-family:
"Courier New";color:black'>,     </span><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&quot;plotName = \&quot;pt3\&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;macroToRun
= \&quot;exportMNova2D(\\\&quot;pt3\\\&quot;)\&quot;&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(layout)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>The View option allows more informative stacked plot
displays:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=572
height=282 id="Picture 23"
src="Pulse%20Programming%20Guide%20(FX3)_files/image015.png"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>While the Integ option allows analysis of the peak
integrals:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=601
height=327 id="Picture 2"
src="Pulse%20Programming%20Guide%20(FX3)_files/image016.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><img width=601
height=338 id="Picture 25"
src="Pulse%20Programming%20Guide%20(FX3)_files/image017.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>An important step after writing and
testing a new pulse program is to manually update the default parameter file or
alternatively save the last run set of parameters to the default parameter
file. This option can be found in the main Files menu if this has been enabled
in the General page of the preferences (<i>Allow to overwrite defaults
parameter files</i>). This allows subsequent use of the experiment to have
sensible start values. It may require some editing afterwards to remove
spectrometer specific or unnecessary entries.  Be careful not to apply this
option to the standard experiments!</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To give more useful feedback as to the progress of the
running experiment the progress bar should be updated correctly. This requires the
addition of the expectedDuration procedure:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(expectedDuration, guipar)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:10.0pt;
font-family:"Courier New";color:green'>assignstruct</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(guipar)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   totScans = nrLengthSteps*nrScans +
useStartDelay  </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   duration = totScans*repTime/1000</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>(duration)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>This just calculates the expected number of scans.
useStartDelay is a variable equal to 1 or 0 which controls the addition off a
predelay before the experiment starts. This defaults to 0 when in the history
mode and 1 when in batch mode.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If you are using an inter-experiment delay rather than the
repetition time then this procedure becomes more complicated. In this case you
need to calculate the duration of the experiment and then add the
inter-experiment delay. This can be more difficult if the experiment duration
is varied as in a T1 experiment.  In this case you can call the function
GetPulseProgramDuration with the name of the protocol to return the duration
for the parameters defined in the relationships table. Then you can add the extra
times.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>   <span style='font-size:10.0pt;font-family:"Courier New";
color:black'>psTime = GetPulseProgramDuration(&quot;T1iet&quot;,1, guipar)*1000</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>See the experiment T1ie for an example of this.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>A completed ProtonDurationSweep experiment is included in
the Proton experiment folder for reference. (This version has been modified to
allow interactive integration).</p>

<br clear=all style='page-break-before:always'>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183531997">Appendix A<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Pulse program commands</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Here is a list and a short
description of all pulse program commands grouped according to the function
type. More details can be found by typing help and then the command name in the
command line interface e.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&gt; help pulse</p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183531998"><span lang=EN-GB>A.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Acquire NMR data</span></a></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.1.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Blocking acquire</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>This command
acquires data from the Proton or X-channel receiver and stores it in the spectrometer
memory. No other command can be run during this process.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>acquire</span><span
lang=EN-GB>( </span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>mode, points, [duration]</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>mode</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>is one of:</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-119.9pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>overwrite</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......... </span><span
lang=EN-GB>data is written to the beginning of memory.</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-119.9pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>append</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .............. </span><span
lang=EN-GB>data is appended to last data collected.</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-119.9pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>sum</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ................. </span><span
lang=EN-GB>the acquired data is summed with the previous data. Can also be
called <i>stack</i>.</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-119.9pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>integrate</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......... </span><span
lang=EN-GB>the acquired data is integrated and returned as single point then
appended to previously collected data.</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-119.9pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>integrateandscale
</span><span lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>. </span><span
lang=EN-GB>the acquired data is integrated after being scaled by a power of 2
to prevent overflow, then returned as a single point to be appended to the
previously collected data.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:177.2pt;text-indent:-105.75pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>points</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..........  </span><span
lang=EN-GB>the number of complex points collected (maximum approx.  170k). (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB>) For sum mode this is limited to 4 k complex points.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:177.2pt;text-indent:-105.75pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........ </span><span
lang=EN-GB>  is an optional short delay, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>dx</span><span
lang=EN-GB style='font-size:11.0pt;font-family:"Courier New";color:gray'>)</span><span
lang=EN-GB>, (1 </span><span lang=EN-GB style='font-size:11.0pt;font-family:
Symbol'>m</span><span lang=EN-GB>s to 327 ms), which is applied to the append,
sum and integrate modes. This is the total length of time between the start of
data acquisition and the next pulse sequence command.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.1.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Non-blocking acquire</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>This command
acquires data from the Proton or X-channel receiver in the background, storing
it on the transceiver board. It returns immediately so other commands can be
run.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>acquireon</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>points</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>This is
equivalent to the mode = overwrite. i.e. start acquiring and store at start of
memory.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>or</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>acquireon</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>mode,</span><span lang=EN-GB> </span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>points</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>mode</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>is one of:</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>overwrite</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...  </span><span
lang=EN-GB>data is written to the beginning of memory.</span><span lang=EN-GB
style='font-size:9.0pt;font-family:"Courier New"'>  </span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>append</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>data is appended to last data collected.</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>adc</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......... </span><span
lang=EN-GB>acquire data at maximum sample rate (100 MSPS) from the ADC without
applying a digital filter and write from the beginning of memory. Note total
acquisition time will be memory limited since DW = 0.01 </span><span
lang=EN-GB style='font-size:11.0pt;font-family:Symbol'>m</span><span
lang=EN-GB>s)</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>   </span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:35.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>points</span><span
lang=EN-GB>: the number of complex points collected (maximum 170k). (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:35.45pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>This command
reads in the acquired data obtained with acquireon according to the mode
setting, copying it to the DSP board memory.</span></p>

<p class=MsoNormal style='text-indent:35.45pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>acquireoff</span><span
lang=EN-GB>( </span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>mode, points</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>mode</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>is one of:</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>overwrite</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...  </span><span
lang=EN-GB>stop acquiring.</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>adc</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .........  </span><span
lang=EN-GB>stop acquiring.</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>pause</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......  </span><span
lang=EN-GB>pause acquisition. (See HSQC-HMBC expt for example)</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-84.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>finish</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>stop acquiring.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:35.45pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>points</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>the number of complex points to collect. (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:35.45pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB>Note that the
mode parameter is ignored on the fx3 and these parameters are really for the
DSP models, however they help explain what the acquireoff is doing and should
be included for DSP compatibility.</span></p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:35.45pt'><span lang=EN-GB>For more
details on acquisition timing see </span><span
lang=EN-GB>Appendix D</span><span lang=EN-GB> – acquisition explained.</span></p>

<p class=MsoNormal style='text-indent:35.45pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:35.45pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183531999"><span lang=EN-GB>A.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Clear the spectrometer data memory</span></a></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.45pt;text-align:justify'><span
lang=EN-GB>If the acquire command uses the sum mode (i.e. adding to existing
memory) this command ensures the memory is first zeroed. On FX3 spectrometers
an additional parameter is required and that is the number of summations that
are expected.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>cleardata(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>number_of_points,
number_of_summations</span><span lang=EN-GB style='font-size:10.0pt;font-family:
"Courier New";color:teal'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:8.0cm;text-indent:-141.15pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>number_of_points</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB style='color:black'>the number of points in data memory to clear (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB style='color:black'>)</span></p>

<p class=MsoNormal style='margin-left:8.0cm;text-indent:-141.15pt'><span
lang=EN-GB style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:8.0cm;text-indent:-141.15pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>number_of_summations
.</span><span lang=EN-GB>.  the number of times the acquire command will be
called (</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>nx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:49.65pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532000"><span lang=EN-GB>A.3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Delay for a specified time</span></a></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span
class=Heading3Char><span lang=EN-GB style='font-size:13.0pt'>A.3.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span
lang=EN-GB>Short delay</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>delay</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>duration</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......   </span><span
lang=EN-GB>is a short delay, (</span><span lang=EN-GB style='font-size:10.0pt;
font-family:"Courier New";color:gray'>dx</span><span lang=EN-GB>), (0.25 </span><span
lang=EN-GB style='font-size:11.0pt;font-family:Symbol'>m</span><span
lang=EN-GB>s to 42 s)</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-.55pt'><span
lang=EN-GB>Note that for compatibility with the DSP based spectrometers we use
the wait command for delays greater than 327 ms.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.3.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Long delay</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>This delay
provides a much larger range of values at the expense of more code in the pulse
program. The largest delay is for all practical purposes unlimited. </span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>wait</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>duration</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......   </span><span
lang=EN-GB>is a long delay, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>wx</span><span lang=EN-GB>), (&gt; 2 </span><span
lang=EN-GB style='font-size:11.0pt;font-family:Symbol'>m</span><span
lang=EN-GB>s)</span></p>

<p class=MsoNormal><b><span lang=EN-GB>&nbsp;</span></b></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532001"><span lang=EN-GB>A.4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Frequency modifications</span></a></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.4.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Set the receiver frequency</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>setrxfreq(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-69.75pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..... </span><span
lang=EN-GB style='color:black'>frequency to use (MHz) (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>fx</span><span
lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal><span lang=EN-GB style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB
style='color:black'>Note that the receive frequency supplied as an argument
should be multiplied by 10.</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.4.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Set the transmitter frequency</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:teal'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>settxfreq(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-69.75pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..... </span><span
lang=EN-GB style='color:black'>frequency to use for channel 1 (MHz) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>fx</span><span
lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>or </span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>settxfreq(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>channel</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>, </span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>channel</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...</span><span
lang=EN-GB style='color:black'>   which channel frequency to change (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>1/2</span><span
lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-69.75pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..... </span><span
lang=EN-GB style='color:black'>frequency to use  (MHz) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>fx</span><span
lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-69.75pt'><span
lang=EN-GB style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>or </span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>settxfreqs(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value1,
value2</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:teal'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-69.75pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value1</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...  </span><span
lang=EN-GB style='color:black'>frequency to use for channel 1  (MHz) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>fx</span><span
lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-69.75pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>value2</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...  </span><span
lang=EN-GB style='color:black'>frequency to use for channel 2  (MHz) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>fx</span><span
lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.4.3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Increment the receiver frequency</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>incrxfreq(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>increment</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>increment</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB style='color:black'>amount frequency should be incremented by (MHz)
(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>fx</span><span lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>Note: currently
not available on FX3 spectrometers</span></p>

<p class=MsoNormal><span lang=EN-GB style='color:black'>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.4.4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Increment the transmitter frequency</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:teal'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>inctxfreq(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>increment</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>increment</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB style='color:black'>amount frequency should be incremented by (MHz)&nbsp;
(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>fx</span><span lang=EN-GB style='color:black'>).</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>Note: currently
not available on FX3 spectrometers</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532002"><span lang=EN-GB>A.5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Looping</span></a></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.5.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Start a loop</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB>All commands
between loop and matching endloop will be repeated loop_number times.
loop_number &gt;= 0.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>loop</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>loop_name,
loop_number, [duration]</span><span lang=EN-GB style='font-size:10.0pt;
font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>loop_name</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...........  </span><span
lang=EN-GB style='color:black'>unique identifier for the loop (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>lx</span><span
lang=EN-GB style='color:black'>)</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>loop_number</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ......... </span><span
lang=EN-GB style='color:black'>number of times to execute the loop (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB style='color:black'>)</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration
</span><span lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>............  </span><span
lang=EN-GB style='color:black'>by default, ,the duration is 1 </span><span
lang=EN-GB style='font-size:11.0pt;font-family:Symbol'>m</span><span
lang=EN-GB style='color:black'>s, however you can reduce this down to 0.1 us if
necessary.</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.5.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>End a loop</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>endloop</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>loop_name,
[duration]</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>loop_name</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...........  </span><span
lang=EN-GB style='color:black'>unique identifier for the loop (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>lx</span><span
lang=EN-GB style='color:black'>)</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration
</span><span lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>............  </span><span
lang=EN-GB style='color:black'>by default, the duration is 1 </span><span
lang=EN-GB style='font-size:11.0pt;font-family:Symbol'>m</span><span
lang=EN-GB style='color:black'>s, however you can reduce this down to 0.1 us if
necessary.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>Note that loops can be nested.</p>

<p class=MsoNormal style='margin-left:36.0pt'>Make sure the loopnames are
unique (lxxx), otherwise an error will occur on compilation.</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.5.3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Conditional statements</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>Execute a block of code is a
statement is true. The block is bounded by the iftrue and endiftrue commands.</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>iftrue</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>block_name,
test_value</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='margin-left:35.45pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>block_name</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........... </span><span
lang=EN-GB style='color:black'>unique identifier for the block (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>sx</span><span
lang=EN-GB style='color:black'>)</span></p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>test_value</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........... </span><span
lang=EN-GB style='color:black'>the value to be tested for non-zero (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB style='color:black'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>endiftrue</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>block_name</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:205.55pt;text-indent:-127.55pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>block_name</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........... </span><span
lang=EN-GB style='color:black'>unique identifier for the block (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>sx</span><span
lang=EN-GB style='color:black'>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-align:justify'><span
lang=EN-GB>Note this command was originally called skiponzero or skiponfalse
and these variants are still available if the logic makes more sense. This is
why the block_name starts with an ‘s’.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532003"><span lang=EN-GB>A.6<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>RF pulse production</span></a></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>Several commands can be used to produce an
RF output, either as a pulse or a phase, frequency and amplitude modulated
waveform.</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.6.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Simple pulse</span></p>

<p class=MsoNormal><b><i><span lang=EN-GB>&nbsp;</span></i></b></p>

<p class=MsoNormal style='margin-left:36.0pt'>Generates a single or dual pulse
with specified amplitude, phase, duration and optional frequency.</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><i>Single channel version</i></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>pulse</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>destination, amplitude, phase, duration, [frequency]</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .... </span><span
lang=EN-GB>is either 1 (proton channel) or 2 (X channel)</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>amplitude</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>the pulse amplitude, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>ax</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..........  </span><span
lang=EN-GB>pulse phase, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>px</span><span lang=EN-GB>),&nbsp; – set
in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>is a short delay, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>dx</span><span lang=EN-GB>), (1 </span><span
lang=EN-GB style='font-size:11.0pt;font-family:Symbol'>m</span><span
lang=EN-GB>s to 327 ms).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>frequency</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>an optional frequency in MHz (</span><span lang=EN-GB
style='font-size:11.0pt;font-family:"Courier New";color:gray'>fx</span><span
lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:11.0pt;font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:11.0pt;font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><i>Dual -channel version</i></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>pulse</span><span
lang=EN-GB>( </span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>1, amplitude1, phase1, frequency1,</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>2,
amplitude2, phase2, frequency2, duration</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:70.9pt;text-indent:-34.9pt'><span
lang=EN-GB>            Parameters as above, except channels are fixed,
frequencies are required, and the duration is common.</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.6.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Shaped pulse</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>Generates RF
pulses with modulated amplitude on one channel.</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:3.0cm;text-indent:-49.05pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>shapedrf1</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>destination, ampTable, phase, tableSize, stepTime</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New"'>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .... </span><span
lang=EN-GB>is either 1 (proton channel) or 2 (X channel)</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>ampTable</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>amplitude tables (magnitude only),</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>tx</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-98.1pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..........  </span><span
lang=EN-GB>phase offset for channel, (</span><span lang=EN-GB style='font-size:
11.0pt;font-family:"Courier New";color:gray'>px</span>)<span lang=EN-GB>,&nbsp;
– set in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>tableSize</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>the number of entries in each table, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>stepTime</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>how long each step will last (</span><span lang=EN-GB
style='font-size:11.0pt;font-family:Symbol'>m</span><span lang=EN-GB>s) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>dx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>Generates RF
pulses with modulated amplitude <i>and</i> phase on one channel.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>shapedrf2</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>destination, ampPhaseTable, phase, tableSize, stepTime</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New"'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .... </span><span
lang=EN-GB>is either 1 (proton channel) or 2 (X channel)</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>ampPhaseTable</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .  </span><span
lang=EN-GB>an interleaved amplitude and phase table</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>tx</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..........  </span><span
lang=EN-GB>pulse phase, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>px</span>)<span lang=EN-GB>,&nbsp; – set
in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>tableSize</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>the number of entries in each table, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>stepTime</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>how long each step will last, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>dx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>Generates RF
pulses with modulated amplitude on both channels.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>dualshapedrf1</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>ampTable, phase1, phase2, tableSize, stepTime</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New"'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>ampTable</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........ </span><span
lang=EN-GB>2 channel interleaved amplitude tables</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>tx</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-98.1pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase1</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......... </span><span
lang=EN-GB>phase offset for channel 1, (</span><span lang=EN-GB
style='font-size:11.0pt;font-family:"Courier New";color:gray'>px</span>)<span
lang=EN-GB>,&nbsp; – set in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-98.1pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase2</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......... </span><span
lang=EN-GB>phase offset for channel 1, (</span><span lang=EN-GB
style='font-size:11.0pt;font-family:"Courier New";color:gray'>px</span>)<span
lang=EN-GB>,&nbsp; – set in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>tableSize</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>the number of entries in each table, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>stepTime</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>how long each step will last, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>dx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>Generates RF
pulses with modulated amplitude and phase on both channels.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>dualshapedrf2</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>ampPhaseTable, phase1, phase2, tableSize, stepTime</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New"'>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>ampPhaseTable</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .  </span><span
lang=EN-GB>2 channel interleaved amplitude and phase tables</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>tx</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-98.1pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase1</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......... </span><span
lang=EN-GB>phase offset for channel 1, (</span><span lang=EN-GB
style='font-size:11.0pt;font-family:"Courier New";color:gray'>px</span>)<span
lang=EN-GB>,&nbsp; – set in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:6.0cm;text-indent:-98.1pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase2</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .......... </span><span
lang=EN-GB>phase offset for channel 1, (</span><span lang=EN-GB
style='font-size:11.0pt;font-family:"Courier New";color:gray'>px</span>)<span
lang=EN-GB>,&nbsp; – set in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>tableSize</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>the number of entries in each table, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>stepTime</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>how long each step will last, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>dx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:1.0cm;text-indent:-1.0cm'><span
lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:64.35pt;text-indent:-1.0cm'><span
lang=EN-GB>For more information on using interleaved table see </span><span lang=EN-GB>Appendix E</span><span lang=EN-GB style='color:red'> </span><span
lang=EN-GB>using tables.</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.6.3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Chirped Pulse</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>Generates an RF
pulse with modulated amplitude and frequency on a single channel</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>chirprf2</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>destination, ampTable, freqTable, phase, tableSize,</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>        stepTime</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:49.65pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:49.65pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..... </span><span
lang=EN-GB>is either 1 (proton channel) or 2 (X channel) </span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>ampTable</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........  </span><span
lang=EN-GB>an amplitude table (magnitude only),</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>tx</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>freqTable</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>a frequency table (positive only),</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>fx</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ............ </span><span
lang=EN-GB>pulse phase, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>px</span>)<span lang=EN-GB>,&nbsp; – set
in the phase cycle array.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>tableSize</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ....... </span><span
lang=EN-GB>the number of entries in each table, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>stepTime</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........  </span><span
lang=EN-GB>how long each step will last, (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>dx</span>)<span
lang=EN-GB>.</span></p>

<p class=MsoNormal style='margin-left:49.65pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:49.65pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.6.4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Switch on the RF output</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>Simply switches
on the RF output. Use delays to define the pulse duration</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>txon(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination,
amplitude, phase</span><span lang=EN-GB style='font-size:10.0pt;font-family:
"Courier New";color:teal'>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination
</span><span lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>..... </span><span
lang=EN-GB>is one of: 1/2/1nb/2nb/w1/w2</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>amplitude
</span><span lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>....... </span><span
lang=EN-GB>the pulse amplitude, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>ax</span><span lang=EN-GB>).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>phase </span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>............ </span><span
lang=EN-GB>pulse phase, (</span><span lang=EN-GB style='font-size:11.0pt;
font-family:"Courier New";color:gray'>px</span><span lang=EN-GB>),&nbsp; – set
in the phase cycle array.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>The destination
field options are:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:54.0pt'><span lang=EN-GB>1
… Channel 1 (1H/3H/19F)</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt'><span
lang=EN-GB>2 … Channel 2 (other nuclei)</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt'><span
lang=EN-GB>1nb … Channel 1 but RF amplifier is not activated (no blanking
pulse)</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt'><span
lang=EN-GB>2nb … Channel 2 but RF amplifier is not activated (no blanking
pulse)</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt'><span
lang=EN-GB>w1 …. Channel 1 with wobble mode activated</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:54.0pt'><span lang=EN-GB>w2
…. Channel 2 with wobble mode activated</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.6.5<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Switch off the RF output</span></p>

<p class=MsoNormal style='margin-left:49.65pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB>Switches off the
RF output.</span></p>

<p class=MsoNormal style='margin-left:49.65pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>txoff(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:teal'>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>destination</span><span
lang=EN-GB>: is one of: 1/2/1nb/2nb/w1/w2</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532004">A.7<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Shim and gradient commands</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>These commands control the
currents in the various shims and where fitted, the single gradient channel.</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.7.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Shim control</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>Set a shim value</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>shim16</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>channel, amplitude</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>channel</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ..... </span><span
lang=EN-GB>the shim channel (1-15) (</span><span lang=EN-GB style='font-size:
10.0pt;font-family:"Courier New";color:gray'>nx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>amplitude</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>the shim value (16 bit signed number) (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx/tx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>Ramp a shim current linearly</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>shimramp16</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>channel, start, end, steps, duration</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>channel</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> .... </span><span
lang=EN-GB>the shim channel (1-15) (</span><span lang=EN-GB style='font-size:
10.0pt;font-family:"Courier New";color:gray'>nx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>start</span><span
lang=EN-GB style='font-size:7.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>...... </span><span
lang=EN-GB>the start ramp value (16 bit signed number) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx/tx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>end</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........ </span><span
lang=EN-GB>the end ramp value (16 bit signed number) (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx/tx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>steps</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>number of steps in the ramp (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>how long each step lasts (</span><span lang=EN-GB style='font-size:
10.0pt;font-family:"Courier New";color:gray'>dx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoHeading9 style='margin-left:0cm;text-indent:0cm'><span lang=EN-GB>A.7.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-GB>Gradient control</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>Switch on the gradient (where
fitted)</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>gradon</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>amplitude</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>amplitude</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>the gradient value (a 16 bit signed number) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx/tx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>Switch off the gradient (where
fitted)</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>gradoff</span><span
lang=EN-GB>()</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>Ramp the gradient current
linearly</p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>gradramp</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>start, end, steps, duration</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>start</span><span
lang=EN-GB style='font-size:7.0pt;font-family:"Courier New";color:gray'> </span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>...... </span><span
lang=EN-GB>the start ramp value (16 bit signed number) (</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx/tx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>end</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........ </span><span
lang=EN-GB>the end ramp value (16 bit signed number) (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx/tx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>steps</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ...... </span><span
lang=EN-GB>number of steps in the ramp (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>duration</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>how long each step lasts (</span><span lang=EN-GB style='font-size:
10.0pt;font-family:"Courier New";color:gray'>dx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB style='color:black'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532005">A.8<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Table commands</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'>These commands control the
location of the table index – i.e. which value in a table will be used next.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>decindex</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>table, [decrement]</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-83.95pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>table</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........ </span><span
lang=EN-GB>table index to decrement (</span><span lang=EN-GB style='font-size:
10.0pt;font-family:"Courier New";color:gray'>tx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-83.95pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>decrement
</span><span lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>.... </span><span
lang=EN-GB>amount to decrement by (defaults to 1) (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:teal'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>incindex</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>table, [increment]</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-83.95pt'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>table</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ........ </span><span
lang=EN-GB>table index to increment (</span><span lang=EN-GB style='font-size:
10.0pt;font-family:"Courier New";color:gray'>tx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:155.95pt;text-indent:-3.0cm'><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>decrement
</span><span lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'>.... </span><span
lang=EN-GB>amount to increment by (defaults to 1) (</span><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>nx</span><span
lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:teal'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:teal'>setindex</span><span
lang=EN-GB>(</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:gray'>table, index</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>table</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>table index to increment (</span><span lang=EN-GB style='font-size:
10.0pt;font-family:"Courier New";color:gray'>tx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:gray'>index</span><span
lang=EN-GB style='font-size:9.0pt;font-family:"Courier New"'> ... </span><span
lang=EN-GB>value for the index (</span><span lang=EN-GB style='font-size:10.0pt;
font-family:"Courier New";color:gray'>nx</span><span lang=EN-GB>)</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.45pt'>See <span style='color:#C00000'>Appendix
xx</span> for more details on using tables.</p>

<p class=MsoNormal style='margin-left:72.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532006">Appendix B<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Available control groups</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><a name="_Hlk155885036">Following
</a>is a list of the control (tab) groups available which are used by some of
the experiments, and the key feature(s) which differentiate them. These may be
found in the folder: </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&lt;prospa&gt;\Macros\UCS-PP\Tabs\AlternateInterface</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532007">B.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Acquisition</a> </p>

<p class=MsoNormal style='text-autospace:none'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify;text-autospace:none'><a
name="_Hlk155885065">Used when collecting data </a>by specifying a dwelltime
(sampling time) and the number of points to collect. These are the natural
machine units, although not necessarily the most comfortable for the
spectroscopist. However, note that the corresponding bandwidth and acquisition
time are reported bottom of this group and are automatically updated if the
number of points or dwell time is modified.</p>

<p class=MsoNormal style='text-autospace:none'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center;text-autospace:none'><img
width=242 height=292
src="Pulse%20Programming%20Guide%20(FX3)_files/image018.png"></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><i>&nbsp;</i></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532008">B.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>AcquisitionBW</a></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-autospace:none'>Used when
collecting data by specifying a bandwidth in PPM and an acquisition time. Be
aware than small bandwidths (or large dwell-times) may lead to excessive first
order phase distortions. </p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center;text-autospace:none'><img
width=241 height=294 id="Picture 21"
src="Pulse%20Programming%20Guide%20(FX3)_files/image019.png"></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-autospace:none'>Note that the
dwelltime and required number of points are automatically updated if the
bandwidth or acquisition time is modified. Because of the number of points is
unlikely to be a power of 2 zero filling will be required before processing is
applied.</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><i>&nbsp;</i></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532009">B.3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>AcquisitionBW2D</a></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'>A 2D version of AcquisitionBW.</p>

<p class=MsoNormal style='text-autospace:none'>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532010">B.4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>AcquisitionFIR</a></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-autospace:none'>The same as
the standard acquisition list except it provides the option to specify how much
FIR decimation should be applied. This is used with sequences which do not
apply the FIR filter in the spectrometer hardware but rather delay this until
the data is in the PC. This allows linear prediction to be used to minimise
baseline and first order phase correction problems by predicting the first few
data points in the FID.  However, it does require that more data is collected.
This is determined by the FIR decimation factor. This option is unused in the
current version of Expert.</p>

<p class=MsoNormal style='text-autospace:none'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center;text-autospace:none'><img
width=240 height=315 id="Picture 22"
src="Pulse%20Programming%20Guide%20(FX3)_files/image020.jpg"></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532011">B.5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Display_Std</a></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal style='text-align:justify'>Allows the selection of a ppm or
Hz scale. The former allows both scale limits to be selected while the latter
just allows a width. Zero in the display range (Hz) field displays all the data
if ‘Use ppm scale’ is not checked.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=242
height=127 id="Picture 14"
src="Pulse%20Programming%20Guide%20(FX3)_files/image021.png"></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532012">B.6<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Display_2D</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The 2D version of Display_Std which provides control of the
2nd dimension range. </p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=246
height=175 id="Picture 26"
src="Pulse%20Programming%20Guide%20(FX3)_files/image022.jpg"></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532013">B.7<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Display_Hz</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Simply allows the display range to be selected in Hz.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=246
height=51 id="Picture 24"
src="Pulse%20Programming%20Guide%20(FX3)_files/image023.png"></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532014">B.8<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>File_Settings</a></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal style='text-align:justify'>This option allow selection of whether
the collected data should be saved or not.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=246
height=48 id="Picture 16"
src="Pulse%20Programming%20Guide%20(FX3)_files/image024.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532015">B.9<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Jres_processing</a></p>

<p class=MsoNormal style='text-autospace:none'><i>&nbsp;</i></p>

<p class=MsoNormal style='text-autospace:none'>The same as Processing_std
except there is an option to tilt the 2D data by 45 degrees and an option to
disable 2D processing and display until the experiment is finished</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center;text-autospace:none'><img
width=246 height=147
src="Pulse%20Programming%20Guide%20(FX3)_files/image025.jpg"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532016">B.10<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Processing_std</a></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>Provides options to zero fill and
apodize the time domain data. Different frequency domain phasing options are
also provided.</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=243
height=118 id="Picture 12"
src="Pulse%20Programming%20Guide%20(FX3)_files/image026.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532017">B.11<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Processing2d_std</a></p>

<p class=MsoNormal style='text-autospace:none'><i>&nbsp;</i></p>

<p class=MsoNormal style='text-align:justify'>The same as Processing_std except
there is an option to disable 2D processing and display until the experiment is
finished (useful for large data sets as this may allow shorter repetition
times.)</p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=249
height=146 src="Pulse%20Programming%20Guide%20(FX3)_files/image027.jpg"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532018">B.12<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Processing_autophase</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Just provides an autophase
option. Useful with the CPMGInt where time domain filtering is not an option.</p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal align=center style='text-align:center'><img width=243
height=50 id="Picture 19"
src="Pulse%20Programming%20Guide%20(FX3)_files/image028.png"></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532019">B.13<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Processing_filter_autophase</a></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal style='text-align:justify'>The same as Processing_std except
it includes an autophase option as well. Useful when you are wanting to phase a
group of FIDs based on a reference FID (e.g. a T1 or a T2 experiment).</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=244
height=116 id="Picture 18"
src="Pulse%20Programming%20Guide%20(FX3)_files/image029.png"></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532020">B.14<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>ProcessingBW</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Use this option in combination
with AcquireBW to work with acquisition time and bandwidth rather than
dwellTime and nrPnts. In this case you define the number of spectral points to
be equal to or greater than the number of time domain points collected (which
won’t necessarily be a factor of 2 which is necessary for the Fourier transform
used).</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:gray'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=246
height=121 id="Picture 20"
src="Pulse%20Programming%20Guide%20(FX3)_files/image030.png"></p>

<h1>&nbsp;</h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532021">Appendix C<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Procedures to change pulse program values</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Many pulse program values are
presented in a form which is not suitable for the hardware (dB for RF
amplitude, frequencies in MHz, delays in microseconds etc.). This conversion is
done automatically for most parameters before reaching the execpp procedure.
However when modifying a parameter between scans you will need to explicitly convert
the user unit into machine units and update the event table. Procedures written
in the macro ucsRun can be used for this purpose.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>All have the same format:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>pulse_parameter_list 
= procedure_name(pulse_parameter_list, </span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>                                      
index_of_parameter,</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>                                      
user_unit)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In execpp the <span style='font-size:10.0pt;font-family:
"Courier New"'>pulse_parameter_list </span>is the variable <span
style='font-size:10.0pt;font-family:"Courier New";color:black'>ppList</span>.
The parameter index is stored in the array varIndex and <span style='font-size:
10.0pt;font-family:"Courier New"'>user_unit </span>you must supply.</p>

<p class=MsoNormal>Here is the list of helper procedures in ucsRun:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>setPPAmplitude ......   set an RF amplitude (dB) in the event
table</p>

<p class=MsoNormal>setPPDelay ..............   set a short delay (µs) in the
event table</p>

<p class=MsoNormal>setPPLongDelay ......   set a long delay (µs) in the event
table</p>

<p class=MsoNormal>setPPNumber .........   set a number in the event table</p>

<p class=MsoNormal>setPPPhase .............   set an RF phase (0-4) in the event
table</p>

<p class=MsoNormal>setPPFrequency ......   set a frequency (MHz) in the event
table</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>An example of using one of these commands is shown below</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>      ppList = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>ucsRun:setPPDelay</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(ppList,
varIndex[0], pulseLengths[stepNr])</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Note that array index in varIndex. This is zero because this
is the first (and only in this case) variable in the variable list found in the
pulse program</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>   variables = [</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;d90Dur&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If there were two variables and you wanted to modify the
second then you would use <span style='font-size:10.0pt;font-family:"Courier New";
color:black'>varIndex[1]</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Ref183373723"></a><a name="_Toc183532022">Appendix D<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Acquisition Explained</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>When data is received by from the
NMR probe it first amplified by a factor of a few thousand before being
digitised by a 16-bit converter at 100 million samples per second. This digital
signal is then multiplied by two reference frequencies equal to the NMR receive
frequency but differing in phase by 90 degrees. This gives two channels – the
in-phase and quadrature signals or in NMR terms the real and imaginary parts.
These are then passed through two identical digital filters which reduce the
bandwidth by averaging points together. The result of this is a downshifting of
the signal from many MHz to kHz, the exact amount depending on the chosen
dwell-time or sampling interval. Two filters are available – a fast, so-called,
CIC filter which reduces the frequency bandwidth by a large amount, but has a
poor frequency response and a slower FIR filter which flattens this response,
but only reduces the frequency by a factor of 2. The ‘Flat filter’ option in
the Spinsolve parameter list just adds the FIR filter to the CIC filter output.
When unchecked only the CIC filter is used. This is typically only used in
experiments where we expect all the signal to be close to the centre of the
spectrum. A typical case is a CPMG experiment collected with a large bandwidth
– say 1 MHz. In this case the CIC only filter will allow shorter echo times and
give better time domain SNR because of the narrower frequency response.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Digital filters have a
characteristic start-up duration where the amplitude goes from zero to the
final value over a several sampling intervals. This results in significant
distortion to the FID if not corrected. In the Spinsolve spectrometer we simply
throw these data points and add an equal number to the end. By default, the 6 initial
data points are removed. The next 6 points also suffer some distortion, but
this is minor. If required these can be correcting using linear prediction.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Because it takes a finite amount
of time for the NMR signal to propagate through the digital filter, we need to
apply a correction offset to start sampling at exactly the right time. This is
stored in the variable rxLat (receiver latency). By design this delay is small
and constant for the combined FIR+CIC filter, but can get quite large and
negative in the CIC-only case because here we are throwing away more initial
points (6) than the ideal (3). This was done because the initial FID distortion
is more pronounced if only 3 points are discarded.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Another duration which needs to
be considered when collecting data is the overall sampling period. Ideally this
would just be the dwell-time multiplied by the number of collected data points.
However, there are some additional delays required to get the data through the
filter and into memory. These are only important in experiments which collect
data between pulses and we need to know how long that will take. In this case
there is an internal procedure which calculates this and if you don’t leave
enough time for the acquisition it will result in an error message. For this reason,
almost all acquisition modes have the option to specify a duration so the
timing of the pulse sequence can be accurately defined.  Of course, this
duration should be set to be larger than the expected acquisition time to avoid
an error message. This duration can be estimated using the procedure
ucsRun:getAcqTime.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Ref183373667"></a><a name="_Toc183532023">Appendix E<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Using Tables</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>Several
pulse-program commands allow the use of waveform tables as arguments. This
permits parameters to be modified inside a loop according to a table of values
which are stored on the spectrometer. Because these tables can be quite large,
they are written to the spectrometer before the experiment begins. A typical
table application is to step an amplitude through several values. The following
example changes the amplitude of an RF pulse to produce a linear ramp. The
output of the transceiver is connected back into the input directly or via an
external amplifier or filter. The result is the amplitude response of the
combined transceiver and filer/amplifier. Note that the code to save the table
to the spectrometer is not part of the pulse program file, but happens,
nevertheless, behind the scenes.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>...</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>   relationships = [</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;nAmpSteps =
ampSteps&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;nPnts =
nrPnts&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;b1Freq =
f1&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;txMax =
ucsRun:convertTxGain(txMaxdB)&quot;</span><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;tAmp =
linspace(0,txMax,ampSteps)&quot;</span><span style='font-size:9.0pt;font-family:
"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;totPnts =
nAmpSteps&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;totTime =
acqTime&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>]</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>...</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU
style='font-size:11.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:9.0pt;
font-family:"Courier New";color:#780078'>initpp</span><span style='font-size:
9.0pt;font-family:"Courier New";color:black'>(dir)                   </span><span
style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'># Set internal
parameter list</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>cleardata</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(nAmpSteps)         
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Clear data memory</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>setindex</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(tAmp,0)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>loop</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;l1&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>,nAmpSteps)         
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Measure at nAmpSteps amplitude steps</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>txon</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;1nb&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>,tAmp,p1)        </span><span
style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'># Switch on tx using
new amplitude</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>delay</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(10)                 
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Wait for tx to stabilse </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>acquire</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;integrate&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>,nPnts) </span><span
style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'># Acquire nPnts
data points and integrate</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>txoff</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;1nb&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>)               </span><span
style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'># Switch off tx</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>incindex</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(tAmp,1)          
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Increment tx amplitude  by 1</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>        </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>delay</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(10)                  
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Wait for system to recover</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>endloop</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;l1&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>)                
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Next measurement</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>   lst = </span><span style='font-size:9.0pt;font-family:"Courier New";
color:#780078'>endpp</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>(0)                 </span><span style='font-size:9.0pt;
font-family:"Courier New";color:#AA0000'># Return parameter list</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:#AA0000'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>Here the RF
amplitude values are stored in the tAmp array (a simple ramp), then between
evaluating the relationships list and running the sequence, this array is first
saved to the spectrometer, and a table reference is returned with the same
name. This has only two entries – the address of the table in memory and the
size. </span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>In the sequence,
the table index is initialised to the start of the table and then each time
around the loop the amplitude in the txon command is taken from the current
location in the table now stored on the spectrometer. The incindex command then
moves to the next element in the table. At each step, the signal that has
passed through the external circuit is collected and saved as a single value
with the acquire command. Because the transmit and receive frequencies are the
same the data will always have an offset frequency of zero. </span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>A more complex
case is to sweep the frequency rather than the amplitude. This could be used to
determine the frequency response of an amplifier or filter. Similar code is
also used to generate the Wobble response in the Spinsolve.</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New";color:black'> </span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>  relationships =
[</span><span style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;b1Freq
= lowFreq&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;fSweep =
linspace(lowFreq,upFreq,freqSteps)&quot;</span><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;tFreq1 =
ucsFX3:convertFrequency(fSweep)&quot;</span><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;tFreq2 =
ucsFX3:convertFrequency(fSweep*10)&quot;</span><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;nFreqSteps =
freqSteps&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;nPnts =
nrPnts&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;totPnts =
freqSteps&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>                    </span><span style='font-size:9.0pt;
font-family:"Courier New";color:gray'>&quot;totTime = acqTime&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>]</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>...</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>   </span><span style='font-size:9.0pt;
font-family:"Courier New";color:#780078'>initpp</span><span style='font-size:
9.0pt;font-family:"Courier New";color:black'>(dir)                    </span><span
style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'># Reset
internal parameter list</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>cleardata</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(nFreqSteps)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>setindex</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(tFreq1,0)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>setindex</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(tFreq2,0)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>loop</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;l1&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>,nFreqSteps)          
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Measure at nFreqSteps</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>setrxfreq</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(tFreq2)           
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Set the receiver frequency</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>txon</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;1nb&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>,aRF,p1,tFreq1)   
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Switch on Tx channel 1 using new Tx freq.</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>delay</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(10)                   
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Wait for stability</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>acquire</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;integrate&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>,nPnts)   </span><span
style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'># Acquire nPnts
data points and integrate</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>txoff</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;1nb&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>)                
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Switch off the Tx</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>incindex</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(tFreq1,2)          
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Increment Tx frequency</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>incindex</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(tFreq2,2)          
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Increment Rx frequency</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>         </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>delay</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(10)                   
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Wait for stability</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>      </span><span style='font-size:
9.0pt;font-family:"Courier New";color:#780078'>endloop</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:9.0pt;font-family:"Courier New";color:gray'>&quot;l1&quot;</span><span
style='font-size:9.0pt;font-family:"Courier New";color:black'>)                  
</span><span style='font-size:9.0pt;font-family:"Courier New";color:#AA0000'>#
Next measurement</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>   lst = </span><span style='font-size:9.0pt;font-family:"Courier New";
color:#780078'>endpp</span><span style='font-size:9.0pt;font-family:"Courier New";
color:black'>(0)                 </span><span style='font-size:9.0pt;
font-family:"Courier New";color:#AA0000'># Return parameter list</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:11.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>This works in
much the same way as the amplitude sweep except that in this case, we need two
tables, because the transmit and receive frequencies differ by a factor of 10 (this
is for calculation purposes only, the final internal Tx and Rx frequencies are
the same).  Also, the frequency values in the table are 32-bits long which is
double that of the amplitudes, so we need to increment the table by 2 each time
around the loop. Here is an output of the frequency sweep for an amplifier used
in the spectrometer receiver.</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal><img width=602 height=218
src="Pulse%20Programming%20Guide%20(FX3)_files/image031.jpg"
alt="A graph of a function&#10;&#10;Description automatically generated with medium confidence"></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>In addition to
explicitly setting a parameter by stepping though a table there are also some
dedicated commands such as shapedrfpulse1/2 or chirpedrf which encapsulate this
loop in a single command allowing shorter loop times.</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532024">Appendix F<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Programming multi-X spectrometers</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If you have a multi-X spectrometer then it has probe coils
which can be tuned to different nuclei using internal switching. To see what
nuclei your spectrometer supports, (in addition to 1H), run the following
command from the CLI:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:teal'>SpinsolveParameterUpdater:getXChannelNames</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal>This will return a list of nuclei.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To ensure that the probe switches are set correctly when you
run an experiment, you need to call a special command at the start of the
execpp procedure:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:teal'>SpinsolveParameterUpdater:setXChannel</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>(channelName)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>You only need to do this if the
receive channel in the parameter list is not the same as the X nucleus transmit
channel. For example, the HMBC experiment detects on the proton channel but
transmits on both the proton and carbon channels. If you have a multi-X system
then you need to ensure that the probe tuning is optimised for carbon.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>A Spinsolve with a tuned Fluorine or Tritium channel is a
special case as 19F/3H and 1H share the same receive and transmit channels. In
this case you need to use a different command:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:teal'>SpinsolveParameterUpdater:setEnhanced</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;19F&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'>or</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:teal'>SpinsolveParameterUpdater:setEnhanced</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;3H&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532025">Appendix G<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The pulse program event-table format</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>As mentioned
previously it is not necessary to know the format of the event table, but
occasionally it can be useful for debugging purposes, and you can always print
the table to the CLI using the ‘report’ function.  The event table printed in
this way is annotated, including the pulse sequence script commands to help
identify each section. An argument of 0 to this command (the default) will show
file parameter names, 1 will show the parameter values.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-autospace:none'><span
lang=EN-AU>The event table is hosted on a Spartan-6 FPGA (field programmable
gate array) on the Spinsolve transceiver board. This FPGA controls all the
spectrometer functions. Each event consists of 96 bits, broken up into a
command duration, command code and then arguments.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center;text-autospace:none'><span
lang=DE>Duration (32)      cmd (8)       arg1 (24)             arg2 (32)</span></p>

<p class=MsoNormal align=center style='text-align:center;text-autospace:none'><span
lang=DE>     100                  0x00            0x118E                0x3FFF</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=DE>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-autospace:none'><span
lang=EN-AU>This example writes 0x3FFF to FPGA address 0x118E, updating the
transceiver channel-1 pulse amplitude. The duration is in multiples of clock
cycles (10 ns), so 100 clock cycles correspond to 1 </span><span lang=EN-AU
style='font-family:Symbol'>m</span><span lang=EN-AU>s. When using ‘report’ the
cmd and arg1 fields are combined into a single 32 bit number. The duration is
reported in decimal and the other fields in hexadecimal.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>The possible command
codes are listed below:</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x00 – write to
an address</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x01 – read
from an address</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x03 – end the
pulse program</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x04 – loop
start</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x05 – loop end</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x08 – set
digital receiver gain and receive channel</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x09 – delay</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x0A – skip
command</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x0D – generate
a shim ramp</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>0x0E – set a
shim value</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>Other codes are
unused or are specific to the Kea spectrometer.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>Current
experiments range in length from 150 events to 800 events. (Of these
approximately 100 events are devoted to the initialisation or start-code).</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>Here is part of
an event table print-out corresponding to the RF pulse program command shown
below:</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>rfCh = 'e'   # External pulse</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>aPulse = 0   # 0 dB (maximum amplitude)</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>dPulse = 10  # 10 us pulse</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>p1 = 0       # 0 phase</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:11.0pt;
font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>ps.pulse(rfCh, aPulse, p1, dPulse)</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>The
corresponding lines in event table are:</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>Line Clocks     Arg1    Arg2</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>112:
15      00000000 00000100 # Switch on the RF gate</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>113:
15      0000118E 00003FFF # Set the DDS amplitude</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>114:
470     0000118E 00000000 # Set the phase and wait pgo</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>115:
1000    00000000 00000108 # Turn on RF and wait 10 us</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>116:
15      00000000 00000000 # Turn off the RF</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>117:
15      0000118E 00000000 # Zero the amplitude</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>118:
15      0000118E 00000000 # Zero the phase</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>119: 55      09000000 00000000 # Wait for DDS update</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>The first 3 lines switch on the
external RF gate and sets the amplitude and phase in the DDS (direct digital
synthesiser). The total delay here is 5 <span style='font-family:Symbol'>m</span>s
(pgo). This allows the RF amplifier and DDS output to stabilise. Line 115 turns
on the RF output from DDS and then waits 10 <span style='font-family:Symbol'>m</span>s.
At this point RF output appears from the amplifier. Line 116 switches this RF
output off and then lines 117-119 resets the DDS. Adding up the delays we see
the total duration is pgo + pulse_duration + 1 <span style='font-family:Symbol'>m</span>s.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>If you want to see the event
table after each scan, then passing an argument of 1 to the endpp command in
the pulse program macro. Recompilation is not required.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532026"></a><a name="_Ref183432092">Appendix H<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Repetition or inter-experiment </a>time?</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Most experiments in the Expert
menus used the repetition time parameter, <i>repTime</i>. This is the time
between the start of one experiment scan and the start of the next: </p>

<p class=MsoNormal align=center style='text-align:center'><img width=590
height=178 id="Picture 7"
src="Pulse%20Programming%20Guide%20(FX3)_files/image032.png"></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Experiments defined in this way
have a very simple total duration equal to the number of scans multiplied by
the repetition time. This can be quickly added to the expectedDuration
procedure to control the progress bar e.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>procedure(expectedDuration,
guipar)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
assignstruct(guipar)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
totScans = nrScans + useStartDelay</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
duration = (totScans*repTime)/1000 </span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>endproc(duration)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In this procedure useStartDelay is an option to add an
additional repetition time to the start of the experiment. Currently this is
always 0.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Alternatively, you can define an
interexperiment time, <i>ieTime</i>. This is the delay between the end of one pulse
sequence scan and the start of the next. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=589
height=134 id="Picture 6"
src="Pulse%20Programming%20Guide%20(FX3)_files/image033.png"></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This is appropriate when the pulse
sequence might have large variable delays such as T1. In this case, to
determine the complete experiment duration you need to know the pulse sequence
duration for each T1 step. The easiest way to determine this is to set up the
experiment relationship list so it defaults to the shortest variable delay and
then call the macro GetPulseProgramDuration to calculate the duration of a
single pulse sequence execution with this short delay. Then take this result
and add on the variable delay information. As an example, here is the
expectedDuration procedure for the T1ie experiment</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>procedure(expectedDuration,
guipar)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
assignstruct(guipar)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
if(delaySpacing == &quot;log&quot;)</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>     
dArray = logspace(minDelay,maxDelay,nrSteps)*1000</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
else</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>     
dArray = linspace(minDelay,maxDelay,nrSteps)*1000</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
endif</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
totDelayTime = sum(dArray)+minDelay*1000 # Include dummy</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
nrDummys = 1</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
psTime = GetPulseProgramDuration(&quot;T1iet&quot;,1,guipar)*1000</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
psTime = psTime - minDelay*10000 # Base ps duration</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
psTime = psTime + nrPnts*10 # Data collection time estimate</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
totScans = (nrSteps+nrDummys)*nrScans</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>  
duration = (totScans*(psTime+ieTime*1000) + nrScans*totDelayTime)/1e6</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>endproc(duration)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Here we have duplicated the code
for generating the duration array and then summed this to find the total delay
time. This is then added to the base pulse program duration and then finally
the interexperiment time is added. Note that there is some uncertainty in this
calculation since we had to guess how long it takes to read the data back from
the spectrometer. This can be corrected by explicitly calling the read command.
For example see the experiment ProtonShowDetails.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>In addition to the using the <i>ieTime</i>
parameter instead of <i>repTime</i> and the more complex <i>expectedDuration</i>
procedure, the other change is a relocation of the <i>ucsRun:checkTiming</i>
procedure call in <i>execpp</i> and addition of a <i>tEndPS</i> variable which
should be defined just before the start of the outer loop of the experiment and
just after the <i>getData</i> procedure call.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Note that when using repTime it
is necessary to make the repetition time long enough to include the longest
pulse sequence time, plus the processing and display time. For ieTime cases the
inter-experiment delay should always be longer than the processing and display
time. If either of these statements is not true then the experiment will still
proceed, but a warning will be written to the command line interface.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Ref183432057"></a><a name="_Toc183532027">Appendix I<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Spectrometer factory parameters</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>All Spinsolves are calibrated at
the factory to optimise the performance of a variety of experiments.  The
necessary parameters are stored in Flash memory on the spectrometer and can be
retrieved by the Expert software. Normally this happens automatically when you
start the software with a spectrometer connected, if you reconnect using the <i>Select
Spinsolve </i>option from the File menu or if you read the parameter directly
in the <i>Spinsolve parameter dialog</i> again accessible from the file menu.
These parameters are stored in the global data class gData and can be viewed in
the CLI using the command</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&gt; print gData-&gt;specParameters</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This will list all the parameters
in their ‘raw’ form as stored on the spectrometer flash.  This list includes
the possibility for storing pulse information for up to 5 X nuclei. You can
just access information for a particular nucleus using the command </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&gt; print gData-&gt;getXChannelParameters(nucleus)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Where nucleus is the string “13C”
, “11B” etc. This will copy the appropriate pulse information for that channel
into a series of standard variable names e.g. if X nucleus channel 3 is boron
the power level will be copied from variable Power_level_X3 to Power_level_X.
In this way you don’t need to know which X channel is which – just the nucleus
name.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Following is a list of the most common variable names. These
should be used in the getFactoryBasedParameters procedure in the pulse program
macro to extract default factory parameters:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>These define the single pulse X_channel parameters. Note
that the frequency will be updated when performing a calibration:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>X-channel pulse
length ………  Pulse_length_X</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>X-channel pulse
amplitude ..  Power_level_X</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>X-channel
frequency …………  Frequency_X</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The following parameters define the amplitude of the proton
pulse for different tip angles if the pulse length is the same as Pulse_length_X.
This is used when applying a pulse to both the 1H and X channels
simultaneously:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H-X-45-Amplitude
……………  Power_level_HX45</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H-X-90-Amplitude
……………  Power_level_HX90</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H-X-135-Amplitude
……….…  Power_level_HX135</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H-X-180-Amplitude
…………  Power_level_HX180</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The following parameters define the proton decoupling
amplitude and pulse length as well as the NOE pulse amplitude</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H-decouple
pulse length ….  PulseLength_1H_Decouple</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H-decouple-amplitude
….…  PowerLevel_1H_Decouple</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H-NOE pulse
amplitude ..…  PowerLevel_1H_NOE</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In addition to the X-channel parameters there is also
information about Proton and Fluorine:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H 90 pulse
length ……………  PulseLength_1H</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H 90 pulse
amplitude …...…  PowerLevel_1H</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>1H Frequency
…………………...  Frequency_1H</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>19F 90 pulse
length ………..…  PulseLength_19F</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>19F 90 pulse
amplitude ….…  PowerLevel_19F</p>

<p class=MsoNormal style='margin-left:5.0cm;text-indent:-5.0cm'>19F frequency
………………..…  Frequency_Lock</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>These are the most important parameters. There are a few
others which can be found in the Spinsolve Parameter dialog. Use the
control-left click option on the appropriate text box to view the parameter
names which can also be copied to the clip board.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=303
height=217 id="Picture 1"
src="Pulse%20Programming%20Guide%20(FX3)_files/image034.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Apart from the frequencies and
shim values all other parameters are quite stable and shouldn’t change
significantly with temperature or time. The frequencies are of course updated
using the lock and calibrate experiment while the various autoshimming tools
keep the shims at the optimal values.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532028">Appendix J<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The SpinsolveExpert classes</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The SpinsolveExpert software uses
a series of global classes to simplify accessing variables and procedures from
anywhere in the program. In this appendix we will just list some of the most
commonly used variables and procedures which you might need to access in your
experiment scripts. The classes are defined in the folder:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>&lt;expert_install_directory&gt;\Macros\Spinsolve-Expert\Classes</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>and are macros starting with the
prefix <b>se</b> (Spinsolve-expert). A single instance of each of these classes
is then generated and the se prefix is replaced with <b>g</b> (for global).
Note that with classes, member variables and member procedure are accessed
using the arrow notation (-&gt;)</p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'>Class
instances:</p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gBatch …  this
controls experiment batch processing</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gData …..  this
is where important data related to the experiment is stored and manipulated.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gExpt …..  this
controls the experiment operation.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gFFT ….…  contains
code for data Fourier transformation.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gFX3 …….  controls
the generation and execution of the event table on FX3 systems.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gLock ….   controls
finding the lock and displaying lock information.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gMenus .  controls
the addition and subtraction of user menus</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gParam … this
controls the construction of the Expert parameter list </p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gPlot ……  control
the layout of plots.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gProc ……  this
controls the post processing interface.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gSeq ……  controls
the generation and execution of the pulse programs for DSP systems.</p>

<p class=MsoNormal style='margin-left:49.65pt;text-indent:-49.65pt'>gView …..  this
class defines all the controls in the Expert interface.</p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>In addition, there are a number
of support macros in the Macros\UCS-Core folder which are used with the global
classes and appear in all experiments. (e.g. ucsRun:getData)</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Important data structures:</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-left:134.7pt;text-align:justify;text-indent:
-134.7pt'>gData-&gt;specParameters .…  the raw Spinsolve factory parameters</p>

<p class=MsoNormal style='margin-left:134.7pt;text-align:justify;text-indent:
-134.7pt'>gData-&gt;curExpt ……………...  information about the currently loaded
experiment</p>

<p class=MsoNormal style='margin-left:134.7pt;text-align:justify;text-indent:
-134.7pt'>gData-&gt;preferences ………..  user preferences.</p>

<p class=MsoNormal style='margin-left:134.7pt;text-indent:-134.7pt'>gData-&gt;commonPar
………..  common parameters (b1Frequencies after calibration)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:134.7pt;text-indent:-134.7pt'>gView-&gt;gx
……………………….  graph number x (1 … 6 1D plots, 7 … 10 2D plots)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Example class procedures</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>gData-&gt;getXChannelParameters(nucleus) …. returns the
parameters specific to ‘nucleus’</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>gView-&gt;g<b>x</b>-&gt;subplot(1,1)-&gt;plot(x,y) …. Plots
the x,y data into graph <b>x </b>subplot (1,1)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>You can always print the class instances and substructures
in the command line interface to get more information. E.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&gt; pr gData-&gt;curExpt-&gt;parameters</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This will print out all the parameters for the currently
loaded experiment.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532029">Appendix K<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Pulse program limits</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Here we list some limits on the various parameters using
when pulse programming.</p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:148.85pt;text-align:justify;text-indent:
-148.85pt'><span lang=EN-AU>Maximum no. of events ………. Approximately 5000  </span></p>

<p class=MsoNormal style='margin-left:148.85pt;text-align:justify;text-indent:
-148.85pt'><span lang=EN-AU>Maximum data set size ……..… </span>174762 (this is
1024*1024/6, as each complex number requires 48 bytes, and 1 MByte of memory is
available).</p>

<p class=MsoNormal style='margin-left:148.85pt;text-align:justify;text-indent:
-148.85pt'><span lang=EN-AU>Maximum single table size<sup>1</sup> ..   65534 
(2<sup>16</sup>-2)</span></p>

<p class=MsoNormal style='margin-left:148.85pt;text-align:justify;text-indent:
-148.85pt'><span lang=EN-AU>Total table entries<sup>1</sup>……………….. 524272 (2<sup>19</sup>-16)</span></p>

<p class=MsoNormal style='margin-left:148.85pt;text-align:justify;text-indent:
-148.85pt'><span lang=EN-AU>Maximum RF amplitude ……..  </span>0dB == ~1W or
16383 in digital units</p>

<p class=MsoNormal style='margin-left:148.85pt;text-align:justify;text-indent:
-148.85pt'>Minimum RF amplitude ….…..  -85 dB or 0 in digital units</p>

<p class=MsoNormal>Gradient range …………………… -32768 to 32767 (16-bit signed
number)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc183532030">Appendix L<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Exporting to MNova</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>To allow a pulse program to
export to MNova it is necessary to add a subfolder called MNova to the pulse
program experiment folder in addition to the MNova post processing button. In
this subfolder there should be several files:</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-106.3pt'>logo.png ………………..
 the logo to appear in the MNova plot.</p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-106.3pt'>protocol.mnova
….…  the MNova layout template for this experiment.</p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-106.3pt'>protocol.mnp ……..…
 the MNova processing template for this experiment.</p>

<p class=MsoNormal style='margin-left:4.0cm;text-indent:-106.3pt'>protocol.qs ……………
  a script file detailing how MNNova should handle the various files present in
the data directory.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In this list ‘protocol’ is the name of the experiment (e.g.
Proton or COSY).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>It is beyond the scope of this
document to describe the details of the .qs script file, but the easiest way to
get this working is to use the option ‘New pulse program from existing file’ in
the Pulse program editor and compiler interface. This will copy any existing
MNova folder and will update the names of the MNova files. If you have chosen a
similar experiment to duplicate, the MNnova export might work without any
changes.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading7 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569919"></a><a name="_Toc183532031"></a><a name="APPENDIX_C"></a>Appendix
M<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>An introduction to Prospa programming</p>

<p class=MsoNormal style='margin-left:63.8pt;text-indent:-63.8pt'><span
style='font-size:13.0pt;font-family:"Arial",sans-serif;color:#4F81BD'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>The entire SpinsolveExpert
application is built on top of the Prospa programming environment. This is
based around an interpreted language which is similar to Matlab, but with some significant
differences.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>When Prospa starts up it runs a script or macro which
defines the user interface. If you run Prospa directly from the application folder,
you will see an interface like this:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=602
height=471 id="Picture 182"
src="Pulse%20Programming%20Guide%20(FX3)_files/image035.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This consists of separate windows with simple functionality
– a 1D plot, an editor and a command line interface. More complex interfaces
can be designed (like SpinsolveExpert) which integrate these objects into the
one window. (Also see the Layout menu for other possibilities).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The scripting langage is quite complex consisting of over 500
built in commands and  more than 20 data types. However for the purposes of
using the SpinsolveExpert interface only a fraction of these are needed. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569920"></a><a name="_Toc183532032">M.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Data types</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The most important data types are:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>string  ...................   double
quoted text-based strings which may include escape characters. </p>

<p class=MsoNormal style='margin-left:99.25pt'>Example: &quot;A filename&quot;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>list ........................
  arrays of strings. e.g<span style='font-size:10.0pt;font-family:"Courier New"'>
[&quot;string1&quot;,&quot;string2&quot;,&quot;string3&quot;]</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>list2d . ..................
  jagged arrays of lists e.g.<span style='font-size:10.0pt;font-family:"Courier New"'>
[&quot;string11&quot;,&quot;string12&quot;, ... ;
&quot;string21&quot;,&quot;string22&quot;, ...]</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>float .. ...................
  4 byte floating point numbers (the default number type) e.g. 3.14159</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>double ..................   
8 byte floating point number e.g. 3.1415926535897931d</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>structure
...............  a linked list of variables. e.g.  <span style='font-size:10.0pt;
font-family:"Courier New"'>s = struct(a=23, b = [1:10], c = &quot;This is a
test&quot;)</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'><span
style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>class
......................   like a structure but also support functions or
procedures.</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>structure_array
....   an array of structures e.g.  <span style='font-size:10.0pt;font-family:
"Courier New"'>s = struct(a=23, b = [1:10]; c = &quot;This is a test&quot;, d=
2+3j; e = &quot;_Another string&quot;_, f = pi)</span></p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>vector ...................
  1D matrices - arrays of floats or doubles e.g. [1,2,3,4] </p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>matrix ...................
  2, 3 or 4 dimensional arrays of floats or doubles e.g. [1,2,3,4;5,6,7,8]</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:99.25pt;text-indent:-99.25pt'>objects ..................
 user interface objects such as plots or text boxes. These can be interrogated
to extract or set various parameters.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569921"></a><a name="_Toc183532033">M.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Variables</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Data values are stored in variables. This is done using an
assignment statement e.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>myVector
= [1,2,3,4]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Note that the vector name can be any length (although
shorter names are interpreted faster), are case sensitive, and may include
numbers as long as the resultant name is not a valid number. (So 1Pulse is a
valid variable name!)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Variables can be collected together in structures. To define
a structure, use the syntax</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>s =
struct()</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>s-&gt;pi
= 3.1415926</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>s-&gt;vec
= [1,2,3,4,5]</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal>or more simply</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>s =
struct(pi=3.1415926, vec=[1,2,3,4,5])</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>in a procedure, local variables can be converted to a list
using the command:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>lst
= mkparlist()</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This takes all local variables (see below) and packs them
into a string  list. Note that you can't include objects or 3D or 4D matrices
in list. Other matrices should be small. The alternative which does allow this
is a structure (mkparstruct).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To convert a string list into local variables use the
reverse command</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>assignlist(lst)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>This also works for structures.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Variables defined on the command
line interface have global scope (i.e. they are accessible everywhere.)
Variables defined inside a procedure (see below) have local scope and are only
accessible from within the procedure. It is also possible to have variables
with window scope which are accessible from all children of the parent window. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569922"></a><a name="_Toc183532034">M.3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Control statements</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal> Prospa supports the following control statements. Syntax is
fairly standard.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>if-elseif-else-endif
</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>while-exitwhile-endwhile</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>for-exitfor-next</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Please refer to the Prospa documentation for details (type
F1 when the cursor is on the command).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569923"></a><a name="_Toc183532035">M.4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Procedures</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Prospa scripts are typically broken into procedures (i.e.
functions) which are blocks of code surrounded by the statements</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>procedure(name,
arguments)</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>...</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>endproc(return_values)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Note that multiple values can be returned from a procedure.
To exit early from a procedure use the return command.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To call a procedure from within the current file (which
should have the extension .mac – for macro or .pex for prospa executable
macro), use the following syntax</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>result
= :myProc(arg1, arg2)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To call a procedure in another file just add the filename</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>result
= filename:myProc(arg1,arg2)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The extension need not be included, as .mac (or .pex) is
assumed.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To return multiple values place them in parenthesis and use
commas to delimit them:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>(result1,result2)
= :procName(arg1,arg2,arg3)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>All variables defined in a procedure have local scope i.e.
they are not visible outside the procedure. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Please refer to the Prospa manual for more details about
using procedures.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569924"></a><a name="_Toc183532036">M.5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Commands</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Some 500 predefined commands are
included in the Prospa package. A list can be obtained using the <span
style='font-size:11.0pt;font-family:"Courier New"'>listcom</span> command. These
commands are written in C++ and so are generally much faster than using
explicit low level prospa commands. Check the help viewer accessible from the
Help menu to see a list of these.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The syntax is exactly as it is for procedures</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>result
<a name="OLE_LINK42"></a><a name="OLE_LINK43">= command(arg1, arg2, ...)</a></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>or</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>(result1,result2
...)  = command(arg1, arg2, ...)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>These commands include functions to manipulate data types,
access the file system and build user interfaces.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569925"></a><a name="_Toc183532037">M.6<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Debugging</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>You can test the various commands and syntax by typing them
into the command line interface. Use the print (pr) command to print results.
e.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:11.0pt;
font-family:"Courier New"'>&gt; a = 2^4</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:11.0pt;
font-family:"Courier New"'>&gt; pr a</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:11.0pt;
font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:11.0pt;
font-family:"Courier New"'>   a = 16</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569926"></a><a name="_Toc183532038">M.7<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Expressions</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Commands, variables and procedures may be combined in
expressions where the syntax is valid. e.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>magnitude
= sqrt(x^2+y^2)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Standard mathematical precedence
is followed. Note that if a command with multiple return values appears in the
expression only the first return value is used. If you want to extract the nth
returned value use the <i>retvar</i> command (1 based).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569927"></a><a name="_Toc183532039">M.8<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Matrices and vectors</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Both real and complex vectors and matrices can be defined.
To define a blank matrix of dimensions 1,2,3,4 use the following synax</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=DE style='font-size:11.0pt;font-family:"Courier New"'>mat
= matrix(dim1, dim2, dim3, dim4)</span></p>

<p class=MsoNormal><span lang=DE>&nbsp;</span></p>

<p class=MsoNormal>Where dimx is the size of the xth dimension. Note that for 2
and 3D matrices the dimension order is x, y, z <b><i>not</i></b> row, col ,
depth as it is in Matlab and other languages. This syntax is also used when
accessing elements</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>result
= mat[x,y,z].</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To define a linear 1D vector use the following syntax</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>result
= [start:step:end] (step is optional)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>or </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>resut
= linspace(start,end,number)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To access the first element use the index <b><i>0</i></b>
while to access last element use the index <b><i>-1</i></b> (the second to last
-2 etc). e.g</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>lastValue
= vec[-1]</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To access some elements in the vector use this syntax</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>subvector = vec[start:step:end] </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This will include all values in ‘vec’ between indicies start
and end but with a ‘step’ between each value. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>All elements in one dimension can be signified with a tilde
‘~’ or colon ‘:’ e.g. to extract the yth row from a 2D matrix:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>row = mat[~,y]</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To get the dimensions of a matrix use the size command</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>(width,
height) = size(mat)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569928"></a><a name="_Toc183532040">M.9<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>User interface objects</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>User interface ojbects such as buttons, text boxes, plots
etc. can be assigned to object variables. They can then be used to access
functions and variables embedded in the objects.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Access is done via the arrow operator e.g. for the
SpinsolveExpert interface</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>plt1
= gView-&gt;g1-&gt;subplot(1,1)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>plt1-&gt;plot(x,y)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>(x,y)
= plt1-&gt;getdata()</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The first command access the first plot in the Expert
interface which is defined in the gView class instance. The second command
plots the x-y pair in the first region plt1 of plot/graph control g1. The third
command extracts the x-y data from the plot.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To see the commands and variables available for an object
just type the object name into the command line interface. Help is also
available in the classes topic in the help viewer.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>&gt;
pr plt1</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black'>#### 1D plot-region object ####</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   PARAMETER           VALUE</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   antialiasing1d..... &quot;true&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   autorange ......... &quot;true&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   axes .............. object</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   bordercolor ....... [230,230,230]</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   bkgcolor .......... [255,255,255]</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   clear ............. cmd : clear all trace data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   dim ............... &quot;1d&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   draw .............. &quot;true&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   filename .......... &quot;image_section.pt1&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   filepath .......... &quot;C:\ ... \Example
Data\Plots\&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   fileversion ....... 1.4</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   getdata ........... cmd : extract (x,y) data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   grid .............. object</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   hold .............. &quot;false&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   load .............. cmd : load a pt1 file into
plot region</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   parent ............ control: 1</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   plot .............  cmd : display (x,y) data</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   position .......... (1,1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   border ............ &quot;true&quot;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   save .............. cmd : save plot region
contents to a pt1 file</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   trace ............. object</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   tracelist ......... cmd : return array of trace
id numbers</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   tracepref ......... cmd : set or get trace
drawing preferences</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   title ............. object</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   xlabel ............ object</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New"'>   ylabel ............ object</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;font-family:"Courier New"'>  
zoom .............. cmd : set viewing limits</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569929"></a><a name="_Toc183532041">M.10<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Using the Prospa text editor</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If you develop Prospa scripts inside the Prospa editor then
you will get some additional features compared with writing it in a simple
editor such as Notepad. A Prospa editor is available from the Expert Windows
menu. Here are some of the editor features:</p>

<p class=MsoNormal>&nbsp;</p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal>Syntax coloring. Different types of commands are colored
     differently.</li>
 <li class=MsoNormal>Syntax hints. As you type a command the valid arguments
     are listed in the editor status box.</li>
 <li class=MsoNormal>Help. Pressing F1 when the cursor is on a command will
     display detailed help and often an example.</li>
 <li class=MsoNormal>Procedure searching. Using the editor menus or keyboard
     shortcuts you can jump to and from Procedure code.</li>
 <li class=MsoNormal>Indenting and commenting. The editor menu has commands to
     rapdily comment and indent block of selected code.</li>
 <li class=MsoNormal>Code execution. Stand-alone macros in the editor can be
     executed using the shortcut Ctrl-R.</li>
</ol>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoHeading8 style='margin-left:0cm;text-indent:0cm'><a
name="_Toc32569930"></a><a name="_Toc183532042">M.11<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Additional help</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Additional Prospa help can be found in the document:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Prospa programming manual.pdf</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>These files can be found in the Expert/Prospa install
directory in the folder:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal> &quot;PDF Documentation&quot;.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Help can be found in the Viewer found in the main Help menu.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-bottom:solid windowtext 1.5pt;padding:0cm 0cm 1.0pt 0cm'>

<p class=MsoNormal style='border:none;padding:0cm'>&nbsp;</p>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Last modified 25-November-2024 by Craig Eccles</p>

</div>

<div><br clear=all>

<hr align=left size=1 width="33%">

<div id=ftn1>

<p class=MsoFootnoteText><a href="#_ftnref1" name="_ftn1" title=""><span
class=MsoFootnoteReference><span class=MsoFootnoteReference><span
style='font-size:10.0pt;font-family:"Calibri",sans-serif'>[1]</span></span></span></a>
<span lang=EN-US>A 1D list can be used, but it requires two addition parameters
per row which are only used in the V3 legacy interface. Some experiments still
use the 1D list.</span></p>

</div>

<div id=ftn2>

<p class=MsoFootnoteText><a href="#_ftnref2" name="_ftn2" title=""><span
class=MsoFootnoteReference><span class=MsoFootnoteReference><span
style='font-size:10.0pt;font-family:"Calibri",sans-serif'>[2]</span></span></span></a>
<span lang=EN-US>See the pulse program commands section.</span></p>

</div>

</div>

</body>

</html>
