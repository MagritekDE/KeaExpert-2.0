<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="importData_files/filelist.xml">
<link rel=Edit-Time-Data href="importData_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>baselineCorrection</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	background:#FF6600;
	font-size:20.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-GB link=blue vlink=purple style='tab-interval:36.0pt'>

<div class=Section1>

<h1><span class=SpellE><span class=GramE><span lang=EN-NZ style='mso-ansi-language:
EN-NZ'>importData</span></span></span></h1>

<p class=MsoNormal><span lang=EN-NZ style='mso-ansi-language:EN-NZ'>&nbsp;</span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>Although <span
class=SpellE>Prospa</span> provides an import facility that can read a variety
of the formats, it is inconvenient to use this on a routine basis for
processing NMR data. This is because it is necessary to enter the relevant file
dimensions, data type etc. each time the data is loaded. A better approach is
to read the native spectrometer information that is stored with the data set
and extract the necessary information from this source. In those cases where
this is not possible, another approach is to manually determine the file
parameters and then store sufficient information with the data set to allow <span
class=SpellE>Prospa</span> to import it automatically. The macro <span
class=SpellE>importData</span> provides both of these possibilities.</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><i><span
lang=EN-US style='mso-ansi-language:EN-US'>Import file organization</span></i><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>On the
computer running <span class=SpellE>Prospa</span>, data files should be stored
so that there is one data set per folder (this organization is typically used
on spectrometers as well). The folder's name should reflect the data contents.
Within this folder there will be the data file itself which may have a variety
of names (<span class=SpellE>eg</span>. fid, ser, <span class=GramE>data</span>)
depending on the spectrometer manufacture. In addition, there will be the
manufacturer's parameter files. Based on the files present in this folder <span
class=SpellE>importData</span> will make a guess at the type of data file
present. Currently <span class=SpellE>Prospa</span> can recognize file types
from <span class=SpellE>Bruker</span>, Varian and Resonance Instruments in
addition to <span class=SpellE><span class=GramE>Prospa</span></span> native
files. </span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>When
opening the <span class=SpellE>importData</span> macro the first step is to set
the working directory to a folder that contains the data set folders you are
interested in. Do this by clicking on control #3 (see below). The contents of
this directory will then appear in <span class=SpellE>listbox</span> #4. Note
that the working directory is stored in the global variable “<span
class=SpellE>workdir</span>”, which is saved each time <span class=SpellE>Prospa</span>
exits. Any folder in this directory which contains a recognized data file will
show a <span class=SpellE><span class=GramE>Prospa</span></span> symbol over
the folder icon. Single clicking on this folder will cause the file parameters
to be loaded into the remaining window controls. Double clicking on the folder
icon will load the parameters and then load the data set.</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal align=center style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
auto;text-align:center'><span lang=EN-US style='mso-ansi-language:EN-US'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" alt="" style='width:302.25pt;
 height:260.25pt'>
 <v:imagedata src="importData_files/image001.jpg" o:href="../../NMRI%20Macros_files/image005.jpg"/>
</v:shape><![endif]--><![if !vml]><img width=403 height=347
src="importData_files/image001.jpg" border=0 v:shapes="_x0000_i1025"><![endif]></span><o:p></o:p></p>

<p class=MsoNormal align=center style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
auto;text-align:center'><span class=SpellE><span class=GramE><i><span
lang=EN-US style='font-size:10.0pt;mso-ansi-language:EN-US'>importData</span></i></span></span><i><span
lang=EN-US style='font-size:10.0pt;mso-ansi-language:EN-US'> window</span></i><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal align=center style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
auto;text-align:center'><span lang=EN-US style='mso-ansi-language:EN-US'><!--[if gte vml 1]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" alt="" style='width:302.25pt;height:260.25pt'>
 <v:imagedata src="importData_files/image002.jpg" o:href="../../NMRI%20Macros_files/image006.jpg"/>
</v:shape><![endif]--><![if !vml]><img width=403 height=347
src="importData_files/image002.jpg" border=0 v:shapes="_x0000_i1026"><![endif]></span><o:p></o:p></p>

<p class=MsoNormal align=center style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
auto;text-align:center'><span class=SpellE><span class=GramE><i><span
lang=EN-US style='font-size:10.0pt;mso-ansi-language:EN-US'>importData</span></i></span></span><i><span
lang=EN-US style='font-size:10.0pt;mso-ansi-language:EN-US'> window with
control numbers</span></i><o:p></o:p></p>

<p class=MsoNormal align=center style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
auto;text-align:center'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>The
“Current path” field (control #37) displays the current location of the data
set relative to the working directory (since it is possible to navigate
independently of the &quot;Working directory” control #3 by using the list box
control #4. Double clicking on a folder which contains subfolders will move
into them while double clicking on the folder marked “<span class=GramE>..”</span>
will move up a level.)</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>Following is a brief description of
each of the window controls (including the control number in brackets):</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=151 valign=top style='width:4.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Name (6)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Sequence (23)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Native load (45)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Type (8)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Real (34)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Bytes (10)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>1Dim-4Dim (28<span class=GramE>..)</span></span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Size (12<span class=GramE>..)</span></span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Matrix (19)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Display (21)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Auto-load (32)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Load (20)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Help (40)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Close (44)</span><o:p></o:p></p>
  </td>
  <td width=614 valign=top style='width:460.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>displays</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> the contents of the title or text
  file stored with the data set.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>the</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> name of the pulse sequence used
  to acquire the data.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>if checked use native parameter
  file if possible – otherwise use <span class=SpellE>exp.par</span> file</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>type</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> of file (usually the spectrometer
  type).</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>whether</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> the data set is real or complex.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>the</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> number of bytes in the file (this
  includes any headers).</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>description</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> for each axis – this is something
  you can add.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>dimensions</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> for each axis (the number of
  complex or real points).</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>name</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> to give the loaded data set –
  this will be a globally accessible variable.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>if</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> checked, then the data set will
  be automatically displayed when loaded.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>if</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> checked, data can be loaded by
  single clicking on valid data sets.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>this</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> will load (and perhaps display)
  the data set currently selected.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>displays</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> this help file.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>closes</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> the import window.</span><o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>In most
cases you will not have to enter any information yourself since all the
necessary parameters are already present. However, you may wish to modify the
default matrix name and enter axes descriptions before loading. To ensure that
this information is not lost when you exit the program all the loaded
parameters are stored to a new file called <span class=SpellE>exp.par</span>
(stored with the data set) as soon as the file has been loaded. This file will
be used in preference to the manufacturer's parameter information the next time
data is loaded. (This process is also faster than reading the manufacturer's
information since this is often scattered over several files). You can force
the macro to load from the spectrometer parameter file by selecting the
&quot;Load using native parameters&quot; check box (control #45). Note that
this will have no effect if the only valid parameter file present is <span
class=SpellE>exp.par</span>. The actual parameter file source used by the macro
is reported in the status control (#25) after selecting a data set name.</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>An example
<span class=SpellE>exp.par</span> file is shown below:</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=170 valign=top style='width:127.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=SpellE><span lang=EN-US style='mso-ansi-language:EN-US'>matrixIn</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> = &quot;flow3D&quot;</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=GramE><span lang=EN-US style='mso-ansi-language:EN-US'>experiment</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> = &quot;???&quot;</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=SpellE><span lang=EN-US style='mso-ansi-language:EN-US'>fileType</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> = &quot;AMX&quot;</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  class=SpellE><span lang=EN-US style='mso-ansi-language:EN-US'>nrType</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'> = &quot;complex&quot;</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>1dtype = &quot;<span class=SpellE>kx</span>&quot;</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>2dtype = &quot;<span class=SpellE>ky</span>&quot;</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>3dtype = &quot;q&quot;</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>1dim = 128</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>2dim = 128</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>3dim = 8</span><o:p></o:p></p>
  </td>
  <td width=595 valign=top style='width:446.5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Name of matrix to store imported
  data set</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Name of pulse sequence used to
  acquire this data.</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Type of data set (source)</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Data is complex</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Name of first dimension</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Name of second dimension</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Name of third dimension</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>First dimension (width) size</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Second dimension (height) size</span><o:p></o:p></p>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
  lang=EN-US style='mso-ansi-language:EN-US'>Third dimension (depth) size</span><o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>These
names (<span class=SpellE>matrixIn</span>, experiment, <span class=SpellE>fileType</span>
etc) are important since they match the names of the corresponding controls in
the <span class=SpellE>importData</span> window. In this way, the controls are
automatically populated using the following macro commands:</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
class=SpellE><span class=GramE><span lang=EN-US style='font-size:10.0pt;
font-family:"Courier New";color:black;mso-ansi-language:EN-US'>guiPar</span></span></span><span
lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
mso-ansi-language:EN-US'> = load(&quot;<span class=SpellE>exp.par</span>&quot;)</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
class=SpellE><span class=GramE><span lang=EN-US style='font-size:10.0pt;
font-family:"Courier New";color:black;mso-ansi-language:EN-US'>setctrlvalues</span></span></span><span
class=GramE><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
color:black;mso-ansi-language:EN-US'>(</span></span><span lang=EN-US
style='font-size:10.0pt;font-family:"Courier New";color:black;mso-ansi-language:
EN-US'>0,guiPar)</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>For this reason you should not
modify the parameter names in the <span class=SpellE>exp.par</span> file.</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><i><span
lang=EN-US style='mso-ansi-language:EN-US'>Removing unwanted file types</span></i><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>If you
only wish to load certain types of files you can speed up the importing process
by removing unwanted import macros from the folder &quot;$<span class=SpellE>appdir$\Macros\NMRI\ImportData</span>
Macros&quot;. These macros contain detailed information about how to read in
each file type. </span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><i><span
lang=EN-US style='mso-ansi-language:EN-US'>Loading known data sets which don't
have parameter files.</span></i><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>If you
have a raw data set from a manufacturer supported by <span class=SpellE>importData</span>
but have lost the parameter files, you can still load it with this macro.
Simply place the data set in a folder, navigate to the folder using <span
class=SpellE>importData</span> and then enter the file information manually
into the <span class=SpellE>importData</span> window before pressing the load
button. If the entered parameters are correct, the data set will be loaded,
displayed and an <span class=SpellE>exp.par</span> file generated so that next
time you load it you will<span class=GramE>&nbsp; not</span> have to enter the
parameters yourself. You many need to apply a bit of trial and error to load
the data set correctly, but often you can guess the file dimensions product
from the number of bytes in the file. (Most time domain data sets require 8
bytes per complex point). For multidimensional data sets you can usually
determine the number of data points per row by inspection once a 2D plane has
been displayed</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
class=GramE><i><span lang=EN-US style='mso-ansi-language:EN-US'>Modifying <span
class=SpellE>importData</span> to handle new data <span class=SpellE>tyes</span>.</span></i></span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-align:justify'><span lang=EN-US style='mso-ansi-language:EN-US'>In some
cases it is necessary to load data from a source unknown to <span class=SpellE>importData</span>.
Normally you would do this using the import facility in the <span class=SpellE><span
class=GramE>Prospa</span></span> file menu. In this case it is necessary to
have detailed knowledge of the file format. (<span class=GramE>i.e</span>. byte
order, number type, matrix dimensions). If you are importing files on a regular
basis this can be a tedious process. <span class=GramE>However in many cases it
will be possible to add a new import macro file to the folder &quot;$<span
class=SpellE>appdir$\Macros\NMRI\ImportData</span> Macros&quot; so that these
data set can be loaded automatically.</span> Have a look at the example <span
class=SpellE>FloatBigEndian.mac</span> or alternatively contact <span
class=SpellE>magritek</span> for more information on how to do this.</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><i><span
lang=EN-US style='mso-ansi-language:EN-US'>4D dimensional data set support</span></i><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>Current support for 4D data sets is
limited – this will be addressed in upcoming versions of <span class=SpellE>Prospa</span>.</span><o:p></o:p></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-US
style='mso-ansi-language:EN-US'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

</div>

</body>

</html>
