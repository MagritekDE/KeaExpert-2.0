<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 11 (filtered)">
<title>baselineCorrection</title>

<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
h1
	{margin:0cm;
	margin-bottom:.0001pt;
	background:#FF6600;
	font-size:20.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-GB link=blue vlink=purple>

<div class=Section1>

<h1><span lang=EN-NZ>nDFourierTransform</span></h1>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>Perhaps the
first step in processing imported NMR data will be to Fourier transform it - e.g.
convert from the time to frequency or spatial frequency to real space domains.
This macro is designed to handle 1D, 2D or 3D data sets and can transform each
axis in a different way depending on how the data was collected. In addition,
the dataset can be zero-filled and apodized with a range of filters.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The FT macro can
process data that has been loaded using the importData macro, but it can also
process data which has come from some other sources.</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Following is an example of this macro in
use with the flow data set </span><span lang=EN-NZ style='color:black'>“Flow3D”
(load using importData)</span><span lang=EN-US>:</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=319 valign=top style='width:239.25pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><img width=366 height=265
  src="nDFourierTransform_files/image001.jpg" border=0></span></p>
  </td>
  <td width=319 valign=top style='width:239.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><img width=366 height=265
  src="nDFourierTransform_files/image002.jpg" border=0></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The first step
in using this macro is to choose the input matrix dimension (in this case 3D)
from control #2. Once chosen, all matrices of that dimension will appear in the
textmenu (control #8). Choosing a matrix from this menu will update the size
fields and suggest an output file name (flow3DFt), FFT type, filters and
dimensions. </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>In the “Fourier
Transformation” box the axes names (controls #3, 4 &amp; 5) default to kx, ky
and kz. They are only included to remind you of the data type in each
dimension. (In the case of data imported from the ImportData macro this
information is included in the parameter list).</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The “Type” field
(#20, 21, 22) refers to the whether the </span><span lang=EN-NZ>centre</span><span
lang=EN-US> of k space is at the origin (index 0) or the </span><span
lang=EN-NZ>centre</span><span lang=EN-US> of the input data set. The former
would be the case for a pulse and collect FID type experiment, while the latter
would be expected in the case of a spin-echo that had its maximum in the </span><span
lang=EN-NZ>centre</span><span lang=EN-US> of the data set. A type of “none”
means that no Fourier transform will be applied in this dimension.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The output
matrix can be made larger than the input matrix by selecting from the list of
numbers in the drop down menus in the Output matrix box. (controls 29, 30 and
31). This provides zero-filling after the apodization filter has been applied.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The
&quot;Filter&quot; field (controls 24, 25 and 26) multiplies kx, ky, or kz data
by a function which enhances certain spatial frequencies but attenuates others.
There are 6 supplied filters or apodization functions. The filters are listed
below along with examples for peak = N/2, width=N/4 and nodes = 2. </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-US>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=472 valign=top style='width:354.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>Exponential
  ......&nbsp; <sub><img width=180 height=27
  src="nDFourierTransform_files/image003.gif" border=0></sub></span></p>
  </td>
  <td width=176 valign=top style='width:132.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><img width=162 height=34
  src="nDFourierTransform_files/image004.gif" border=0></span></p>
  </td>
 </tr>
 <tr>
  <td width=472 valign=top style='width:354.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>Gaussian
  ......... <sub><img width=200 height=25
  src="nDFourierTransform_files/image005.gif" border=0></sub></span></p>
  </td>
  <td width=176 valign=top style='width:132.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><img width=161 height=34
  src="nDFourierTransform_files/image006.gif" border=0></span></p>
  </td>
 </tr>
 <tr>
  <td width=472 valign=top style='width:354.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>Sinebell
  ......... <sub><img width=236 height=23
  src="nDFourierTransform_files/image007.gif" border=0></sub></span></p>
  </td>
  <td width=176 valign=top style='width:132.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><img width=161 height=34
  src="nDFourierTransform_files/image008.gif" border=0></span></p>
  </td>
 </tr>
 <tr>
  <td width=472 valign=top style='width:354.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>Sinebellsquared
  .. <sub><img width=244 height=24 src="nDFourierTransform_files/image009.gif"
  border=0></sub></span></p>
  </td>
  <td width=176 valign=top style='width:132.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><img width=161 height=34
  src="nDFourierTransform_files/image010.gif" border=0></span></p>
  </td>
 </tr>
 <tr>
  <td width=472 valign=top style='width:354.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>Vee
  .............. <sub><img width=104 height=21
  src="nDFourierTransform_files/image011.gif" border=0></sub></span></p>
  </td>
  <td width=176 valign=top style='width:132.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=RU><img width=161 height=34
  src="nDFourierTransform_files/image012.jpg" border=0></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>With data
collected in which the centre of k space is a maximum, filters of the above
form (apart from Vee!) would be appropriate since they emphasis low frequencies
where the signal is strong and attenuate high frequencies where the signal is
weak and noise dominates.</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>The parameters peak and width can be
modified by pressing the button labeled “Filter Parameters” (control 41).</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=396 valign=top style='width:297.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-US><img
  width=290 height=317 src="nDFourierTransform_files/image013.jpg" border=0></span></p>
  </td>
  <td width=378 valign=top style='width:10.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-US><img
  width=290 height=317 src="nDFourierTransform_files/image014.jpg" border=0></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>The Filter
designer allows you to produce new apodization functions or modify existing
ones. To use the Filter design to modify an existing filter, first double click
on the filter name in list box #2. The function name and equation will appear
in text boxes 8 and 11 respectively. For each filter there can be up to 3
parameters which can be modified; p1, p2 and p3. These parameters can be
constants or expressions which can include the constant N; the number of points
used in the filter function. x is a vector with N integer values ranging from 0
to N-1.</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-US>Once you have
modified the filter you can test it by pressing one of the “Test” buttons - the
filter function will then appear in the 1D window. If you are satisfied with
the filter, press the Update button to copy the filter back to the main Filter
list (as it appears in control #2). Finally, press the Save button (#3) to copy
the modified list to a file. Press Load to copy the current file back into the
macro and overwrite any modifications you have made. </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><i><span lang=EN-NZ style='color:black'>Example</span></i><span
lang=EN-NZ style='color:black'> input and output using the Fourier transform
macro with the data stored in “Flow3D” (load using importData).</span></p>

<p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=139 valign=top style='width:104.4pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ
  style='font-size:11.0pt;color:black'>One of the k-space input files.</span></p>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ
  style='color:black'>&nbsp;</span></p>
  </td>
  <td width=179 valign=top style='width:134.5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span lang=RU><img
  width=164 height=164 src="nDFourierTransform_files/image015.jpg" border=0></span></p>
  </td>
  <td width=140 valign=top style='width:105.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ
  style='font-size:11.0pt;color:black'>The corresponding plane from the
  transformed 3D data set.</span></p>
  </td>
  <td width=179 valign=top style='width:134.55pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span lang=RU><img
  width=157 height=157 src="nDFourierTransform_files/image016.jpg" border=0></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
