<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 11 (filtered)">
<title>ß The Window Designer macro | </title>
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
@page Section1
	{size:21.0cm 842.0pt;
	margin:72.0pt 89.85pt 72.0pt 89.85pt;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=EN-GB link=blue vlink=purple>

<div class=Section1>

<p class=MsoNormal style='background:#FF6600'><b><span lang=EN-NZ
style='font-size:20.0pt'>Editing the Window</span></b></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i><span style='font-size:11.0pt'>&nbsp;</span></i></p>

<p class=MsoNormal><a name=callbackProcedures></a><i><span lang=EN-NZ
style='font-size:13.0pt'>Call-back procedures</span></i></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Once you have
designed your graphical user interface you will need to add call-back
procedures for each of the controls in the window. A call-back procedure
contains the commands that will be run each time the control is activated (e.g.
a button pressed or a slider dragged). These procedures can be appended to the
control definition command, but more conveniently can be placed in a separate
procedure if they are complex.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><a name=makingNewWindow></a><i><span
lang=EN-NZ style='font-size:13.0pt'>Saving a new window</span></i></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The first step is
to save the new window. Make sure it is in edit mode and then press the “save”
button in the “Dialog macro files” section of the designer window. Select a
filename for the new window definition and save it. The next step is to
manually edit the window definition macro. Press the “view” button in the files
section of the window designer and select the window macro you have just saved.
If the designer is no longer running, select the window macro from the
&quot;Open macro&quot; menu option in the text editor file menu or double-click
on the gui window while the shift-key is held down. What will appear in the
edit window will be the instructions to generate the window, but no call-back
procedures. For example the following window, consisting of a button, some
static text and a slider is shown below along with the macro that generates it:</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=215 valign=top style='width:161.35pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-NZ><img width=225 height=175
  src="Editing%20the%20window_files/image001.jpg"></span></p>
  <p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-NZ>Note that the window definition is placed
  in its own procedure. This is done to allow re-editing of the window without
  disturbing the rest of the macro.</span></p>
  </td>
  <td width=353 valign=top style='width:264.75pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
  8.5pt;font-family:"Courier New";color:black'>(test)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp; n = </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:teal'>:windowdefinition</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>()</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>showwindow</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(n)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:blue'>endproc</span><span style='font-size:
  8.5pt;font-family:"Courier New";color:black'>()</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
  8.5pt;font-family:"Courier New";color:black'>(windowdefinition)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp; n = </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>window</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:gray'>&quot;test&quot;</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>, 100, 100,
  225, 149)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:#AA0000'># Define all
  controls with basic parameters</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>button</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(1, 24, 17, 58,
  29, </span><span style='font-size:8.5pt;font-family:"Courier New";color:gray'>&quot;Press
  me&quot;</span><span style='font-size:8.5pt;font-family:"Courier New";
  color:black'>)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>slider</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(2, 81, 68,
  100, 20, </span><span style='font-size:8.5pt;font-family:"Courier New";
  color:gray'>&quot;horizontal&quot;</span><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>statictext</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(3, 36, 70, </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:gray'>&quot;left&quot;</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>, </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:gray'>&quot;Drag
  me&quot;</span><span style='font-size:8.5pt;font-family:"Courier New";
  color:black'>)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>statusbox</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(4)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:#AA0000'># Set other
  control parameters</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>setpar</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(n,1,</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>,1)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:8.5pt;font-family:"Courier New";color:green'>setpar</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>(n,2,</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
  style='font-size:8.5pt;font-family:"Courier New";color:black'>,2)</span></p>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:8.5pt;
  font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span style='font-size:8.5pt;font-family:"Courier New";
  color:blue'>endproc</span><span style='font-size:8.5pt;font-family:"Courier New";
  color:black'>(n)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The name of this
procedure – <i>windowdefinition</i> should <i>not</i> be changed, otherwise you
will not be able to edit the window using the designer macro.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The <i>windowdefinition</i>
procedure consists of the commands to generate the window, commands to generate
controls in that window and then additional commands which set optional
parameters (in this case the tab order). When controls are defined they are by
default added to the last created window.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The main
procedure – the one first called when you run this macro (‘test” in this case),
calls the <i>windowdefinition</i> procedure and then displays the window and
its contents using the <i>showwindow</i> command. Note that the window command
hides the window by default so that all its controls can be added and modified
before they are made visible.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><a name=addingCallBacks></a><i><span
lang=EN-NZ>Adding call-back procedures</span></i></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The call-back
procedures for the button and slider are added at the end of each argument
list. There can be any number of commands in the procedures but each command <i>must</i>
be terminated with a semicolon. An example is given below:</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:9.5pt;font-family:"Courier New";color:green'>button</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>(1, 24, 17, 58, 29,
</span><span style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;Press
me&quot;</span><span style='font-size:9.5pt;font-family:"Courier New";
color:black'>, </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:9.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>(0,4,</span><span
style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;text&quot;</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;Button
pressed!&quot;</span><span style='font-size:9.5pt;font-family:"Courier New";
color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:9.5pt;font-family:"Courier New";color:green'>slider</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>(2, 81, 68, 100,
20, </span><span style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;horizontal&quot;</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
position = </span><span style='font-size:9.5pt;font-family:"Courier New";
color:green'>getpar</span><span style='font-size:9.5pt;font-family:"Courier New";
color:black'>(0,2,</span><span style='font-size:9.5pt;font-family:"Courier New";
color:gray'>&quot;value&quot;</span><span style='font-size:9.5pt;font-family:
"Courier New";color:black'>);</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style='font-size:9.5pt;
font-family:"Courier New";color:green'>setpar</span><span style='font-size:
9.5pt;font-family:"Courier New";color:black'>(0,4,</span><span
style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;text&quot;</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;Slider
position = $position$&quot;</span><span style='font-size:9.5pt;font-family:
"Courier New";color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:9.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:9.5pt;font-family:"Courier New";color:green'>statictext</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>(3, 36, 70, </span><span
style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;left&quot;</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;Drag
me&quot;</span><span style='font-size:9.5pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span style='font-size:9.5pt;
font-family:"Courier New";color:green'>statusbox</span><span style='font-size:
9.5pt;font-family:"Courier New";color:black'>(4)</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span style='font-size:9.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Note that a
command list can appear on multiple lines. (Normally a new line or a semicolon
ends a command).</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>When this macro
is run the window is generated as before, however when you press the button, a
message is now printed to the status bar, and when you drag the slider the
current slider position is reported.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ><img
width=225 height=175 src="Editing%20the%20window_files/image002.jpg"></span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name=gettingSettingParameters></a><i><span lang=EN-NZ>Getting
and setting control parameters</span></i></p>

<p class=MsoNormal><i><span lang=EN-NZ>&nbsp;</span></i></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The previous
macro illustrated an important feature of the callback procedures - extracting
current values from controls. To obtain the current text or value of a control
you will use the </span><span lang=EN-NZ style='font-size:10.0pt;font-family:
"Courier New"'>getpar</span><span lang=EN-NZ> (get parameter) command. The
first argument to this command is the window number of the command (as returned
by the window command). Since this number may in fact be difficult to access
from the macro level, you should usually just substitute zero (although the
command </span><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>guiwinnr</span><span
lang=EN-NZ> can be used to access it if necessary). The </span><span
lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>getpar</span><span
lang=EN-NZ> command will then know to use the current window number (that is
the window which has last been selected by the user). The next argument is the
control or object number, this is the first number in the control command - for
example in this window the slider is control number 2. (You can find this
number by choosing the “Show control numbers” option from the gui window
context menu). The next argument specifies the parameter to get from the
object. Normally it is either the </span><span lang=EN-NZ style='font-size:
10.0pt;font-family:"Courier New"'>&quot;text&quot;</span><span lang=EN-NZ> (a
string) or the </span><span lang=EN-NZ style='font-size:10.0pt;font-family:
"Courier New"'>&quot;value&quot;</span><span lang=EN-NZ> (a number). So for
example the command</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>position</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'> = </span><span
style='font-size:9.5pt;font-family:"Courier New";color:green'>getpar</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>(0,2,</span><span
style='font-size:9.5pt;font-family:"Courier New";color:gray'>&quot;value&quot;</span><span
style='font-size:9.5pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>will extract the current slider position
from slider control 2 and place it in the variable </span><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>position</span><span
lang=EN-NZ>. Likewise</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>label = </span><span style='font-size:10.5pt;font-family:"Courier New";
color:green'>getpar</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(2,3,</span><span style='font-size:10.5pt;font-family:"Courier New";
color:gray'>&quot;text&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>)</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>will return the static text label
&quot;Drag me&quot; storing it in variable </span><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>label.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>For a full list
of the possible parameters which can be extracted from different controls, see
the Prospa help file &quot;Command help&quot; and commands getpar and setpar.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name=windowVariables></a><i><span lang=EN-NZ>Using window
variables</span></i></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>It is important
to realise that all variables defined in the call-back procedures are local and
are not available to other call-back procedures in the window or the main
macro. However you <i>can</i> define variables that are accessible to <i>all</i>
callback procedures. These are called <i>window variables</i> and should be
declared as such <i>after</i> the window has been created with the window
command. An example is shown below. Here the variable </span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>position</span><span
lang=EN-NZ> is declared after the window has been defined and is initialised to
zero by reading the current slider position.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(testa)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; n = </span><span
style='font-size:10.5pt;font-family:"Courier New";color:teal'>:windowdefinition</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>showwindow</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>windowvar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(position)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; position = </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>getpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,2,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;value&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.5pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>()</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(windowdefinition)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; n = </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>window</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;test&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>, 100, 100, 225,
135)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:#AA0000'># Define all
controls with basic parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>button</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(1, 24, 17, 58,
29, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Press
me&quot;</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>, </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style='font-size:10.5pt;font-family:"Courier New";
color:green'>setpar</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(0,4,</span><span style='font-size:10.5pt;font-family:"Courier New";
color:gray'>&quot;text&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>,</span><span style='font-size:10.5pt;font-family:
"Courier New";color:gray'>&quot;Current position is $position$&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>slider</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(2, 81, 68, 100,
20, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;horizontal&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
position = </span><span style='font-size:10.5pt;font-family:"Courier New";
color:green'>getpar</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(0,2,</span><span style='font-size:10.5pt;font-family:"Courier New";
color:gray'>&quot;value&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(0,4,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;text&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Slider
position = $position$&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>statictext</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(3, 36, 70, </span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;left&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Drag
me&quot;</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>statusbox</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(4)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:#AA0000'># Set other
control parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,1,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,2,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,2)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.5pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(n)</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Note the order
in which the commands are run. The window definition is completed first, and
then the controls are generated. Next the window and all its controls are
displayed (</span><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>showwindow</span><span
lang=EN-NZ>). The variable </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>position</span><span lang=EN-NZ> is then declared
and initialised. The macro then exits. However the window still exists along
with its controls and so the final commands to be run are the call-back
procedures. (Note that the </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>windowvar</span><span lang=EN-NZ> command can appear
anywhere <i>after</i> the window is defined.)</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Normally you
should avoid using window variables since they can be rather confusing. It is
good programming practise to use local variables wherever possible, even if
more code is required. In this example the same functionality could have been
obtained by adding one more statement to the button control i.e.:</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(windowdefinition)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; n = </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>window</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;test&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>, 100, 100, 225,
135)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:#AA0000'># Define all
controls with basic parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>button</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(1, 24, 17, 58,
29, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Press
me&quot;</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>, </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;position = </span><span style='font-size:10.5pt;font-family:"Courier New";
color:green'>getpar</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(0,2,</span><span style='font-size:10.5pt;font-family:"Courier New";
color:gray'>&quot;value&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(0,4,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;text&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Current
position is $position$&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>slider</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(2, 81, 68, 100,
20, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;horizontal&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;position = </span><span style='font-size:10.5pt;font-family:"Courier New";
color:green'>getpar</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(0,2,</span><span style='font-size:10.5pt;font-family:"Courier New";
color:gray'>&quot;value&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(0,4,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;text&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Slider
position = $position$&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>statictext</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(3, 36, 70, </span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;left&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Drag
me&quot;</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>statusbox</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(4)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:#AA0000'># Set other
control parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,1,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,2,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,2)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>endproc</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(n)</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name=separateCallbacks></a><i><span lang=EN-NZ>Using
separate procedures for call-backs</span></i></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=319 valign=top style='width:239.4pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>If a large
  number of statements are likely to appear in the call-back procedure it
  improves readability to use a separate procedure rather than try and place
  all the commands directly in the control command. For example the following
  macro extends the previous code by adding a progress bar that displays the
  current slider position.</span></p>
  </td>
  <td width=249 valign=top style='width:186.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-NZ><img width=225 height=161
  src="Editing%20the%20window_files/image003.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(windowdefinition)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; n = </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>window</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;test&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>, 100, 100, 225,
135)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:#AA0000'># Define all
controls with basic parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>button</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(1, 24, 17, 58,
29, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Press
me&quot;</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
position = </span><span style='font-size:10.5pt;font-family:"Courier New";
color:green'>getpar</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(0,2,</span><span style='font-size:10.5pt;font-family:"Courier New";
color:gray'>&quot;value&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(0,4,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;text&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Current
position is $position$&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>slider</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(2, 69, 68, 100,
20, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;horizontal&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.5pt;font-family:"Courier New";color:teal'>:report</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>();)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>statictext</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(3, 24, 70, </span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;left&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Drag
me&quot;</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>statusbox</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(4)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>progressbar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(5, 187, 13, 16,
80, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;vertical&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:#AA0000'># Set other
control parameters</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,1,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,2,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;tab_number&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,2)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>endproc</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(n)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(</span><span style='font-size:
10.5pt;font-family:"Courier New";color:teal'>report</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; position = </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>getpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(0,2,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;value&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(0,4,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;text&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Slider
position = $position$&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(0,5,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;value&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,position)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>endproc</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The extra
control was added using the designer macro. The window &quot;test&quot; was
first displayed and then put into edit mode using the designer macro. The
progress bar then was added and the window macro resaved and redisplayed in the
editor. (<b>Note</b> be careful not to modify and save the <i>old</i> editor
code otherwise your gui changes will be overwritten). Finally using the editor,
the progress-bar direction, which defaults to horizontal, was set to vertical
and the dimensions set as required. </span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Note that
because the macro was already in existence, only the windowdefinition procedure
was overwritten during the editing process - the rest of the macro was
untouched.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Finally a new
procedure called &quot;report&quot; was added manually. This extracts the
slider position and uses this to update the status bar (control 4) and the
progress bar (control 5) using the </span><span lang=EN-NZ style='font-size:
10.0pt;font-family:"Courier New"'>setpar</span><span lang=EN-NZ> command. This
command is the inverse of </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>getpar,</span><span lang=EN-NZ> and is used to
change a parameter in a window control or object. It takes 4 parameters, the
window and object number (as for </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>getpar</span><span lang=EN-NZ>), the parameter name
and its new value. In this case the variable </span><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>position</span><span
lang=EN-NZ>, which is a number, is converted into text by the </span><span
lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>setpar</span><span
lang=EN-NZ> command and then written to the window, updating as the slider is
dragged. Using the </span><span lang=EN-NZ style='font-size:10.0pt;font-family:
"Courier New"'>&quot;value&quot;</span><span lang=EN-NZ> option, </span><span
lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>setpar </span><span
lang=EN-NZ>is also used to set the position of the progress bar. Again, check
out the Prospa help file “Command help” for a full list of possible parameters
which can be changed.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name=dialogBoxes></a><i><span lang=EN-NZ
style='font-size:13.0pt'>Dialog boxes</span></i></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>An alternative
GUI is the <i>dialog window</i>. In this case the window is presented to the
user to gain some information and then additional processing is done <i>after</i>
the window exits. An example of a dialog window is found in the <i>gettext</i>
macro shown below.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:#AA0000'># A window is displayed with some
prompt text as a title</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:#AA0000'># The user types in their response and
then presses</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:#AA0000'># the OK button. The program then
returns the </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:#AA0000'># text entered to the calling program</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:blue'>procedure</span><span style='font-size:
10.5pt;font-family:"Courier New";color:black'>(gettext,prompt)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:#AA0000'># Define dialog</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp; n = </span><span
style='font-size:10.5pt;font-family:"Courier New";color:green'>window</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(prompt, -1, -1,
249, 70)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>setwindowpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;type&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;dialog&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>edittext</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(2, 9, 12, 110)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>button</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(1, 130, 8, 47,
26, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;OK&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
result = </span><span style='font-size:10.5pt;font-family:"Courier New";
color:green'>getpar</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(0,2,</span><span style='font-size:10.5pt;font-family:"Courier New";
color:gray'>&quot;text&quot;</span><span style='font-size:10.5pt;font-family:
"Courier New";color:black'>);</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>closedialog</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(result);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>button</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(3, 184, 8, 47,
26, </span><span style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;Cancel&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>closedialog</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;cancelled&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>);)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.5pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n,1,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;mode&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.5pt;font-family:"Courier New";color:gray'>&quot;default&quot;</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>);</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;font-family:"Courier New";color:green'>setwindowpar</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(n,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;focus&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,2)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:#AA0000'># Display dialog and wait for text to
be returned</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>text = </span><span style='font-size:
10.5pt;font-family:"Courier New";color:green'>showdialog</span><span
style='font-size:10.5pt;font-family:"Courier New";color:black'>(n)</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.5pt;
font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:10.5pt;font-family:"Courier New";
color:blue'>endproc</span><span style='font-size:10.5pt;font-family:"Courier New";
color:black'>(text)</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ><img
width=249 height=71 src="Editing%20the%20window_files/image004.jpg"></span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The above window
was obtained by entering the following command into the CLI: </span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>pr gettext(&quot;Enter
text&quot;)</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>Then you can type text into the window and
press the enter key (or click on the OK button) to exit and print the text you
just typed.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Only three
commands are required to convert the normal window into a dialog. First the
window type is set to “dialog” using the </span><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>setwindowpar</span><span
lang=EN-NZ> command. Then instead of the </span><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>showwindow</span><span
lang=EN-NZ> command there is the </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>showdialog</span><span lang=EN-NZ> command. Here the
program remains until the OK or Cancel button are pressed, both of which
execute the </span><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>closedialog</span><span
lang=EN-NZ> command. At this point the macro exits the </span><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>showdialog</span><span
lang=EN-NZ> command, returning the entered text (or a cancel flag). Additional
commands can then be added to work on this information. Note that the dialog is
a blocking window – you cannot use any other Prospa window while the dialog is
being displayed.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
