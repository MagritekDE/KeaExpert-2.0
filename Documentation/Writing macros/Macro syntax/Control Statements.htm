<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 11 (filtered)">
<title> Using the Text Editor to write macros ®</title>
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0mm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
@page Section1
	{size:210.0mm 842.0pt;
	margin:72.0pt 89.85pt 72.0pt 89.85pt;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=Section1>

<p class=MsoNormal style='background:#FF6600'><b><span lang=EN-NZ
style='font-size:20.0pt'>Control Statements</span></b></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Some commands
are specific to macro scripts. These are commands that control the order in
which commands are executed. These commands are:</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>for ..... next</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>while ... endwhile</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>if .... elseif ... else ... endif</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>The first pair of statements allows a group
of commands to be executed a fixed number of times. e.g.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name="For_statement"></a><span lang=EN-GB
style='font-size:14.0pt'>The for-next statement</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:blue'>for</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(n =
0 </span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:blue'>to</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'> 0.5 </span><span lang=EN-GB style='font-size:10.0pt;font-family:
"Courier New";color:blue'>step</span><span lang=EN-GB style='font-size:10.0pt;
font-family:"Courier New";color:black'> 0.1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;\n&nbsp;&nbsp;
n = $n$&quot;</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:blue'>next</span><span lang=EN-GB style='font-size:10.0pt;font-family:
"Courier New";color:black'>(n)</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>Executing this script will result in the
following output</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New";
color:#993366'>&nbsp;&nbsp; n = 0</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New";
color:#993366'>&nbsp;&nbsp; n = 0.1</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New";
color:#993366'>&nbsp;&nbsp; n = 0.2</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New";
color:#993366'>&nbsp;&nbsp; n = 0.3</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New";
color:#993366'>&nbsp;&nbsp; n = 0.4</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New";
color:#993366'>&nbsp;&nbsp; n = 0.5</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>The <b>for</b>
loop has an initial value (here n = 0), an end value (here n = 0.5), and a step
size (here 0.1). Without the &quot;step&quot; keyword the program will
increment the loop variable by 1 each time. All statements between the <b>for</b>
and <b>next</b> commands will be repeated until loop variable exceeds the end
value.</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>A for-next loop
can be prematurely exited by calling the exitfor command.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name="while_statement"></a><span lang=EN-GB
style='font-size:14.0pt'>The while-endwhile statement</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>The while ... endwhile statement is similar
except that only the exit condition is implicit in the control structure. The
following piece of code duplicates the function of the for ... next loop above.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>n = 0</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:blue'>while</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(n
&lt;= 0.5)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;\n&nbsp;&nbsp;
n = $n$&quot;</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
n = n + 0.1</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endwhile</span></p>

<p class=MsoNormal><span lang=EN-NZ style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>Here all statements between the while and
endwhile commands will be repeated until the while condition is false</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>A while loop can
be prematurely exited by calling the exitwhile command.</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><a name="If_statement"></a><span lang=EN-GB
style='font-size:14.0pt'>The if-endif statement</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>The if-elseif-else-endif structure is a way
of selecting different pieces of code based on comparisons. The syntax is very
similar to that found in other languages:</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>a = 1</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:blue'>if</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'> (a
&lt; 1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;\n&nbsp;
a &lt; 1&quot;</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:blue'>elseif</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'> (a
&lt; 2)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;\n&nbsp;
a &lt; 2&quot;</span><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:black'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:blue'>else</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;\n&nbsp;
a &gt;= 2&quot;</span><span lang=EN-GB style='font-size:10.0pt;font-family:
"Courier New";color:black'>)</span></p>

<p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;font-family:"Courier New";
color:blue'>endif</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ>This code will result in the output</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New";
color:#993366'>&nbsp; a &lt; 2</span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>Note that the </span><span
lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>elseif</span><span
lang=EN-NZ> and </span><span lang=EN-NZ style='font-size:10.0pt;font-family:
"Courier New"'>else</span><span lang=EN-NZ> statements are optional - only the </span><span
lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>if-endif </span><span
lang=EN-NZ>pair must always be present. </span></p>

<p class=MsoNormal><span lang=EN-NZ>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span lang=EN-NZ>If you don't
have a matching </span><span lang=EN-NZ style='font-size:10.0pt;font-family:
"Courier New"'>endif</span><span lang=EN-NZ> for each </span><span lang=EN-NZ
style='font-size:10.0pt;font-family:"Courier New"'>if</span><span lang=EN-NZ>
(or </span><span lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>next</span><span
lang=EN-NZ> for each </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>for</span><span lang=EN-NZ> or </span><span
lang=EN-NZ style='font-size:10.0pt;font-family:"Courier New"'>endwhile</span><span
lang=EN-NZ> for each </span><span lang=EN-NZ style='font-size:10.0pt;
font-family:"Courier New"'>while</span><span lang=EN-NZ>) then the macro will
not be executed and you will be provided with an appropriate error message.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

</div>

</body>

</html>
