<html xmlns:ns0="http://schemas.microsoft.com/office/2004/12/omml">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 11 (filtered)">
<title>button – make a button control</title>
<style>
<!--p.MSONORMAL
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
li.MSONORMAL
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
div.MSONORMAL
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
h1
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-fareast-theme-font:minor-fareast;}
h3
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-fareast-theme-font:minor-fareast;}
a:link
	{mso-style-unhide:no;}
span.MSOHYPERLINK
	{mso-style-unhide:no;}
a:visited
	{mso-style-unhide:no;}
span.MSOHYPERLINKFOLLOWED
	{mso-style-unhide:no;}
p.MSOACETATE
	{mso-style-unhide:no;}
li.MSOACETATE
	{mso-style-unhide:no;}
div.MSOACETATE
	{mso-style-unhide:no;}
span.HEADING1CHAR
	{mso-style-unhide:no;
	mso-ascii-theme-font:major-latin;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-theme-font:major-latin;
	mso-bidi-theme-font:major-bidi;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.HEADING3CHAR
	{mso-style-unhide:no;
	mso-ascii-theme-font:major-latin;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-theme-font:major-latin;
	mso-bidi-theme-font:major-bidi;
	mso-themecolor:accent1;}
span.BALLOONTEXTCHAR
	{mso-style-unhide:no;}
.MSOCHPDEFAULT
	{mso-default-props:yes;}
table.MSONORMALTABLE
	{mso-style-priority:99;}

 /* Font Definitions */
 @font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0mm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
h1
	{margin-right:0mm;
	margin-left:0mm;
	font-size:24.0pt;
	font-family:"Times New Roman";}
h3
	{margin-right:0mm;
	margin-left:0mm;
	font-size:13.5pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{margin:0mm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:Tahoma;}
span.Heading1Char
	{font-family:Cambria;
	color:#365F91;
	font-weight:bold;}
span.Heading3Char
	{font-family:Cambria;
	color:#4F81BD;
	font-weight:bold;}
span.BalloonTextChar
	{font-family:Tahoma;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.Section1
	{page:Section1;}
-->
</style>

<link rel=themeData href="toolbar_files/themedata.thmx">
<link rel=colorSchemeMapping href="toolbar_files/colorschememapping.xml">
</head>

<body lang=EN-US link=blue vlink=purple>

<div class=Section1>

<p class=MsoNormal style='background:#FF6600'><b><span lang=EN-NZ
style='font-size:20.0pt'>toolbark</span></b></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU>Make a toolbar
control.</span><i><span lang=EN-AU style='font-family:Tahoma'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></i><span lang=EN-NZ><img width=281 height=26 id="Picture 1"
src="toolbark_files/image001.jpg"></span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:14.0pt'>Syntax</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>toolbark(objNr, bitmap
[,label [,key [,command]])&nbsp;(eeeee:dssss)</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>objNr .... control/object
number ID (INT)</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>bitmap ... name of bitmap
file to load (STR)</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>label .... name of nth
toolbar function (STR)</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>key ...... the name of this
item (STR)</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>command .. nth macro string
to execute (STR)</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:11.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:14.0pt'>Description</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:11.0pt;font-family:Tahoma'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU>This command
adds a toolbar control to the current GUI window being edited. Only one toolbar
can be displayed per window at a time but a window can display one of several
loaded toolbars. This varient of the toolbar command can access the toolbar
items via optional names. Currently this is only used internally by Prospa.</span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>bitmap</span><span
lang=EN-AU> identifies a file which will be contains the image to be displayed.
</span><span lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>bitmap</span><span
lang=EN-AU> should be 15 pixels high and 16 pixels per command wide (including
separators – see below). </span><span lang=EN-AU style='font-size:10.0pt;
font-family:"Courier New"'>bitmap</span><span lang=EN-AU> will be stored in a
folder with the same name and in the same location as the macro used to define
the toolbar. Each button in the toolbar has a </span><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>label</span><span
lang=EN-AU> and a </span><span lang=EN-AU style='font-size:10.0pt;font-family:
"Courier New"'>command</span><span lang=EN-AU> which will be run when the
toolbar button is pressed. If the button </span><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>label</span><span
lang=EN-AU> is </span>&quot;Separator&quot; then a small gap will be shown in
the toolbar rather than a button.</p>

<p class=MsoNormal><span lang=EN-AU style='font-size:11.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:14.0pt'>Toolbar Parameters</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU>There are no
specfic toolbar parameters. Toolbars can be associated with a window and with
controls. So for example when clicking on the title-bar of a window, one
toolbar might be shown, while clicking on a plot control might display another.
The corresponding commands are:</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:234.0pt;text-indent:-180.0pt;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:green'>setwindowpar</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(n,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;toolbar&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,nr) </span><span
style='font-size:10.0pt;font-family:"Courier New";color:#AA0000'># display
toolbar with control number 'nr' when clicking on the title bar of window 'n'.</span></p>

<p class=MsoNormal style='margin-left:234.0pt;text-indent:-180.0pt;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:green'>setpar</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(n,m,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;toolbar&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,nr)     </span><span
style='font-size:10.0pt;font-family:"Courier New";color:#AA0000'># display
toolbar with control number 'nr' when clicking on control 'm'.</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:14.0pt'>Example</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU>This example
displays a window with a 3 button toolbar, made by removing all but the first
three icons from the 1D plot toolbar found in the </span><span lang=EN-AU
style='font-size:10.0pt;font-family:"Courier New"'>Windows_Layout</span><span
lang=EN-AU> folder. The dimensions of this bitmap are 48 pixels wide and 15
high. This bitmap </span><span lang=EN-AU style='font-size:10.0pt;font-family:
"Courier New"'>toolbartest.bmp</span><span lang=EN-AU> is then saved inside a
folder called </span><span lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>toolbartest</span><span
lang=EN-AU>, which is stored in the same folder as the following macro (</span><span
lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>toolbartest.mac</span><span
lang=EN-AU>). If other toolbars were to be displayed in this window, they would
also be stored in this folder.</span></p>

<p class=MsoNormal><span lang=EN-AU>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:63.0pt'><span lang=EN-NZ><img width=300
height=99 id="Picture 2" src="toolbark_files/image002.jpg"></span></p>

<p class=MsoNormal style='margin-left:27.0pt'><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'>procedure</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(toolbarktest)</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>   n = </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>window</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Toolbar
test&quot;</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>, -1, -1, 300, 74)</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>       </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>button</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(1, 220, 5, 50,
32, </span><span style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;Close&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>closewindow</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(0))</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>       </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>toolbark</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(2,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;toolbarktest&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>                
</span><span style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;load&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;ld&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'> (</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;load\n&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>), </span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>                
</span><span style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;save&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;sv&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'> (</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;save\n&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>), </span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>                
</span><span style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;print&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;pr&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>pr</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'> (</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;print\n&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>))</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>       </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>setwindowpar</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(n,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;toolbar&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,2) </span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>   </span><span
style='font-size:10.0pt;font-family:"Courier New";color:green'>showwindow</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>(n,</span><span
style='font-size:10.0pt;font-family:"Courier New";color:gray'>&quot;recalc&quot;</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:45.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'>endproc</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>()</span></p>

<p class=MsoNormal><span lang=EN-GB>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-AU>Note the
requirement to add the &quot;</span><span lang=EN-AU style='font-size:10.0pt;
font-family:"Courier New"'>recalc</span><span lang=EN-AU>&quot; option to </span><span
lang=EN-AU style='font-size:10.0pt;font-family:"Courier New"'>showwindow</span><span
lang=EN-AU>. This adjusts the vertical control positions so that they are now
relative to the bottom of the toolbar rather than the bottom of the title bar.</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:11.0pt;font-family:Tahoma'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:14.0pt'>See also</span></p>

<p class=MsoNormal><i><span lang=EN-AU style='font-size:11.0pt;font-family:
Tahoma'>&nbsp;</span></i></p>

<p class=MsoNormal style='margin-left:14.2pt'><span lang=EN-GB
style='font-size:10.0pt;font-family:"Courier New"'><a href="showwindow.htm">showwindow</a></span></p>

<p class=MsoNormal><span lang=EN-AU style='font-size:11.0pt;font-family:Tahoma'>&nbsp;</span></p>

</div>

</body>

</html>
